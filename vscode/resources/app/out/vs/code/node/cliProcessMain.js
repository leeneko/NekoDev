/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var Y=["require","exports","vs/base/common/lifecycle","vs/base/common/async","vs/nls","vs/nls!vs/code/node/cliProcessMain","vs/base/common/network","vs/base/common/path","vs/base/common/errors","vs/base/common/uri","vs/base/common/event","vs/base/common/types","vs/base/common/platform","vs/base/node/pfs","vs/platform/log/common/log","vs/platform/instantiation/common/instantiation","vs/platform/files/common/files","vs/base/common/buffer","vs/base/common/objects","vs/base/common/resources","vs/base/common/arrays","vs/platform/environment/common/environment","vs/platform/extensionManagement/common/extensionManagement","vs/platform/extensionManagement/common/extensionManagementUtil","vs/base/common/cancellation","vs/platform/registry/common/platform","vs/platform/configuration/common/configuration","vs/base/common/strings","vs/base/common/errorMessage","vs/base/common/process","vs/platform/telemetry/common/telemetry","vs/base/common/uuid","vs/platform/files/common/watcher","vs/platform/product/common/productService","vs/platform/configuration/common/configurationRegistry","os","vs/base/parts/ipc/common/ipc","vs/platform/telemetry/common/telemetryUtils","vs/base/common/stream","child_process","vs/base/parts/ipc/node/ipc.cp","vs/platform/extensions/common/extensions","vs/base/common/semver/semver","vs/platform/request/common/request","vs/base/node/zip","vs/base/common/decorators","vs/base/common/extpath","fs","vs/base/node/processes","vs/platform/extensions/common/extensionValidator","vs/platform/instantiation/common/descriptors","vs/platform/download/common/download","vs/platform/files/common/io","vs/platform/instantiation/common/serviceCollection","vs/platform/localizations/common/localizations","vs/platform/product/common/product","vs/base/common/assert","vs/base/common/json","vs/base/common/processes","vs/base/common/console","vs/base/common/marshalling","vs/base/common/labels","vs/base/node/decoder","vs/base/node/extpath","vs/base/node/powershell","vs/base/parts/storage/common/storage","vs/nls!vs/base/common/date","vs/base/common/date","vs/nls!vs/base/common/errorMessage","vs/nls!vs/base/node/processes","vs/base/node/shell","vs/nls!vs/base/node/zip","vs/nls!vs/platform/configuration/common/configurationRegistry","vs/nls!vs/platform/environment/node/shellEnv","vs/nls!vs/platform/extensionManagement/common/abstractExtensionManagementService","vs/nls!vs/platform/extensionManagement/common/extensionManagement","vs/nls!vs/platform/extensionManagement/common/extensionManagementCLIService","vs/nls!vs/platform/extensionManagement/node/extensionManagementService","vs/nls!vs/platform/extensionManagement/node/extensionManagementUtil","vs/nls!vs/platform/extensionManagement/node/extensionsScanner","vs/nls!vs/platform/extensions/common/extensionValidator","vs/nls!vs/platform/files/common/fileService","vs/nls!vs/platform/files/common/io","vs/nls!vs/platform/files/node/diskFileSystemProvider","vs/nls!vs/platform/request/common/request","vs/nls!vs/platform/telemetry/common/telemetryService","vs/platform/environment/common/environmentService","vs/platform/environment/node/userDataPath","vs/platform/environment/node/environmentService","vs/platform/extensionManagement/common/extensionNls","vs/platform/instantiation/common/graph","vs/platform/environment/node/shellEnv","vs/platform/files/node/watcher/nodejs/watcherService","vs/platform/files/node/watcher/nsfw/watcherService","vs/platform/files/node/watcher/parcel/watcherService","vs/platform/files/node/watcher/unix/watcherService","vs/platform/instantiation/common/instantiationService","vs/platform/extensionManagement/node/extensionLifecycle","vs/platform/files/common/diskFileSystemProvider","vs/platform/files/common/fileService","vs/base/common/map","vs/base/common/performance","vs/platform/log/node/spdlogLog","vs/platform/files/node/diskFileSystemProvider","vs/platform/jsonschemas/common/jsonContributionRegistry","vs/platform/configuration/common/configurationModels","vs/platform/configuration/common/configurationService","vs/platform/remote/common/remoteHosts","vs/platform/extensionManagement/common/extensionManagementCLIService","vs/platform/extensionManagement/node/extensionDownloader","vs/platform/extensionManagement/node/extensionsManifestCache","vs/platform/extensionManagement/node/extensionsWatcher","vs/platform/localizations/node/localizations","vs/platform/download/common/downloadService","vs/platform/request/node/proxy","url","vs/platform/serviceMachineId/common/serviceMachineId","vs/platform/storage/common/storage","vs/platform/telemetry/common/commonProperties","vs/platform/extensionManagement/common/abstractExtensionManagementService","vs/platform/extensionManagement/common/extensionGalleryService","vs/platform/telemetry/common/telemetryService","vs/platform/telemetry/node/appInsightsAppender","vs/platform/telemetry/node/telemetry","vs/platform/extensionManagement/node/extensionManagementUtil","vs/platform/extensionManagement/node/extensionsScanner","vs/platform/extensionManagement/node/extensionManagementService","vs/platform/request/node/requestService","string_decoder","path","vs/platform/environment/node/argvHelper","vs/base/node/watcher","vs/base/common/iterator","graceful-fs","crypto","yauzl","yazl","zlib","vs/code/node/cliProcessMain"],Q=function(z){for(var t=[],L=0,I=z.length;L<I;L++)t[L]=Y[z[L]];return t};define(Y[56],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ok=void 0;function L(I,b){if(!I)throw new Error(b?`Assertion failed (${b})`:"Assertion Failed")}t.ok=L}),define(Y[45],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.debounce=t.memoize=t.createDecorator=void 0;function L(D){return(T,c,m)=>{let w=null,C=null;if(typeof m.value=="function"?(w="value",C=m.value):typeof m.get=="function"&&(w="get",C=m.get),!C)throw new Error("not supported");m[w]=D(C,c)}}t.createDecorator=L;function I(D,T,c){let m=null,w=null;if(typeof c.value=="function"?(m="value",w=c.value,w.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof c.get=="function"&&(m="get",w=c.get),!w)throw new Error("not supported");const C=`$memoize$${T}`;c[m]=function(...f){return this.hasOwnProperty(C)||Object.defineProperty(this,C,{configurable:!1,enumerable:!1,writable:!1,value:w.apply(this,f)}),this[C]}}t.memoize=I;function b(D,T,c){return L((m,w)=>{const C=`$debounce$${w}`,f=`$debounce$result$${w}`;return function(...S){this[f]||(this[f]=c?c():void 0),clearTimeout(this[C]),T&&(this[f]=T(this[f],...S),S=[this[f]]),this[C]=setTimeout(()=>{m.apply(this,S),this[f]=c?c():void 0},D)}})}t.debounce=b;function P(D,T,c){return L((m,w)=>{const C=`$throttle$timer$${w}`,f=`$throttle$result$${w}`,S=`$throttle$lastRun$${w}`,u=`$throttle$pending$${w}`;return function(...d){if(this[f]||(this[f]=c?c():void 0),(this[S]===null||this[S]===void 0)&&(this[S]=-Number.MAX_VALUE),T&&(this[f]=T(this[f],...d)),this[u])return;const p=this[S]+D;p<=Date.now()?(this[S]=Date.now(),m.apply(this,[this[f]]),this[f]=c?c():void 0):(this[u]=!0,this[C]=setTimeout(()=>{this[u]=!1,this[S]=Date.now(),m.apply(this,[this[f]]),this[f]=c?c():void 0},p-Date.now()))}})}t.throttle=P}),define(Y[57],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeType=t.stripComments=t.visit=t.findNodeAtOffset=t.contains=t.getNodeValue=t.getNodePath=t.findNodeAtLocation=t.parseTree=t.parse=t.getLocation=t.createScanner=t.ParseOptions=t.ParseErrorCode=t.SyntaxKind=t.ScanError=void 0;var L;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(L=t.ScanError||(t.ScanError={}));var I;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(I=t.SyntaxKind||(t.SyntaxKind={}));var b;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(b=t.ParseErrorCode||(t.ParseErrorCode={}));var P;(function(e){e.DEFAULT={allowTrailingComma:!0}})(P=t.ParseOptions||(t.ParseOptions={}));function D(e,i=!1){let r=0,n=e.length,o="",h=0,E=16,R=0;function v(ne){let B=0,K=0;for(;B<ne;){const _=e.charCodeAt(r);if(_>=48&&_<=57)K=K*16+_-48;else if(_>=65&&_<=70)K=K*16+_-65+10;else if(_>=97&&_<=102)K=K*16+_-97+10;else break;r++,B++}return B<ne&&(K=-1),K}function O(ne){r=ne,o="",h=0,E=16,R=0}function A(){const ne=r;if(e.charCodeAt(r)===48)r++;else for(r++;r<e.length&&m(e.charCodeAt(r));)r++;if(r<e.length&&e.charCodeAt(r)===46)if(r++,r<e.length&&m(e.charCodeAt(r)))for(r++;r<e.length&&m(e.charCodeAt(r));)r++;else return R=3,e.substring(ne,r);let B=r;if(r<e.length&&(e.charCodeAt(r)===69||e.charCodeAt(r)===101))if(r++,(r<e.length&&e.charCodeAt(r)===43||e.charCodeAt(r)===45)&&r++,r<e.length&&m(e.charCodeAt(r))){for(r++;r<e.length&&m(e.charCodeAt(r));)r++;B=r}else R=3;return e.substring(ne,B)}function G(){let ne="",B=r;for(;;){if(r>=n){ne+=e.substring(B,r),R=2;break}const K=e.charCodeAt(r);if(K===34){ne+=e.substring(B,r),r++;break}if(K===92){if(ne+=e.substring(B,r),r++,r>=n){R=2;break}switch(e.charCodeAt(r++)){case 34:ne+='"';break;case 92:ne+="\\";break;case 47:ne+="/";break;case 98:ne+="\b";break;case 102:ne+="\f";break;case 110:ne+=`
`;break;case 114:ne+="\r";break;case 116:ne+="	";break;case 117:const oe=v(4);oe>=0?ne+=String.fromCharCode(oe):R=4;break;default:R=5}B=r;continue}if(K>=0&&K<=31)if(c(K)){ne+=e.substring(B,r),R=2;break}else R=6;r++}return ne}function te(){if(o="",R=0,h=r,r>=n)return h=n,E=17;let ne=e.charCodeAt(r);if(T(ne)){do r++,o+=String.fromCharCode(ne),ne=e.charCodeAt(r);while(T(ne));return E=15}if(c(ne))return r++,o+=String.fromCharCode(ne),ne===13&&e.charCodeAt(r)===10&&(r++,o+=`
`),E=14;switch(ne){case 123:return r++,E=1;case 125:return r++,E=2;case 91:return r++,E=3;case 93:return r++,E=4;case 58:return r++,E=6;case 44:return r++,E=5;case 34:return r++,o=G(),E=10;case 47:const B=r-1;if(e.charCodeAt(r+1)===47){for(r+=2;r<n&&!c(e.charCodeAt(r));)r++;return o=e.substring(B,r),E=12}if(e.charCodeAt(r+1)===42){r+=2;const K=n-1;let _=!1;for(;r<K;){if(e.charCodeAt(r)===42&&e.charCodeAt(r+1)===47){r+=2,_=!0;break}r++}return _||(r++,R=1),o=e.substring(B,r),E=13}return o+=String.fromCharCode(ne),r++,E=16;case 45:if(o+=String.fromCharCode(ne),r++,r===n||!m(e.charCodeAt(r)))return E=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return o+=A(),E=11;default:for(;r<n&&ue(ne);)r++,ne=e.charCodeAt(r);if(h!==r){switch(o=e.substring(h,r),o){case"true":return E=8;case"false":return E=9;case"null":return E=7}return E=16}return o+=String.fromCharCode(ne),r++,E=16}}function ue(ne){if(T(ne)||c(ne))return!1;switch(ne){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function ce(){let ne;do ne=te();while(ne>=12&&ne<=15);return ne}return{setPosition:O,getPosition:()=>r,scan:i?ce:te,getToken:()=>E,getTokenValue:()=>o,getTokenOffset:()=>h,getTokenLength:()=>r-h,getTokenError:()=>R}}t.createScanner=D;function T(e){return e===32||e===9||e===11||e===12||e===160||e===5760||e>=8192&&e<=8203||e===8239||e===8287||e===12288||e===65279}function c(e){return e===10||e===13||e===8232||e===8233}function m(e){return e>=48&&e<=57}var w;(function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"})(w||(w={}));function C(e,i){const r=[],n=new Object;let o;const h={value:{},offset:0,length:0,type:"object",parent:void 0};let E=!1;function R(v,O,A,G){h.value=v,h.offset=O,h.length=A,h.type=G,h.colonOffset=void 0,o=h}try{l(e,{onObjectBegin:(v,O)=>{if(i<=v)throw n;o=void 0,E=i>v,r.push("")},onObjectProperty:(v,O,A)=>{if(i<O||(R(v,O,A,"property"),r[r.length-1]=v,i<=O+A))throw n},onObjectEnd:(v,O)=>{if(i<=v)throw n;o=void 0,r.pop()},onArrayBegin:(v,O)=>{if(i<=v)throw n;o=void 0,r.push(0)},onArrayEnd:(v,O)=>{if(i<=v)throw n;o=void 0,r.pop()},onLiteralValue:(v,O,A)=>{if(i<O||(R(v,O,A,a(v)),i<=O+A))throw n},onSeparator:(v,O,A)=>{if(i<=O)throw n;if(v===":"&&o&&o.type==="property")o.colonOffset=O,E=!1,o=void 0;else if(v===","){const G=r[r.length-1];typeof G=="number"?r[r.length-1]=G+1:(E=!0,r[r.length-1]=""),o=void 0}}})}catch(v){if(v!==n)throw v}return{path:r,previousNode:o,isAtPropertyKey:E,matches:v=>{let O=0;for(let A=0;O<v.length&&A<r.length;A++)if(v[O]===r[A]||v[O]==="*")O++;else if(v[O]!=="**")return!1;return O===v.length}}}t.getLocation=C;function f(e,i=[],r=P.DEFAULT){let n=null,o=[];const h=[];function E(v){Array.isArray(o)?o.push(v):n!==null&&(o[n]=v)}return l(e,{onObjectBegin:()=>{const v={};E(v),h.push(o),o=v,n=null},onObjectProperty:v=>{n=v},onObjectEnd:()=>{o=h.pop()},onArrayBegin:()=>{const v=[];E(v),h.push(o),o=v,n=null},onArrayEnd:()=>{o=h.pop()},onLiteralValue:E,onError:(v,O,A)=>{i.push({error:v,offset:O,length:A})}},r),o[0]}t.parse=f;function S(e,i=[],r=P.DEFAULT){let n={type:"array",offset:-1,length:-1,children:[],parent:void 0};function o(v){n.type==="property"&&(n.length=v-n.offset,n=n.parent)}function h(v){return n.children.push(v),v}l(e,{onObjectBegin:v=>{n=h({type:"object",offset:v,length:-1,parent:n,children:[]})},onObjectProperty:(v,O,A)=>{n=h({type:"property",offset:O,length:-1,parent:n,children:[]}),n.children.push({type:"string",value:v,offset:O,length:A,parent:n})},onObjectEnd:(v,O)=>{n.length=v+O-n.offset,n=n.parent,o(v+O)},onArrayBegin:(v,O)=>{n=h({type:"array",offset:v,length:-1,parent:n,children:[]})},onArrayEnd:(v,O)=>{n.length=v+O-n.offset,n=n.parent,o(v+O)},onLiteralValue:(v,O,A)=>{h({type:a(v),offset:O,length:A,parent:n,value:v}),o(O+A)},onSeparator:(v,O,A)=>{n.type==="property"&&(v===":"?n.colonOffset=O:v===","&&o(O))},onError:(v,O,A)=>{i.push({error:v,offset:O,length:A})}},r);const R=n.children[0];return R&&delete R.parent,R}t.parseTree=S;function u(e,i){if(!e)return;let r=e;for(let n of i)if(typeof n=="string"){if(r.type!=="object"||!Array.isArray(r.children))return;let o=!1;for(const h of r.children)if(Array.isArray(h.children)&&h.children[0].value===n){r=h.children[1],o=!0;break}if(!o)return}else{const o=n;if(r.type!=="array"||o<0||!Array.isArray(r.children)||o>=r.children.length)return;r=r.children[o]}return r}t.findNodeAtLocation=u;function d(e){if(!e.parent||!e.parent.children)return[];const i=d(e.parent);if(e.parent.type==="property"){const r=e.parent.children[0].value;i.push(r)}else if(e.parent.type==="array"){const r=e.parent.children.indexOf(e);r!==-1&&i.push(r)}return i}t.getNodePath=d;function p(e){switch(e.type){case"array":return e.children.map(p);case"object":const i=Object.create(null);for(let r of e.children){const n=r.children[1];n&&(i[r.children[0].value]=p(n))}return i;case"null":case"string":case"number":case"boolean":return e.value;default:return}}t.getNodeValue=p;function g(e,i,r=!1){return i>=e.offset&&i<e.offset+e.length||r&&i===e.offset+e.length}t.contains=g;function y(e,i,r=!1){if(g(e,i,r)){const n=e.children;if(Array.isArray(n))for(let o=0;o<n.length&&n[o].offset<=i;o++){const h=y(n[o],i,r);if(h)return h}return e}}t.findNodeAtOffset=y;function l(e,i,r=P.DEFAULT){const n=D(e,!1);function o(j){return j?()=>j(n.getTokenOffset(),n.getTokenLength()):()=>!0}function h(j){return j?ie=>j(ie,n.getTokenOffset(),n.getTokenLength()):()=>!0}const E=o(i.onObjectBegin),R=h(i.onObjectProperty),v=o(i.onObjectEnd),O=o(i.onArrayBegin),A=o(i.onArrayEnd),G=h(i.onLiteralValue),te=h(i.onSeparator),ue=o(i.onComment),ce=h(i.onError),ne=r&&r.disallowComments,B=r&&r.allowTrailingComma;function K(){for(;;){const j=n.scan();switch(n.getTokenError()){case 4:_(14);break;case 5:_(15);break;case 3:_(13);break;case 1:ne||_(11);break;case 2:_(12);break;case 6:_(16);break}switch(j){case 12:case 13:ne?_(10):ue();break;case 16:_(1);break;case 15:case 14:break;default:return j}}}function _(j,ie=[],Z=[]){if(ce(j),ie.length+Z.length>0){let M=n.getToken();for(;M!==17;){if(ie.indexOf(M)!==-1){K();break}else if(Z.indexOf(M)!==-1)break;M=K()}}}function oe(j){const ie=n.getTokenValue();return j?G(ie):R(ie),K(),!0}function x(){switch(n.getToken()){case 11:let j=0;try{j=JSON.parse(n.getTokenValue()),typeof j!="number"&&(_(2),j=0)}catch(ie){_(2)}G(j);break;case 7:G(null);break;case 8:G(!0);break;case 9:G(!1);break;default:return!1}return K(),!0}function F(){return n.getToken()!==10?(_(3,[],[2,5]),!1):(oe(!1),n.getToken()===6?(te(":"),K(),X()||_(4,[],[2,5])):_(5,[],[2,5]),!0)}function W(){E(),K();let j=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(j||_(4,[],[]),te(","),K(),n.getToken()===2&&B)break}else j&&_(6,[],[]);F()||_(4,[],[2,5]),j=!0}return v(),n.getToken()!==2?_(7,[2],[]):K(),!0}function H(){O(),K();let j=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(j||_(4,[],[]),te(","),K(),n.getToken()===4&&B)break}else j&&_(6,[],[]);X()||_(4,[],[4,5]),j=!0}return A(),n.getToken()!==4?_(8,[4],[]):K(),!0}function X(){switch(n.getToken()){case 3:return H();case 1:return W();case 10:return oe(!0);default:return x()}}return K(),n.getToken()===17?r.allowEmptyContent?!0:(_(4,[],[]),!1):X()?(n.getToken()!==17&&_(9,[],[]),!0):(_(4,[],[]),!1)}t.visit=l;function s(e,i){let r=D(e),n=[],o,h=0,E;do switch(E=r.getPosition(),o=r.scan(),o){case 12:case 13:case 17:h!==E&&n.push(e.substring(h,E)),i!==void 0&&n.push(r.getTokenValue().replace(/[^\r\n]/g,i)),h=r.getPosition();break}while(o!==17);return n.join("")}t.stripComments=s;function a(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(e){if(Array.isArray(e))return"array"}else return"null";return"object"}default:return"null"}}t.getNodeType=a}),function(){function z(b){const P=[];typeof b=="number"&&P.push("code/timeOrigin",b);function D(c){P.push(c,Date.now())}function T(){const c=[];for(let m=0;m<P.length;m+=2)c.push({name:P[m],startTime:P[m+1]});return c}return{mark:D,getMarks:T}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function")return typeof performance.timeOrigin!="number"&&!performance.timing?z():{mark(b){performance.mark(b)},getMarks(){let b=performance.timeOrigin;typeof b!="number"&&(b=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const P=[{name:"code/timeOrigin",startTime:Math.round(b)}];for(const D of performance.getEntriesByType("mark"))P.push({name:D.name,startTime:Math.round(b+D.startTime)});return P}};if(typeof process=="object"){const b=Math.round((require.nodeRequire||require)("perf_hooks").performance.timeOrigin);return z(b)}else return console.trace("perf-util loaded in UNKNOWN environment"),z()}function L(b){return b.MonacoPerformanceMarks||(b.MonacoPerformanceMarks=t()),b.MonacoPerformanceMarks}var I;typeof global=="object"?I=global:typeof self=="object"?I=self:I={},typeof define=="function"?define("vs/base/common/performance",[],function(){return L(I)}):typeof module=="object"&&typeof module.exports=="object"?module.exports=L(I):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),I.perf=L(I))}(),define(Y[58],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeProcessEnvironment=t.TerminateResponseCode=t.Source=void 0;var L;(function(P){P[P.stdout=0]="stdout",P[P.stderr=1]="stderr"})(L=t.Source||(t.Source={}));var I;(function(P){P[P.Success=0]="Success",P[P.Unknown=1]="Unknown",P[P.AccessDenied=2]="AccessDenied",P[P.ProcessNotFound=3]="ProcessNotFound"})(I=t.TerminateResponseCode||(t.TerminateResponseCode={}));function b(P,...D){const T=D.reduce((w,C)=>(w[C]=!0,w),{}),c=[/^ELECTRON_.+$/,/^VSCODE_.+$/,/^SNAP(|_.*)$/,/^GDK_PIXBUF_.+$/];Object.keys(P).filter(w=>!T[w]).forEach(w=>{for(let C=0;C<c.length;C++)if(w.search(c[C])!==-1){delete P[w];break}})}t.sanitizeProcessEnvironment=b}),function(z,t){if(typeof exports=="object"&&typeof module=="object")module.exports=t();else if(typeof define=="function"&&define.amd)define("vs/base/common/semver/semver",[],t);else{var L=t();for(var I in L)(typeof exports=="object"?exports:z)[I]=L[I]}}(typeof self!="undefined"?self:this,function(){return function(z){var t={};function L(I){if(t[I])return t[I].exports;var b=t[I]={i:I,l:!1,exports:{}};return z[I].call(b.exports,b,b.exports,L),b.l=!0,b.exports}return L.m=z,L.c=t,L.d=function(I,b,P){L.o(I,b)||Object.defineProperty(I,b,{enumerable:!0,get:P})},L.r=function(I){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},L.t=function(I,b){if(1&b&&(I=L(I)),8&b||4&b&&typeof I=="object"&&I&&I.__esModule)return I;var P=Object.create(null);if(L.r(P),Object.defineProperty(P,"default",{enumerable:!0,value:I}),2&b&&typeof I!="string")for(var D in I)L.d(P,D,function(T){return I[T]}.bind(null,D));return P},L.n=function(I){var b=I&&I.__esModule?function(){return I.default}:function(){return I};return L.d(b,"a",b),b},L.o=function(I,b){return Object.prototype.hasOwnProperty.call(I,b)},L.p="",L(L.s=0)}([function(z,t,L){(function(I){var b;t=z.exports=Z,b=typeof I=="object"&&I.env&&I.env.NODE_DEBUG&&/\bsemver\b/i.test(I.env.NODE_DEBUG)?function(){var k=Array.prototype.slice.call(arguments,0);k.unshift("SEMVER"),console.log.apply(console,k)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var P=256,D=Number.MAX_SAFE_INTEGER||9007199254740991,T=t.re=[],c=t.src=[],m=0,w=m++;c[w]="0|[1-9]\\d*";var C=m++;c[C]="[0-9]+";var f=m++;c[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var S=m++;c[S]="("+c[w]+")\\.("+c[w]+")\\.("+c[w]+")";var u=m++;c[u]="("+c[C]+")\\.("+c[C]+")\\.("+c[C]+")";var d=m++;c[d]="(?:"+c[w]+"|"+c[f]+")";var p=m++;c[p]="(?:"+c[C]+"|"+c[f]+")";var g=m++;c[g]="(?:-("+c[d]+"(?:\\."+c[d]+")*))";var y=m++;c[y]="(?:-?("+c[p]+"(?:\\."+c[p]+")*))";var l=m++;c[l]="[0-9A-Za-z-]+";var s=m++;c[s]="(?:\\+("+c[l]+"(?:\\."+c[l]+")*))";var a=m++,e="v?"+c[S]+c[g]+"?"+c[s]+"?";c[a]="^"+e+"$";var i="[v=\\s]*"+c[u]+c[y]+"?"+c[s]+"?",r=m++;c[r]="^"+i+"$";var n=m++;c[n]="((?:<|>)?=?)";var o=m++;c[o]=c[C]+"|x|X|\\*";var h=m++;c[h]=c[w]+"|x|X|\\*";var E=m++;c[E]="[v=\\s]*("+c[h]+")(?:\\.("+c[h]+")(?:\\.("+c[h]+")(?:"+c[g]+")?"+c[s]+"?)?)?";var R=m++;c[R]="[v=\\s]*("+c[o]+")(?:\\.("+c[o]+")(?:\\.("+c[o]+")(?:"+c[y]+")?"+c[s]+"?)?)?";var v=m++;c[v]="^"+c[n]+"\\s*"+c[E]+"$";var O=m++;c[O]="^"+c[n]+"\\s*"+c[R]+"$";var A=m++;c[A]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var G=m++;c[G]="(?:~>?)";var te=m++;c[te]="(\\s*)"+c[G]+"\\s+",T[te]=new RegExp(c[te],"g");var ue=m++;c[ue]="^"+c[G]+c[E]+"$";var ce=m++;c[ce]="^"+c[G]+c[R]+"$";var ne=m++;c[ne]="(?:\\^)";var B=m++;c[B]="(\\s*)"+c[ne]+"\\s+",T[B]=new RegExp(c[B],"g");var K=m++;c[K]="^"+c[ne]+c[E]+"$";var _=m++;c[_]="^"+c[ne]+c[R]+"$";var oe=m++;c[oe]="^"+c[n]+"\\s*("+i+")$|^$";var x=m++;c[x]="^"+c[n]+"\\s*("+e+")$|^$";var F=m++;c[F]="(\\s*)"+c[n]+"\\s*("+i+"|"+c[E]+")",T[F]=new RegExp(c[F],"g");var W=m++;c[W]="^\\s*("+c[E]+")\\s+-\\s+("+c[E]+")\\s*$";var H=m++;c[H]="^\\s*("+c[R]+")\\s+-\\s+("+c[R]+")\\s*$";var X=m++;c[X]="(<|>)?=?\\s*\\*";for(var j=0;j<35;j++)b(j,c[j]),T[j]||(T[j]=new RegExp(c[j]));function ie(k,U){if(k instanceof Z)return k;if(typeof k!="string"||k.length>P||!(U?T[r]:T[a]).test(k))return null;try{return new Z(k,U)}catch($){return null}}function Z(k,U){if(k instanceof Z){if(k.loose===U)return k;k=k.version}else if(typeof k!="string")throw new TypeError("Invalid Version: "+k);if(k.length>P)throw new TypeError("version is longer than "+P+" characters");if(!(this instanceof Z))return new Z(k,U);b("SemVer",k,U),this.loose=U;var $=k.trim().match(U?T[r]:T[a]);if(!$)throw new TypeError("Invalid Version: "+k);if(this.raw=k,this.major=+$[1],this.minor=+$[2],this.patch=+$[3],this.major>D||this.major<0)throw new TypeError("Invalid major version");if(this.minor>D||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>D||this.patch<0)throw new TypeError("Invalid patch version");$[4]?this.prerelease=$[4].split(".").map(function(le){if(/^[0-9]+$/.test(le)){var he=+le;if(he>=0&&he<D)return he}return le}):this.prerelease=[],this.build=$[5]?$[5].split("."):[],this.format()}t.parse=ie,t.valid=function(k,U){var $=ie(k,U);return $?$.version:null},t.clean=function(k,U){var $=ie(k.trim().replace(/^[=v]+/,""),U);return $?$.version:null},t.SemVer=Z,Z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Z.prototype.toString=function(){return this.version},Z.prototype.compare=function(k){return b("SemVer.compare",this.version,this.loose,k),k instanceof Z||(k=new Z(k,this.loose)),this.compareMain(k)||this.comparePre(k)},Z.prototype.compareMain=function(k){return k instanceof Z||(k=new Z(k,this.loose)),N(this.major,k.major)||N(this.minor,k.minor)||N(this.patch,k.patch)},Z.prototype.comparePre=function(k){if(k instanceof Z||(k=new Z(k,this.loose)),this.prerelease.length&&!k.prerelease.length)return-1;if(!this.prerelease.length&&k.prerelease.length)return 1;if(!this.prerelease.length&&!k.prerelease.length)return 0;var U=0;do{var $=this.prerelease[U],le=k.prerelease[U];if(b("prerelease compare",U,$,le),$===void 0&&le===void 0)return 0;if(le===void 0)return 1;if($===void 0)return-1;if($!==le)return N($,le)}while(++U)},Z.prototype.inc=function(k,U){switch(k){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",U);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",U);break;case"prepatch":this.prerelease.length=0,this.inc("patch",U),this.inc("pre",U);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",U),this.inc("pre",U);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var $=this.prerelease.length;--$>=0;)typeof this.prerelease[$]=="number"&&(this.prerelease[$]++,$=-2);$===-1&&this.prerelease.push(0)}U&&(this.prerelease[0]===U?isNaN(this.prerelease[1])&&(this.prerelease=[U,0]):this.prerelease=[U,0]);break;default:throw new Error("invalid increment argument: "+k)}return this.format(),this.raw=this.version,this},t.inc=function(k,U,$,le){typeof $=="string"&&(le=$,$=void 0);try{return new Z(k,$).inc(U,le).version}catch(he){return null}},t.diff=function(k,U){if(ee(k,U))return null;var $=ie(k),le=ie(U);if($.prerelease.length||le.prerelease.length){for(var he in $)if((he==="major"||he==="minor"||he==="patch")&&$[he]!==le[he])return"pre"+he;return"prerelease"}for(var he in $)if((he==="major"||he==="minor"||he==="patch")&&$[he]!==le[he])return he},t.compareIdentifiers=N;var M=/^[0-9]+$/;function N(k,U){var $=M.test(k),le=M.test(U);return $&&le&&(k=+k,U=+U),$&&!le?-1:le&&!$?1:k<U?-1:k>U?1:0}function q(k,U,$){return new Z(k,$).compare(new Z(U,$))}function V(k,U,$){return q(k,U,$)>0}function J(k,U,$){return q(k,U,$)<0}function ee(k,U,$){return q(k,U,$)===0}function se(k,U,$){return q(k,U,$)!==0}function re(k,U,$){return q(k,U,$)>=0}function me(k,U,$){return q(k,U,$)<=0}function ve(k,U,$,le){var he;switch(U){case"===":typeof k=="object"&&(k=k.version),typeof $=="object"&&($=$.version),he=k===$;break;case"!==":typeof k=="object"&&(k=k.version),typeof $=="object"&&($=$.version),he=k!==$;break;case"":case"=":case"==":he=ee(k,$,le);break;case"!=":he=se(k,$,le);break;case">":he=V(k,$,le);break;case">=":he=re(k,$,le);break;case"<":he=J(k,$,le);break;case"<=":he=me(k,$,le);break;default:throw new TypeError("Invalid operator: "+U)}return he}function fe(k,U){if(k instanceof fe){if(k.loose===U)return k;k=k.value}if(!(this instanceof fe))return new fe(k,U);b("comparator",k,U),this.loose=U,this.parse(k),this.semver===be?this.value="":this.value=this.operator+this.semver.version,b("comp",this)}t.rcompareIdentifiers=function(k,U){return N(U,k)},t.major=function(k,U){return new Z(k,U).major},t.minor=function(k,U){return new Z(k,U).minor},t.patch=function(k,U){return new Z(k,U).patch},t.compare=q,t.compareLoose=function(k,U){return q(k,U,!0)},t.rcompare=function(k,U,$){return q(U,k,$)},t.sort=function(k,U){return k.sort(function($,le){return t.compare($,le,U)})},t.rsort=function(k,U){return k.sort(function($,le){return t.rcompare($,le,U)})},t.gt=V,t.lt=J,t.eq=ee,t.neq=se,t.gte=re,t.lte=me,t.cmp=ve,t.Comparator=fe;var be={};function ye(k,U){if(k instanceof ye)return k.loose===U?k:new ye(k.raw,U);if(k instanceof fe)return new ye(k.value,U);if(!(this instanceof ye))return new ye(k,U);if(this.loose=U,this.raw=k,this.set=k.split(/\s*\|\|\s*/).map(function($){return this.parseRange($.trim())},this).filter(function($){return $.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+k);this.format()}function we(k){return!k||k.toLowerCase()==="x"||k==="*"}function Fe(k,U,$,le,he,Ce,Ee,Oe,Pe,Re,Ne,De,Te){return((U=we($)?"":we(le)?">="+$+".0.0":we(he)?">="+$+"."+le+".0":">="+U)+" "+(Oe=we(Pe)?"":we(Re)?"<"+(+Pe+1)+".0.0":we(Ne)?"<"+Pe+"."+(+Re+1)+".0":De?"<="+Pe+"."+Re+"."+Ne+"-"+De:"<="+Oe)).trim()}function Me(k,U){for(var $=0;$<k.length;$++)if(!k[$].test(U))return!1;if(U.prerelease.length){for($=0;$<k.length;$++)if(b(k[$].semver),k[$].semver!==be&&k[$].semver.prerelease.length>0){var le=k[$].semver;if(le.major===U.major&&le.minor===U.minor&&le.patch===U.patch)return!0}return!1}return!0}function ze(k,U,$){try{U=new ye(U,$)}catch(le){return!1}return U.test(k)}function Ue(k,U,$,le){var he,Ce,Ee,Oe,Pe;switch(k=new Z(k,le),U=new ye(U,le),$){case">":he=V,Ce=me,Ee=J,Oe=">",Pe=">=";break;case"<":he=J,Ce=re,Ee=V,Oe="<",Pe="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ze(k,U,le))return!1;for(var Re=0;Re<U.set.length;++Re){var Ne=U.set[Re],De=null,Te=null;if(Ne.forEach(function(ke){ke.semver===be&&(ke=new fe(">=0.0.0")),De=De||ke,Te=Te||ke,he(ke.semver,De.semver,le)?De=ke:Ee(ke.semver,Te.semver,le)&&(Te=ke)}),De.operator===Oe||De.operator===Pe||(!Te.operator||Te.operator===Oe)&&Ce(k,Te.semver)||Te.operator===Pe&&Ee(k,Te.semver))return!1}return!0}fe.prototype.parse=function(k){var U=this.loose?T[oe]:T[x],$=k.match(U);if(!$)throw new TypeError("Invalid comparator: "+k);this.operator=$[1],this.operator==="="&&(this.operator=""),$[2]?this.semver=new Z($[2],this.loose):this.semver=be},fe.prototype.toString=function(){return this.value},fe.prototype.test=function(k){return b("Comparator.test",k,this.loose),this.semver===be||(typeof k=="string"&&(k=new Z(k,this.loose)),ve(k,this.operator,this.semver,this.loose))},fe.prototype.intersects=function(k,U){if(!(k instanceof fe))throw new TypeError("a Comparator is required");var $;if(this.operator==="")return $=new ye(k.value,U),ze(this.value,$,U);if(k.operator==="")return $=new ye(this.value,U),ze(k.semver,$,U);var le=!(this.operator!==">="&&this.operator!==">"||k.operator!==">="&&k.operator!==">"),he=!(this.operator!=="<="&&this.operator!=="<"||k.operator!=="<="&&k.operator!=="<"),Ce=this.semver.version===k.semver.version,Ee=!(this.operator!==">="&&this.operator!=="<="||k.operator!==">="&&k.operator!=="<="),Oe=ve(this.semver,"<",k.semver,U)&&(this.operator===">="||this.operator===">")&&(k.operator==="<="||k.operator==="<"),Pe=ve(this.semver,">",k.semver,U)&&(this.operator==="<="||this.operator==="<")&&(k.operator===">="||k.operator===">");return le||he||Ce&&Ee||Oe||Pe},t.Range=ye,ye.prototype.format=function(){return this.range=this.set.map(function(k){return k.join(" ").trim()}).join("||").trim(),this.range},ye.prototype.toString=function(){return this.range},ye.prototype.parseRange=function(k){var U=this.loose;k=k.trim(),b("range",k,U);var $=U?T[H]:T[W];k=k.replace($,Fe),b("hyphen replace",k),k=k.replace(T[F],"$1$2$3"),b("comparator trim",k,T[F]),k=(k=(k=k.replace(T[te],"$1~")).replace(T[B],"$1^")).split(/\s+/).join(" ");var le=U?T[oe]:T[x],he=k.split(" ").map(function(Ce){return function(Ee,Oe){return b("comp",Ee),Ee=function(Pe,Re){return Pe.trim().split(/\s+/).map(function(Ne){return function(De,Te){b("caret",De,Te);var ke=Te?T[_]:T[K];return De.replace(ke,function(Ae,ge,pe,Se,Ie){var Le;return b("caret",De,Ae,ge,pe,Se,Ie),we(ge)?Le="":we(pe)?Le=">="+ge+".0.0 <"+(+ge+1)+".0.0":we(Se)?Le=ge==="0"?">="+ge+"."+pe+".0 <"+ge+"."+(+pe+1)+".0":">="+ge+"."+pe+".0 <"+(+ge+1)+".0.0":Ie?(b("replaceCaret pr",Ie),Ie.charAt(0)!=="-"&&(Ie="-"+Ie),Le=ge==="0"?pe==="0"?">="+ge+"."+pe+"."+Se+Ie+" <"+ge+"."+pe+"."+(+Se+1):">="+ge+"."+pe+"."+Se+Ie+" <"+ge+"."+(+pe+1)+".0":">="+ge+"."+pe+"."+Se+Ie+" <"+(+ge+1)+".0.0"):(b("no pr"),Le=ge==="0"?pe==="0"?">="+ge+"."+pe+"."+Se+" <"+ge+"."+pe+"."+(+Se+1):">="+ge+"."+pe+"."+Se+" <"+ge+"."+(+pe+1)+".0":">="+ge+"."+pe+"."+Se+" <"+(+ge+1)+".0.0"),b("caret return",Le),Le})}(Ne,Re)}).join(" ")}(Ee,Oe),b("caret",Ee),Ee=function(Pe,Re){return Pe.trim().split(/\s+/).map(function(Ne){return function(De,Te){var ke=Te?T[ce]:T[ue];return De.replace(ke,function(Ae,ge,pe,Se,Ie){var Le;return b("tilde",De,Ae,ge,pe,Se,Ie),we(ge)?Le="":we(pe)?Le=">="+ge+".0.0 <"+(+ge+1)+".0.0":we(Se)?Le=">="+ge+"."+pe+".0 <"+ge+"."+(+pe+1)+".0":Ie?(b("replaceTilde pr",Ie),Ie.charAt(0)!=="-"&&(Ie="-"+Ie),Le=">="+ge+"."+pe+"."+Se+Ie+" <"+ge+"."+(+pe+1)+".0"):Le=">="+ge+"."+pe+"."+Se+" <"+ge+"."+(+pe+1)+".0",b("tilde return",Le),Le})}(Ne,Re)}).join(" ")}(Ee,Oe),b("tildes",Ee),Ee=function(Pe,Re){return b("replaceXRanges",Pe,Re),Pe.split(/\s+/).map(function(Ne){return function(De,Te){De=De.trim();var ke=Te?T[O]:T[v];return De.replace(ke,function(Ae,ge,pe,Se,Ie,Le){b("xRange",De,Ae,ge,pe,Se,Ie,Le);var je=we(pe),Ve=je||we(Se),We=Ve||we(Ie);return ge==="="&&We&&(ge=""),je?Ae=ge===">"||ge==="<"?"<0.0.0":"*":ge&&We?(Ve&&(Se=0),We&&(Ie=0),ge===">"?(ge=">=",Ve?(pe=+pe+1,Se=0,Ie=0):We&&(Se=+Se+1,Ie=0)):ge==="<="&&(ge="<",Ve?pe=+pe+1:Se=+Se+1),Ae=ge+pe+"."+Se+"."+Ie):Ve?Ae=">="+pe+".0.0 <"+(+pe+1)+".0.0":We&&(Ae=">="+pe+"."+Se+".0 <"+pe+"."+(+Se+1)+".0"),b("xRange return",Ae),Ae})}(Ne,Re)}).join(" ")}(Ee,Oe),b("xrange",Ee),Ee=function(Pe,Re){return b("replaceStars",Pe,Re),Pe.trim().replace(T[X],"")}(Ee,Oe),b("stars",Ee),Ee}(Ce,U)}).join(" ").split(/\s+/);return this.loose&&(he=he.filter(function(Ce){return!!Ce.match(le)})),he=he.map(function(Ce){return new fe(Ce,U)})},ye.prototype.intersects=function(k,U){if(!(k instanceof ye))throw new TypeError("a Range is required");return this.set.some(function($){return $.every(function(le){return k.set.some(function(he){return he.every(function(Ce){return le.intersects(Ce,U)})})})})},t.toComparators=function(k,U){return new ye(k,U).set.map(function($){return $.map(function(le){return le.value}).join(" ").trim().split(" ")})},ye.prototype.test=function(k){if(!k)return!1;typeof k=="string"&&(k=new Z(k,this.loose));for(var U=0;U<this.set.length;U++)if(Me(this.set[U],k))return!0;return!1},t.satisfies=ze,t.maxSatisfying=function(k,U,$){var le=null,he=null;try{var Ce=new ye(U,$)}catch(Ee){return null}return k.forEach(function(Ee){Ce.test(Ee)&&(le&&he.compare(Ee)!==-1||(he=new Z(le=Ee,$)))}),le},t.minSatisfying=function(k,U,$){var le=null,he=null;try{var Ce=new ye(U,$)}catch(Ee){return null}return k.forEach(function(Ee){Ce.test(Ee)&&(le&&he.compare(Ee)!==1||(he=new Z(le=Ee,$)))}),le},t.validRange=function(k,U){try{return new ye(k,U).range||"*"}catch($){return null}},t.ltr=function(k,U,$){return Ue(k,U,"<",$)},t.gtr=function(k,U,$){return Ue(k,U,">",$)},t.outside=Ue,t.prerelease=function(k,U){var $=ie(k,U);return $&&$.prerelease.length?$.prerelease:null},t.intersects=function(k,U,$){return k=new ye(k,$),U=new ye(U,$),k.intersects(U)},t.coerce=function(k){if(k instanceof Z)return k;if(typeof k!="string")return null;var U=k.match(T[A]);return U==null?null:ie((U[1]||"0")+"."+(U[2]||"0")+"."+(U[3]||"0"))}}).call(this,L(1))},function(z,t){var L,I,b=z.exports={};function P(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function T(p){if(L===setTimeout)return setTimeout(p,0);if((L===P||!L)&&setTimeout)return L=setTimeout,setTimeout(p,0);try{return L(p,0)}catch(g){try{return L.call(null,p,0)}catch(y){return L.call(this,p,0)}}}(function(){try{L=typeof setTimeout=="function"?setTimeout:P}catch(p){L=P}try{I=typeof clearTimeout=="function"?clearTimeout:D}catch(p){I=D}})();var c,m=[],w=!1,C=-1;function f(){w&&c&&(w=!1,c.length?m=c.concat(m):C=-1,m.length&&S())}function S(){if(!w){var p=T(f);w=!0;for(var g=m.length;g;){for(c=m,m=[];++C<g;)c&&c[C].run();C=-1,g=m.length}c=null,w=!1,function(y){if(I===clearTimeout)return clearTimeout(y);if((I===D||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(y);try{I(y)}catch(l){try{return I.call(null,y)}catch(s){return I.call(this,y)}}}(p)}}function u(p,g){this.fun=p,this.array=g}function d(){}b.nextTick=function(p){var g=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)g[y-1]=arguments[y];m.push(new u(p,g)),m.length!==1||w||T(S)},u.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=d,b.addListener=d,b.once=d,b.off=d,b.removeListener=d,b.removeAllListeners=d,b.emit=d,b.prependListener=d,b.prependOnceListener=d,b.listeners=function(p){return[]},b.binding=function(p){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(p){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}}])}),define(Y[38],Q([0,1,8,2]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefixedStream=t.prefixedReadable=t.transform=t.toReadable=t.emptyStream=t.toStream=t.peekStream=t.listenStream=t.consumeStream=t.peekReadable=t.consumeReadable=t.newWriteableStream=t.isReadableBufferedStream=t.isReadableStream=void 0;function b(l){const s=l;return s?[s.on,s.pause,s.resume,s.destroy].every(a=>typeof a=="function"):!1}t.isReadableStream=b;function P(l){const s=l;return s?b(s.stream)&&Array.isArray(s.buffer)&&typeof s.ended=="boolean":!1}t.isReadableBufferedStream=P;function D(l,s){return new T(l,s)}t.newWriteableStream=D;class T{constructor(s,a){this.reducer=s,this.options=a,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(s){if(!this.state.destroyed){if(this.state.flowing)this.emitData(s);else if(this.buffer.data.push(s),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(a=>this.pendingWritePromises.push(a))}}error(s){this.state.destroyed||(this.state.flowing?this.emitError(s):this.buffer.error.push(s))}end(s){this.state.destroyed||(typeof s!="undefined"&&this.write(s),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(s){this.listeners.data.slice(0).forEach(a=>a(s))}emitError(s){this.listeners.error.length===0?(0,L.onUnexpectedError)(s):this.listeners.error.slice(0).forEach(a=>a(s))}emitEnd(){this.listeners.end.slice(0).forEach(s=>s())}on(s,a){if(!this.state.destroyed)switch(s){case"data":this.listeners.data.push(a),this.resume();break;case"end":this.listeners.end.push(a),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(a),this.state.flowing&&this.flowErrors();break}}removeListener(s,a){if(this.state.destroyed)return;let e;switch(s){case"data":e=this.listeners.data;break;case"end":e=this.listeners.end;break;case"error":e=this.listeners.error;break}if(e){const i=e.indexOf(a);i>=0&&e.splice(i,1)}}flowData(){if(this.buffer.data.length>0){const s=this.reducer(this.buffer.data);this.emitData(s),this.buffer.data.length=0;const a=[...this.pendingWritePromises];this.pendingWritePromises.length=0,a.forEach(e=>e())}}flowErrors(){if(this.listeners.error.length>0){for(const s of this.buffer.error)this.emitError(s);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}}function c(l,s){const a=[];let e;for(;(e=l.read())!==null;)a.push(e);return s(a)}t.consumeReadable=c;function m(l,s,a){const e=[];let i;for(;(i=l.read())!==null&&e.length<a;)e.push(i);return i===null&&e.length>0?s(e):{read:()=>{if(e.length>0)return e.shift();if(typeof i!="undefined"){const r=i;return i=void 0,r}return l.read()}}}t.peekReadable=m;function w(l,s){return new Promise((a,e)=>{const i=[];C(l,{onData:r=>{s&&i.push(r)},onError:r=>{s?e(r):a(void 0)},onEnd:()=>{a(s?s(i):void 0)}})})}t.consumeStream=w;function C(l,s){l.on("error",a=>s.onError(a)),l.on("end",()=>s.onEnd()),l.on("data",a=>s.onData(a))}t.listenStream=C;function f(l,s){return new Promise((a,e)=>{const i=new I.DisposableStore,r=[],n=E=>{if(r.push(E),r.length>s)return i.dispose(),l.pause(),a({stream:l,buffer:r,ended:!1})},o=E=>e(E),h=()=>a({stream:l,buffer:r,ended:!0});i.add((0,I.toDisposable)(()=>l.removeListener("error",o))),l.on("error",o),i.add((0,I.toDisposable)(()=>l.removeListener("end",h))),l.on("end",h),i.add((0,I.toDisposable)(()=>l.removeListener("data",n))),l.on("data",n)})}t.peekStream=f;function S(l,s){const a=D(s);return a.end(l),a}t.toStream=S;function u(){const l=D(()=>{throw new Error("not supported")});return l.end(),l}t.emptyStream=u;function d(l){let s=!1;return{read:()=>s?null:(s=!0,l)}}t.toReadable=d;function p(l,s,a){const e=D(a);return C(l,{onData:i=>e.write(s.data(i)),onError:i=>e.error(s.error?s.error(i):i),onEnd:()=>e.end()}),e}t.transform=p;function g(l,s,a){let e=!1;return{read:()=>{const i=s.read();return e?i:(e=!0,i!==null?a([l,i]):l)}}}t.prefixedReadable=g;function y(l,s,a){let e=!1;const i=D(a);return C(s,{onData:r=>e?i.write(r):(e=!0,i.write(a([l,r]))),onError:r=>i.error(r),onEnd:()=>{e||(e=!0,i.write(l)),i.end()}}),i}t.prefixedStream=y}),define(Y[17],Q([0,1,38]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefixedBufferStream=t.prefixedBufferReadable=t.newWriteableBufferStream=t.streamToBufferReadableStream=t.bufferToStream=t.bufferedStreamToBuffer=t.streamToBuffer=t.bufferToReadable=t.readableToBuffer=t.writeUInt8=t.readUInt8=t.writeUInt32LE=t.readUInt32LE=t.writeUInt32BE=t.readUInt32BE=t.writeUInt16LE=t.readUInt16LE=t.VSBuffer=void 0;const I=typeof Buffer!="undefined";let b,P;class D{constructor(n){this.buffer=n,this.byteLength=this.buffer.byteLength}static alloc(n){return I?new D(Buffer.allocUnsafe(n)):new D(new Uint8Array(n))}static wrap(n){return I&&!Buffer.isBuffer(n)&&(n=Buffer.from(n.buffer,n.byteOffset,n.byteLength)),new D(n)}static fromString(n,o){return!(o?.dontUseNodeBuffer||!1)&&I?new D(Buffer.from(n)):(b||(b=new TextEncoder),new D(b.encode(n)))}static concat(n,o){if(typeof o=="undefined"){o=0;for(let R=0,v=n.length;R<v;R++)o+=n[R].byteLength}const h=D.alloc(o);let E=0;for(let R=0,v=n.length;R<v;R++){const O=n[R];h.set(O,E),E+=O.byteLength}return h}toString(){return I?this.buffer.toString():(P||(P=new TextDecoder),P.decode(this.buffer))}slice(n,o){return new D(this.buffer.subarray(n,o))}set(n,o){n instanceof D?this.buffer.set(n.buffer,o):this.buffer.set(n,o)}readUInt32BE(n){return m(this.buffer,n)}writeUInt32BE(n,o){w(this.buffer,n,o)}readUInt32LE(n){return C(this.buffer,n)}writeUInt32LE(n,o){f(this.buffer,n,o)}readUInt8(n){return S(this.buffer,n)}writeUInt8(n,o){u(this.buffer,n,o)}}t.VSBuffer=D;function T(r,n){return r[n+0]<<0>>>0|r[n+1]<<8>>>0}t.readUInt16LE=T;function c(r,n,o){r[o+0]=n&255,n=n>>>8,r[o+1]=n&255}t.writeUInt16LE=c;function m(r,n){return r[n]*2**24+r[n+1]*2**16+r[n+2]*2**8+r[n+3]}t.readUInt32BE=m;function w(r,n,o){r[o+3]=n,n=n>>>8,r[o+2]=n,n=n>>>8,r[o+1]=n,n=n>>>8,r[o]=n}t.writeUInt32BE=w;function C(r,n){return r[n+0]<<0>>>0|r[n+1]<<8>>>0|r[n+2]<<16>>>0|r[n+3]<<24>>>0}t.readUInt32LE=C;function f(r,n,o){r[o+0]=n&255,n=n>>>8,r[o+1]=n&255,n=n>>>8,r[o+2]=n&255,n=n>>>8,r[o+3]=n&255}t.writeUInt32LE=f;function S(r,n){return r[n]}t.readUInt8=S;function u(r,n,o){r[o]=n}t.writeUInt8=u;function d(r){return L.consumeReadable(r,n=>D.concat(n))}t.readableToBuffer=d;function p(r){return L.toReadable(r)}t.bufferToReadable=p;function g(r){return L.consumeStream(r,n=>D.concat(n))}t.streamToBuffer=g;async function y(r){return r.ended?D.concat(r.buffer):D.concat([...r.buffer,await g(r.stream)])}t.bufferedStreamToBuffer=y;function l(r){return L.toStream(r,n=>D.concat(n))}t.bufferToStream=l;function s(r){return L.transform(r,{data:n=>typeof n=="string"?D.fromString(n):D.wrap(n)},n=>D.concat(n))}t.streamToBufferReadableStream=s;function a(r){return L.newWriteableStream(n=>D.concat(n),r)}t.newWriteableBufferStream=a;function e(r,n){return L.prefixedReadable(r,n,o=>D.concat(o))}t.prefixedBufferReadable=e;function i(r,n){return L.prefixedStream(r,n,o=>D.concat(o))}t.prefixedBufferStream=i}),define(Y[18],Q([0,1,11]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filter=t.getCaseInsensitive=t.distinct=t.getOrDefault=t.safeStringify=t.equals=t.mixin=t.cloneAndChange=t.deepFreeze=t.deepClone=void 0;function I(d){if(!d||typeof d!="object"||d instanceof RegExp)return d;const p=Array.isArray(d)?[]:{};return Object.keys(d).forEach(g=>{d[g]&&typeof d[g]=="object"?p[g]=I(d[g]):p[g]=d[g]}),p}t.deepClone=I;function b(d){if(!d||typeof d!="object")return d;const p=[d];for(;p.length>0;){const g=p.shift();Object.freeze(g);for(const y in g)if(P.call(g,y)){const l=g[y];typeof l=="object"&&!Object.isFrozen(l)&&p.push(l)}}return d}t.deepFreeze=b;const P=Object.prototype.hasOwnProperty;function D(d,p){return T(d,p,new Set)}t.cloneAndChange=D;function T(d,p,g){if((0,L.isUndefinedOrNull)(d))return d;const y=p(d);if(typeof y!="undefined")return y;if((0,L.isArray)(d)){const l=[];for(const s of d)l.push(T(s,p,g));return l}if((0,L.isObject)(d)){if(g.has(d))throw new Error("Cannot clone recursive data-structure");g.add(d);const l={};for(let s in d)P.call(d,s)&&(l[s]=T(d[s],p,g));return g.delete(d),l}return d}function c(d,p,g=!0){return(0,L.isObject)(d)?((0,L.isObject)(p)&&Object.keys(p).forEach(y=>{y in d?g&&((0,L.isObject)(d[y])&&(0,L.isObject)(p[y])?c(d[y],p[y],g):d[y]=p[y]):d[y]=p[y]}),d):p}t.mixin=c;function m(d,p){if(d===p)return!0;if(d==null||p===null||p===void 0||typeof d!=typeof p||typeof d!="object"||Array.isArray(d)!==Array.isArray(p))return!1;let g,y;if(Array.isArray(d)){if(d.length!==p.length)return!1;for(g=0;g<d.length;g++)if(!m(d[g],p[g]))return!1}else{const l=[];for(y in d)l.push(y);l.sort();const s=[];for(y in p)s.push(y);if(s.sort(),!m(l,s))return!1;for(g=0;g<l.length;g++)if(!m(d[l[g]],p[l[g]]))return!1}return!0}t.equals=m;function w(d){const p=new Set;return JSON.stringify(d,(g,y)=>{if((0,L.isObject)(y)||Array.isArray(y)){if(p.has(y))return"[Circular]";p.add(y)}return y})}t.safeStringify=w;function C(d,p,g){const y=p(d);return typeof y=="undefined"?g:y}t.getOrDefault=C;function f(d,p){const g=Object.create(null);return!d||!p||Object.keys(p).forEach(l=>{const s=d[l],a=p[l];m(s,a)||(g[l]=a)}),g}t.distinct=f;function S(d,p){const g=p.toLowerCase(),y=Object.keys(d).find(l=>l.toLowerCase()===g);return y?d[y]:d[p]}t.getCaseInsensitive=S;function u(d,p){const g=Object.create(null);for(const y of Object.keys(d))p(y,d[y])&&(g[y]=d[y]);return g}t.filter=u}),define(Y[59],Q([0,1,9]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.getFirstFrame=t.parse=t.isRemoteConsoleLog=void 0;function I(m){const w=m;return w&&typeof w.type=="string"&&typeof w.severity=="string"}t.isRemoteConsoleLog=I;function b(m){const w=[];let C;try{const f=JSON.parse(m.arguments),S=f[f.length-1];S&&S.__$stack&&(f.pop(),C=S.__$stack),w.push(...f)}catch(f){w.push("Unable to log remote console arguments",m.arguments)}return{args:w,stack:C}}t.parse=b;function P(m){if(typeof m!="string")return P(b(m).stack);const w=m;if(w){const C=D(w),f=/at [^\/]*((?:(?:[a-zA-Z]+:)|(?:[\/])|(?:\\\\))(?:.+)):(\d+):(\d+)/.exec(C||"");if(f&&f.length===4)return{uri:L.URI.file(f[1]),line:Number(f[2]),column:Number(f[3])}}}t.getFirstFrame=P;function D(m){if(!m)return m;const w=m.indexOf(`
`);return w===-1?m:m.substring(0,w)}function T(m,w){const{args:C,stack:f}=b(m),S=typeof C[0]=="string"&&C.length===1;let u=D(f);u&&(u=`(${u.trim()})`);let d=[];if(typeof C[0]=="string"?u&&S?d=[`%c[${w}] %c${C[0]} %c${u}`,c("blue"),c(""),c("grey")]:d=[`%c[${w}] %c${C[0]}`,c("blue"),c(""),...C.slice(1)]:d=[`%c[${w}]%`,c("blue"),...C],u&&!S&&d.push(u),typeof console[m.severity]!="function")throw new Error("Unknown console method");console[m.severity].apply(console,d)}t.log=T;function c(m){return`color: ${m}`}}),define(Y[60],Q([0,1,17,27,9]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revive=t.MarshalledId=t.parse=t.stringify=void 0;function P(w){return JSON.stringify(w,c)}t.stringify=P;function D(w){let C=JSON.parse(w);return C=m(C),C}t.parse=D;var T;(function(w){w[w.Uri=1]="Uri",w[w.Regexp=2]="Regexp",w[w.ScmResource=3]="ScmResource",w[w.ScmResourceGroup=4]="ScmResourceGroup",w[w.ScmProvider=5]="ScmProvider",w[w.CommentController=6]="CommentController",w[w.CommentThread=7]="CommentThread",w[w.CommentThreadReply=8]="CommentThreadReply",w[w.CommentNode=9]="CommentNode",w[w.CommentThreadNode=10]="CommentThreadNode",w[w.TimelineActionContext=11]="TimelineActionContext",w[w.NotebookCellActionContext=12]="NotebookCellActionContext",w[w.TestItemContext=13]="TestItemContext"})(T=t.MarshalledId||(t.MarshalledId={}));function c(w,C){return C instanceof RegExp?{$mid:2,source:C.source,flags:(0,I.regExpFlags)(C)}:C}function m(w,C=0){if(!w||C>200)return w;if(typeof w=="object"){switch(w.$mid){case 1:return b.URI.revive(w);case 2:return new RegExp(w.source,w.flags)}if(w instanceof L.VSBuffer||w instanceof Uint8Array)return w;if(Array.isArray(w))for(let f=0;f<w.length;++f)w[f]=m(w[f],C+1);else for(const f in w)Object.hasOwnProperty.call(w,f)&&(w[f]=m(w[f],C+1))}return w}t.revive=m}),define(Y[61],Q([0,1,46,6,7,12,19,27,9]),function(z,t,L,I,b,P,D,T,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitName=t.unmnemonicLabel=t.mnemonicButtonLabel=t.mnemonicMenuLabel=t.template=t.shorten=t.untildify=t.tildify=t.normalizeDriveLetter=t.getBaseLabel=t.getPathLabel=void 0;function m(n,o,h){if(typeof n=="string"&&(n=c.URI.file(n)),h){const R=h.getWorkspaceFolder(n);if(R){const v=h.getWorkspace().folders.length>1;let O;if((0,D.isEqual)(R.uri,n)?O="":O=(0,D.relativePath)(R.uri,n),v){const A=R.name?R.name:(0,D.basename)(R.uri);O=O?A+" \u2022 "+O:A}return O}}if(n.scheme!==I.Schemas.file&&n.scheme!==I.Schemas.untitled)return n.with({query:null,fragment:null}).toString(!0);if((0,L.hasDriveLetter)(n.fsPath))return(0,b.normalize)(C(n.fsPath));let E=(0,b.normalize)(n.fsPath);return!P.isWindows&&o?.userHome&&(E=S(E,o.userHome.fsPath)),E}t.getPathLabel=m;function w(n){if(!n)return;typeof n=="string"&&(n=c.URI.file(n));const o=(0,D.basename)(n)||(n.scheme===I.Schemas.file?n.fsPath:n.path);return P.isWindows&&(0,L.isRootOrDriveLetter)(o)?C(o):o}t.getBaseLabel=w;function C(n){return(0,L.hasDriveLetter)(n)?n.charAt(0).toUpperCase()+n.slice(1):n}t.normalizeDriveLetter=C;let f=Object.create(null);function S(n,o){if(P.isWindows||!n||!o)return n;let h=f.original===o?f.normalized:void 0;return h||(h=`${(0,T.rtrim)(o,b.posix.sep)}${b.posix.sep}`,f={original:o,normalized:h}),(P.isLinux?n.startsWith(h):(0,T.startsWithIgnoreCase)(n,h))&&(n=`~/${n.substr(h.length)}`),n}t.tildify=S;function u(n,o){return n.replace(/^~($|\/|\\)/,`${o}$1`)}t.untildify=u;const d="\u2026",p="\\\\",g="~";function y(n,o=b.sep){const h=new Array(n.length);let E=!1;for(let R=0;R<n.length;R++){let v=n[R];if(v===""){h[R]=`.${o}`;continue}if(!v){h[R]=v;continue}E=!0;let O="";v.indexOf(p)===0?(O=v.substr(0,v.indexOf(p)+p.length),v=v.substr(v.indexOf(p)+p.length)):v.indexOf(o)===0?(O=v.substr(0,v.indexOf(o)+o.length),v=v.substr(v.indexOf(o)+o.length)):v.indexOf(g)===0&&(O=v.substr(0,v.indexOf(g)+g.length),v=v.substr(v.indexOf(g)+g.length));const A=v.split(o);for(let G=1;E&&G<=A.length;G++)for(let te=A.length-G;E&&te>=0;te--){E=!1;let ue=A.slice(te,te+G).join(o);for(let ce=0;!E&&ce<n.length;ce++)if(ce!==R&&n[ce]&&n[ce].indexOf(ue)>-1){const ne=te+G===A.length,B=te>0&&n[ce].indexOf(o)>-1?o+ue:ue,K=n[ce].endsWith(B);E=!ne||K}if(!E){let ce="";(A[0].endsWith(":")||O!=="")&&(te===1&&(te=0,G++,ue=A[0]+o+ue),te>0&&(ce=A[0]+o),ce=O+ce),te>0&&(ce=ce+d+o),ce=ce+ue,te+G<A.length&&(ce=ce+o+d),h[R]=ce}}E&&(h[R]=v)}return h}t.shorten=y;var l;(function(n){n[n.TEXT=0]="TEXT",n[n.VARIABLE=1]="VARIABLE",n[n.SEPARATOR=2]="SEPARATOR"})(l||(l={}));function s(n,o=Object.create(null)){const h=[];let E=!1,R="";for(const v of n)if(v==="$"||E&&v==="{")R&&h.push({value:R,type:l.TEXT}),R="",E=!0;else if(v==="}"&&E){const O=o[R];if(typeof O=="string")O.length&&h.push({value:O,type:l.VARIABLE});else if(O){const A=h[h.length-1];(!A||A.type!==l.SEPARATOR)&&h.push({value:O.label,type:l.SEPARATOR})}R="",E=!1}else R+=v;return R&&!E&&h.push({value:R,type:l.TEXT}),h.filter((v,O)=>{if(v.type===l.SEPARATOR){const A=h[O-1],G=h[O+1];return[A,G].every(te=>te&&(te.type===l.VARIABLE||te.type===l.TEXT)&&te.value.length>0)}return!0}).map(v=>v.value).join("")}t.template=s;function a(n,o){return P.isMacintosh||o?n.replace(/\(&&\w\)|&&/g,"").replace(/&/g,P.isMacintosh?"&":"&&"):n.replace(/&&|&/g,h=>h==="&"?"&&":"&")}t.mnemonicMenuLabel=a;function e(n,o){return P.isMacintosh||o?n.replace(/\(&&\w\)|&&/g,""):P.isWindows?n.replace(/&&|&/g,h=>h==="&"?"&&":"&"):n.replace(/&&/g,"_")}t.mnemonicButtonLabel=e;function i(n){return n.replace(/&/g,"&&")}t.unmnemonicLabel=i;function r(n){const o=n.indexOf("/")!==-1?b.posix:b.win32,h=o.basename(n),E=o.dirname(n);return h.length?{name:h,parentPath:E}:{name:E,parentPath:""}}t.splitName=r}),define(Y[62],Q([0,1,128]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineDecoder=void 0;class I{constructor(P="utf8"){this.stringDecoder=new L.StringDecoder(P),this.remaining=null}write(P){const D=[],T=this.remaining?this.remaining+this.stringDecoder.write(P):this.stringDecoder.write(P);if(T.length<1)return D;let c=0,m,w=c;for(;w<T.length;)if(m=T.charCodeAt(w),m===13||m===10){if(D.push(T.substring(c,w)),w++,w<T.length){const C=m;m=T.charCodeAt(w),(C===13&&m===10||C===10&&m===13)&&w++}c=w}else w++;return this.remaining=c<T.length?T.substr(c):null,D}end(){return this.remaining}}t.LineDecoder=I}),define(Y[63],Q([0,1,47,7,27,13]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.realpathSync=t.realpath=t.realcaseSync=void 0;function D(w){const C=(0,I.dirname)(w);if(w===C)return w;const f=((0,I.basename)(w)||w).toLowerCase();try{const u=(0,P.readdirSync)(C).filter(d=>d.toLowerCase()===f);if(u.length===1){const d=D(C);if(d)return(0,I.join)(d,u[0])}else if(u.length>1){const d=u.indexOf(f);if(d>=0){const p=D(C);if(p)return(0,I.join)(p,u[d])}}}catch(S){}return null}t.realcaseSync=D;async function T(w){try{return await P.Promises.realpath(w)}catch(C){const f=m(w);return await P.Promises.access(f,L.constants.R_OK),f}}t.realpath=T;function c(w){try{return L.realpathSync(w)}catch(C){const f=m(w);return L.accessSync(f,L.constants.R_OK),f}}t.realpathSync=c;function m(w){return(0,b.rtrim)((0,I.normalize)(w),I.sep)}}),define(Y[64],Q([0,1,35,7,13]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstAvailablePowerShellInstallation=t.enumeratePowerShellInstallations=void 0;const P=/^\d+$/,D=/^Microsoft.PowerShell_.*/,T=/^Microsoft.PowerShellPreview_.*/;var c;(function(s){s[s.x64=0]="x64",s[s.x86=1]="x86",s[s.ARM=2]="ARM"})(c||(c={}));let m;switch(process.arch){case"ia32":case"x32":m=1;break;case"arm":case"arm64":m=2;break;default:m=0;break}let w;process.env.PROCESSOR_ARCHITEW6432?w=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?w=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?w=1:w=0;class C{constructor(a,e,i){this.exePath=a,this.displayName=e,this.knownToExist=i}async exists(){return this.knownToExist===void 0&&(this.knownToExist=await b.SymlinkSupport.existsFile(this.exePath)),this.knownToExist}}function f({useAlternateBitness:s=!1}={}){return s?m===0?process.env["ProgramFiles(x86)"]||null:w===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function S({useAlternateBitness:s=!1,findPreview:a=!1}={}){const e=f({useAlternateBitness:s});if(!e)return null;const i=I.join(e,"PowerShell");if(!await b.SymlinkSupport.existsDirectory(i))return null;let r=-1,n=null;for(const E of await b.Promises.readdir(i)){let R=-1;if(a){const O=E.indexOf("-");if(O<0)continue;const A=E.substring(0,O);if(!P.test(A)||E.substring(O+1)!=="preview")continue;R=parseInt(A,10)}else{if(!P.test(E))continue;R=parseInt(E,10)}if(R<=r)continue;const v=I.join(i,E,"pwsh.exe");!await b.SymlinkSupport.existsFile(v)||(n=v,r=R)}if(!n)return null;const o=e.includes("x86")?" (x86)":"",h=a?" Preview":"";return new C(n,`PowerShell${h}${o}`,!0)}async function u({findPreview:s}={}){if(!process.env.LOCALAPPDATA)return null;const a=I.join(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await b.SymlinkSupport.existsDirectory(a))return null;const{pwshMsixDirRegex:e,pwshMsixName:i}=s?{pwshMsixDirRegex:T,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:D,pwshMsixName:"PowerShell (Store)"};for(const r of await b.Promises.readdir(a))if(e.test(r)){const n=I.join(a,r,"pwsh.exe");return new C(n,i)}return null}function d(){const s=I.join(L.homedir(),".dotnet","tools","pwsh.exe");return new C(s,".NET Core PowerShell Global Tool")}function p(){const s=I.join(process.env.windir,m===1&&w!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new C(s,"Windows PowerShell",!0)}async function*g(){let s=await S();s&&(yield s),s=await S({useAlternateBitness:!0}),s&&(yield s),s=await u(),s&&(yield s),s=d(),s&&(yield s),s=await S({findPreview:!0}),s&&(yield s),s=await u({findPreview:!0}),s&&(yield s),s=await S({useAlternateBitness:!0,findPreview:!0}),s&&(yield s),s=p(),s&&(yield s)}async function*y(){for await(const s of g())await s.exists()&&(yield s)}t.enumeratePowerShellInstallations=y;async function l(){for await(const s of y())return s;return null}t.getFirstAvailablePowerShellInstallation=l});var de=this&&this.__decorate||function(z,t,L,I){var b=arguments.length,P=b<3?t:I===null?I=Object.getOwnPropertyDescriptor(t,L):I,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(z,t,L,I);else for(var T=z.length-1;T>=0;T--)(D=z[T])&&(P=(b<3?D(P):b>3?D(t,L,P):D(t,L))||P);return b>3&&P&&Object.defineProperty(t,L,P),P};define(Y[36],Q([0,1,20,3,17,24,45,8,10,2,60,27,11]),function(z,t,L,I,b,P,D,T,c,m,w,C,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPCLogger=t.logWithColors=t.ProxyChannel=t.StaticRouter=t.getNextTickChannel=t.getDelayedChannel=t.IPCClient=t.IPCServer=t.ChannelClient=t.RequestInitiator=t.ChannelServer=t.ResponseType=t.RequestType=void 0;var S;(function(x){x[x.Promise=100]="Promise",x[x.PromiseCancel=101]="PromiseCancel",x[x.EventListen=102]="EventListen",x[x.EventDispose=103]="EventDispose"})(S=t.RequestType||(t.RequestType={}));function u(x){switch(x){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}var d;(function(x){x[x.Initialize=200]="Initialize",x[x.PromiseSuccess=201]="PromiseSuccess",x[x.PromiseError=202]="PromiseError",x[x.PromiseErrorObj=203]="PromiseErrorObj",x[x.EventFire=204]="EventFire"})(d=t.ResponseType||(t.ResponseType={}));function p(x){switch(x){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}var g;(function(x){x[x.Uninitialized=0]="Uninitialized",x[x.Idle=1]="Idle"})(g||(g={}));class y{constructor(F){this.buffer=F,this.pos=0}read(F){const W=this.buffer.slice(this.pos,this.pos+F);return this.pos+=W.byteLength,W}}class l{constructor(){this.buffers=[]}get buffer(){return b.VSBuffer.concat(this.buffers)}write(F){this.buffers.push(F)}}var s;(function(x){x[x.Undefined=0]="Undefined",x[x.String=1]="String",x[x.Buffer=2]="Buffer",x[x.VSBuffer=3]="VSBuffer",x[x.Array=4]="Array",x[x.Object=5]="Object"})(s||(s={}));function a(x){const F=b.VSBuffer.alloc(4);return F.writeUInt32BE(x,0),F}function e(x){return x.read(4).readUInt32BE(0)}function i(x){const F=b.VSBuffer.alloc(1);return F.writeUInt8(x,0),F}const r={Undefined:i(s.Undefined),String:i(s.String),Buffer:i(s.Buffer),VSBuffer:i(s.VSBuffer),Array:i(s.Array),Object:i(s.Object)},n=typeof Buffer!="undefined";function o(x,F){if(typeof F=="undefined")x.write(r.Undefined);else if(typeof F=="string"){const W=b.VSBuffer.fromString(F);x.write(r.String),x.write(a(W.byteLength)),x.write(W)}else if(n&&Buffer.isBuffer(F)){const W=b.VSBuffer.wrap(F);x.write(r.Buffer),x.write(a(W.byteLength)),x.write(W)}else if(F instanceof b.VSBuffer)x.write(r.VSBuffer),x.write(a(F.byteLength)),x.write(F);else if(Array.isArray(F)){x.write(r.Array),x.write(a(F.length));for(const W of F)o(x,W)}else{const W=b.VSBuffer.fromString(JSON.stringify(F));x.write(r.Object),x.write(a(W.byteLength)),x.write(W)}}function h(x){switch(x.read(1).readUInt8(0)){case s.Undefined:return;case s.String:return x.read(e(x)).toString();case s.Buffer:return x.read(e(x)).buffer;case s.VSBuffer:return x.read(e(x));case s.Array:{const W=e(x),H=[];for(let X=0;X<W;X++)H.push(h(x));return H}case s.Object:return JSON.parse(x.read(e(x)).toString())}}class E{constructor(F,W,H=null,X=1e3){this.protocol=F,this.ctx=W,this.logger=H,this.timeoutDelay=X,this.channels=new Map,this.activeRequests=new Map,this.pendingRequests=new Map,this.protocolListener=this.protocol.onMessage(j=>this.onRawMessage(j)),this.sendResponse({type:200})}registerChannel(F,W){this.channels.set(F,W),setTimeout(()=>this.flushPendingRequests(F),0)}sendResponse(F){switch(F.type){case 200:{const W=this.send([F.type]);this.logger&&this.logger.logOutgoing(W,0,1,p(F.type));return}case 201:case 202:case 204:case 203:{const W=this.send([F.type,F.id],F.data);this.logger&&this.logger.logOutgoing(W,F.id,1,p(F.type),F.data);return}}}send(F,W=void 0){const H=new l;return o(H,F),o(H,W),this.sendBuffer(H.buffer)}sendBuffer(F){try{return this.protocol.send(F),F.byteLength}catch(W){return 0}}onRawMessage(F){const W=new y(F),H=h(W),X=h(W),j=H[0];switch(j){case 100:return this.logger&&this.logger.logIncoming(F.byteLength,H[1],1,`${u(j)}: ${H[2]}.${H[3]}`,X),this.onPromise({type:j,id:H[1],channelName:H[2],name:H[3],arg:X});case 102:return this.logger&&this.logger.logIncoming(F.byteLength,H[1],1,`${u(j)}: ${H[2]}.${H[3]}`,X),this.onEventListen({type:j,id:H[1],channelName:H[2],name:H[3],arg:X});case 101:return this.logger&&this.logger.logIncoming(F.byteLength,H[1],1,`${u(j)}`),this.disposeActiveRequest({type:j,id:H[1]});case 103:return this.logger&&this.logger.logIncoming(F.byteLength,H[1],1,`${u(j)}`),this.disposeActiveRequest({type:j,id:H[1]})}}onPromise(F){const W=this.channels.get(F.channelName);if(!W){this.collectPendingRequest(F);return}const H=new P.CancellationTokenSource;let X;try{X=W.call(this.ctx,F.name,F.arg,H.token)}catch(Z){X=Promise.reject(Z)}const j=F.id;X.then(Z=>{this.sendResponse({id:j,data:Z,type:201}),this.activeRequests.delete(F.id)},Z=>{Z instanceof Error?this.sendResponse({id:j,data:{message:Z.message,name:Z.name,stack:Z.stack?Z.stack.split?Z.stack.split(`
`):Z.stack:void 0},type:202}):this.sendResponse({id:j,data:Z,type:203}),this.activeRequests.delete(F.id)});const ie=(0,m.toDisposable)(()=>H.cancel());this.activeRequests.set(F.id,ie)}onEventListen(F){const W=this.channels.get(F.channelName);if(!W){this.collectPendingRequest(F);return}const H=F.id,j=W.listen(this.ctx,F.name,F.arg)(ie=>this.sendResponse({id:H,data:ie,type:204}));this.activeRequests.set(F.id,j)}disposeActiveRequest(F){const W=this.activeRequests.get(F.id);W&&(W.dispose(),this.activeRequests.delete(F.id))}collectPendingRequest(F){let W=this.pendingRequests.get(F.channelName);W||(W=[],this.pendingRequests.set(F.channelName,W));const H=setTimeout(()=>{console.error(`Unknown channel: ${F.channelName}`),F.type===100&&this.sendResponse({id:F.id,data:{name:"Unknown channel",message:`Channel name '${F.channelName}' timed out after ${this.timeoutDelay}ms`,stack:void 0},type:202})},this.timeoutDelay);W.push({request:F,timeoutTimer:H})}flushPendingRequests(F){const W=this.pendingRequests.get(F);if(W){for(const H of W)switch(clearTimeout(H.timeoutTimer),H.request.type){case 100:this.onPromise(H.request);break;case 102:this.onEventListen(H.request);break}this.pendingRequests.delete(F)}}dispose(){this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),this.activeRequests.forEach(F=>F.dispose()),this.activeRequests.clear()}}t.ChannelServer=E;var R;(function(x){x[x.LocalSide=0]="LocalSide",x[x.OtherSide=1]="OtherSide"})(R=t.RequestInitiator||(t.RequestInitiator={}));class v{constructor(F,W=null){this.protocol=F,this.isDisposed=!1,this.state=g.Uninitialized,this.activeRequests=new Set,this.handlers=new Map,this.lastRequestId=0,this._onDidInitialize=new c.Emitter,this.onDidInitialize=this._onDidInitialize.event,this.protocolListener=this.protocol.onMessage(H=>this.onBuffer(H)),this.logger=W}getChannel(F){const W=this;return{call(H,X,j){return W.isDisposed?Promise.reject(T.canceled()):W.requestPromise(F,H,X,j)},listen(H,X){return W.isDisposed?Promise.reject(T.canceled()):W.requestEvent(F,H,X)}}}requestPromise(F,W,H,X=P.CancellationToken.None){const j=this.lastRequestId++,Z={id:j,type:100,channelName:F,name:W,arg:H};if(X.isCancellationRequested)return Promise.reject(T.canceled());let M;return new Promise((q,V)=>{if(X.isCancellationRequested)return V(T.canceled());const J=()=>{const me=ve=>{switch(ve.type){case 201:this.handlers.delete(j),q(ve.data);break;case 202:this.handlers.delete(j);const fe=new Error(ve.data.message);fe.stack=ve.data.stack,fe.name=ve.data.name,V(fe);break;case 203:this.handlers.delete(j),V(ve.data);break}};this.handlers.set(j,me),this.sendRequest(Z)};let ee=null;this.state===g.Idle?J():(ee=(0,I.createCancelablePromise)(me=>this.whenInitialized()),ee.then(()=>{ee=null,J()}));const se=()=>{ee?(ee.cancel(),ee=null):this.sendRequest({id:j,type:101}),V(T.canceled())},re=X.onCancellationRequested(se);M=(0,m.combinedDisposable)((0,m.toDisposable)(se),re),this.activeRequests.add(M)}).finally(()=>{this.activeRequests.delete(M)})}requestEvent(F,W,H){const X=this.lastRequestId++,ie={id:X,type:102,channelName:F,name:W,arg:H};let Z=null;const M=new c.Emitter({onFirstListenerAdd:()=>{Z=(0,I.createCancelablePromise)(q=>this.whenInitialized()),Z.then(()=>{Z=null,this.activeRequests.add(M),this.sendRequest(ie)})},onLastListenerRemove:()=>{Z?(Z.cancel(),Z=null):(this.activeRequests.delete(M),this.sendRequest({id:X,type:103}))}}),N=q=>M.fire(q.data);return this.handlers.set(X,N),M.event}sendRequest(F){switch(F.type){case 100:case 102:{const W=this.send([F.type,F.id,F.channelName,F.name],F.arg);this.logger&&this.logger.logOutgoing(W,F.id,0,`${u(F.type)}: ${F.channelName}.${F.name}`,F.arg);return}case 101:case 103:{const W=this.send([F.type,F.id]);this.logger&&this.logger.logOutgoing(W,F.id,0,u(F.type));return}}}send(F,W=void 0){const H=new l;return o(H,F),o(H,W),this.sendBuffer(H.buffer)}sendBuffer(F){try{return this.protocol.send(F),F.byteLength}catch(W){return 0}}onBuffer(F){const W=new y(F),H=h(W),X=h(W),j=H[0];switch(j){case 200:return this.logger&&this.logger.logIncoming(F.byteLength,0,0,p(j)),this.onResponse({type:H[0]});case 201:case 202:case 204:case 203:return this.logger&&this.logger.logIncoming(F.byteLength,H[1],0,p(j),X),this.onResponse({type:H[0],id:H[1],data:X})}}onResponse(F){if(F.type===200){this.state=g.Idle,this._onDidInitialize.fire();return}const W=this.handlers.get(F.id);W&&W(F)}get onDidInitializePromise(){return c.Event.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===g.Idle?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),this.activeRequests.forEach(F=>F.dispose()),this.activeRequests.clear()}}de([D.memoize],v.prototype,"onDidInitializePromise",null),t.ChannelClient=v;class O{constructor(F){this.channels=new Map,this._connections=new Set,this._onDidAddConnection=new c.Emitter,this.onDidAddConnection=this._onDidAddConnection.event,this._onDidRemoveConnection=new c.Emitter,this.onDidRemoveConnection=this._onDidRemoveConnection.event,F(({protocol:W,onDidClientDisconnect:H})=>{c.Event.once(W.onMessage)(j=>{const ie=new y(j),Z=h(ie),M=new E(W,Z),N=new v(W);this.channels.forEach((V,J)=>M.registerChannel(J,V));const q={channelServer:M,channelClient:N,ctx:Z};this._connections.add(q),this._onDidAddConnection.fire(q),H(()=>{M.dispose(),N.dispose(),this._connections.delete(q),this._onDidRemoveConnection.fire(q)})})})}get connections(){const F=[];return this._connections.forEach(W=>F.push(W)),F}getChannel(F,W){const H=this;return{call(X,j,ie){let Z;if((0,f.isFunction)(W)){let N=(0,L.getRandomElement)(H.connections.filter(W));Z=N?Promise.resolve(N):c.Event.toPromise(c.Event.filter(H.onDidAddConnection,W))}else Z=W.routeCall(H,X,j);const M=Z.then(N=>N.channelClient.getChannel(F));return G(M).call(X,j,ie)},listen(X,j){if((0,f.isFunction)(W))return H.getMulticastEvent(F,W,X,j);const ie=W.routeEvent(H,X,j).then(Z=>Z.channelClient.getChannel(F));return G(ie).listen(X,j)}}}getMulticastEvent(F,W,H,X){const j=this;let ie=new m.DisposableStore;const Z=new c.Emitter({onFirstListenerAdd:()=>{ie=new m.DisposableStore;const M=new c.EventMultiplexer,N=new Map,q=J=>{const se=J.channelClient.getChannel(F).listen(H,X),re=M.add(se);N.set(J,re)},V=J=>{const ee=N.get(J);!ee||(ee.dispose(),N.delete(J))};j.connections.filter(W).forEach(q),c.Event.filter(j.onDidAddConnection,W)(q,void 0,ie),j.onDidRemoveConnection(V,void 0,ie),M.event(Z.fire,Z,ie),ie.add(M)},onLastListenerRemove:()=>{ie.dispose()}});return Z.event}registerChannel(F,W){this.channels.set(F,W),this._connections.forEach(H=>{H.channelServer.registerChannel(F,W)})}dispose(){this.channels.clear(),this._connections.clear(),this._onDidAddConnection.dispose(),this._onDidRemoveConnection.dispose()}}t.IPCServer=O;class A{constructor(F,W,H=null){const X=new l;o(X,W),F.send(X.buffer),this.channelClient=new v(F,H),this.channelServer=new E(F,W,H)}getChannel(F){return this.channelClient.getChannel(F)}registerChannel(F,W){this.channelServer.registerChannel(F,W)}dispose(){this.channelClient.dispose(),this.channelServer.dispose()}}t.IPCClient=A;function G(x){return{call(F,W,H){return x.then(X=>X.call(F,W,H))},listen(F,W){const H=new c.Relay;return x.then(X=>H.input=X.listen(F,W)),H.event}}}t.getDelayedChannel=G;function te(x){let F=!1;return{call(W,H,X){return F?x.call(W,H,X):(0,I.timeout)(0).then(()=>F=!0).then(()=>x.call(W,H,X))},listen(W,H){if(F)return x.listen(W,H);const X=new c.Relay;return(0,I.timeout)(0).then(()=>F=!0).then(()=>X.input=x.listen(W,H)),X.event}}}t.getNextTickChannel=te;class ue{constructor(F){this.fn=F}routeCall(F){return this.route(F)}routeEvent(F){return this.route(F)}async route(F){for(const W of F.connections)if(await Promise.resolve(this.fn(W.ctx)))return Promise.resolve(W);return await c.Event.toPromise(F.onDidAddConnection),await this.route(F)}}t.StaticRouter=ue;var ce;(function(x){function F(j,ie){const Z=j,M=ie&&ie.disableMarshalling,N=new Map;for(const q in Z)H(q)&&N.set(q,c.Event.buffer(Z[q],!0));return new class{listen(q,V,J){const ee=N.get(V);if(ee)return ee;if(X(V)){const se=Z[V];if(typeof se=="function")return se.call(Z,J)}throw new Error(`Event not found: ${V}`)}call(q,V,J){const ee=Z[V];if(typeof ee=="function"){if(!M&&Array.isArray(J))for(let se=0;se<J.length;se++)J[se]=(0,w.revive)(J[se]);return ee.apply(Z,J)}throw new Error(`Method not found: ${V}`)}}}x.fromService=F;function W(j,ie){const Z=ie&&ie.disableMarshalling;return new Proxy({},{get(M,N){if(typeof N=="string")return ie?.properties?.has(N)?ie.properties.get(N):X(N)?function(q){return j.listen(N,q)}:H(N)?j.listen(N):async function(...q){let V;ie&&!(0,f.isUndefinedOrNull)(ie.context)?V=[ie.context,...q]:V=q;const J=await j.call(N,V);return Z?J:(0,w.revive)(J)};throw new Error(`Property not found: ${String(N)}`)}})}x.toService=W;function H(j){return j[0]==="o"&&j[1]==="n"&&C.isUpperAsciiLetter(j.charCodeAt(2))}function X(j){return/^onDynamic/.test(j)&&C.isUpperAsciiLetter(j.charCodeAt(9))}})(ce=t.ProxyChannel||(t.ProxyChannel={}));const ne=[["#2977B1","#FC802D","#34A13A","#D3282F","#9366BA"],["#8B564C","#E177C0","#7F7F7F","#BBBE3D","#2EBECD"]];function B(x){if(Array.isArray(x))return x;if(x&&typeof x=="object"&&typeof x.toString=="function"){let F=x.toString();if(F!=="[object Object]")return F}return x}function K(x){return Array.isArray(x)?x.map(B):B(x)}function _(x,F,W,H,X,j,ie){ie=K(ie);const Z=ne[X],M=Z[H%Z.length];let N=[`%c[${x}]%c[${String(F).padStart(7," ")}]%c[len: ${String(W).padStart(5," ")}]%c${String(H).padStart(5," ")} - ${j}`,"color: darkgreen","color: grey","color: grey",`color: ${M}`];/\($/.test(j)?(N=N.concat(ie),N.push(")")):N.push(ie),console.log.apply(console,N)}t.logWithColors=_;class oe{constructor(F,W){this._outgoingPrefix=F,this._incomingPrefix=W,this._totalIncoming=0,this._totalOutgoing=0}logOutgoing(F,W,H,X,j){this._totalOutgoing+=F,_(this._outgoingPrefix,this._totalOutgoing,F,W,H,X,j)}logIncoming(F,W,H,X,j){this._totalIncoming+=F,_(this._incomingPrefix,this._totalIncoming,F,W,H,X,j)}}t.IPCLogger=oe}),define(Y[65],Q([0,1,3,10,2,11]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStorageDatabase=t.Storage=t.isStorageItemsChangeEvent=t.StorageHint=void 0;var D;(function(C){C[C.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST"})(D=t.StorageHint||(t.StorageHint={}));function T(C){const f=C;return f?.changed instanceof Map||f?.deleted instanceof Set}t.isStorageItemsChangeEvent=T;var c;(function(C){C[C.None=0]="None",C[C.Initialized=1]="Initialized",C[C.Closed=2]="Closed"})(c||(c={}));class m extends b.Disposable{constructor(f,S=Object.create(null)){super();this.database=f,this.options=S,this._onDidChangeStorage=this._register(new I.Emitter),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=c.None,this.cache=new Map,this.flushDelayer=new L.ThrottledDelayer(m.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(f=>this.onDidChangeItemsExternal(f)))}onDidChangeItemsExternal(f){f.changed?.forEach((S,u)=>this.accept(u,S)),f.deleted?.forEach(S=>this.accept(S,void 0))}accept(f,S){if(this.state===c.Closed)return;let u=!1;(0,P.isUndefinedOrNull)(S)?u=this.cache.delete(f):this.cache.get(f)!==S&&(this.cache.set(f,S),u=!0),u&&this._onDidChangeStorage.fire(f)}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===c.None&&(this.state=c.Initialized,this.options.hint!==D.STORAGE_DOES_NOT_EXIST&&(this.cache=await this.database.getItems()))}get(f,S){const u=this.cache.get(f);return(0,P.isUndefinedOrNull)(u)?S:u}getBoolean(f,S){const u=this.get(f);return(0,P.isUndefinedOrNull)(u)?S:u==="true"}getNumber(f,S){const u=this.get(f);return(0,P.isUndefinedOrNull)(u)?S:parseInt(u,10)}async set(f,S){if(this.state===c.Closed)return;if((0,P.isUndefinedOrNull)(S))return this.delete(f);const u=String(S);if(this.cache.get(f)!==u)return this.cache.set(f,u),this.pendingInserts.set(f,u),this.pendingDeletes.delete(f),this._onDidChangeStorage.fire(f),this.flushDelayer.trigger(()=>this.flushPending())}async delete(f){if(!(this.state===c.Closed||!this.cache.delete(f)))return this.pendingDeletes.has(f)||this.pendingDeletes.add(f),this.pendingInserts.delete(f),this._onDidChangeStorage.fire(f),this.flushDelayer.trigger(()=>this.flushPending())}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=c.Closed;try{await this.flushDelayer.trigger(()=>this.flushPending(),0)}catch(f){}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const f={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(f).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async whenFlushed(){if(!!this.hasPending)return new Promise(f=>this.whenFlushedCallbacks.push(f))}dispose(){this.flushDelayer.dispose(),super.dispose()}}t.Storage=m,m.DEFAULT_FLUSH_DELAY=100;class w{constructor(){this.onDidChangeItemsExternal=I.Event.None,this.items=new Map}async getItems(){return this.items}async updateItems(f){f.insert&&f.insert.forEach((S,u)=>this.items.set(u,S)),f.delete&&f.delete.forEach(S=>this.items.delete(S))}async close(){}}t.InMemoryStorageDatabase=w}),define(Y[66],Q([4,5]),function(z,t){return z.create("vs/base/common/date",t)}),define(Y[67],Q([0,1,66]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toLocalISOString=t.fromNow=void 0;const I=60,b=I*60,P=b*24,D=P*7,T=P*30,c=P*365;function m(C,f){typeof C!="number"&&(C=C.getTime());const S=Math.round((new Date().getTime()-C)/1e3);if(S<-30)return(0,L.localize)(0,null,m(new Date().getTime()+S*1e3,!1));if(S<30)return(0,L.localize)(1,null);let u;return S<I?(u=S,f?u===1?(0,L.localize)(2,null,u):(0,L.localize)(3,null,u):u===1?(0,L.localize)(4,null,u):(0,L.localize)(5,null,u)):S<b?(u=Math.floor(S/I),f?u===1?(0,L.localize)(6,null,u):(0,L.localize)(7,null,u):u===1?(0,L.localize)(8,null,u):(0,L.localize)(9,null,u)):S<P?(u=Math.floor(S/b),f?u===1?(0,L.localize)(10,null,u):(0,L.localize)(11,null,u):u===1?(0,L.localize)(12,null,u):(0,L.localize)(13,null,u)):S<D?(u=Math.floor(S/P),f?u===1?(0,L.localize)(14,null,u):(0,L.localize)(15,null,u):u===1?(0,L.localize)(16,null,u):(0,L.localize)(17,null,u)):S<T?(u=Math.floor(S/D),f?u===1?(0,L.localize)(18,null,u):(0,L.localize)(19,null,u):u===1?(0,L.localize)(20,null,u):(0,L.localize)(21,null,u)):S<c?(u=Math.floor(S/T),f?u===1?(0,L.localize)(22,null,u):(0,L.localize)(23,null,u):u===1?(0,L.localize)(24,null,u):(0,L.localize)(25,null,u)):(u=Math.floor(S/c),f?u===1?(0,L.localize)(26,null,u):(0,L.localize)(27,null,u):u===1?(0,L.localize)(28,null,u):(0,L.localize)(29,null,u))}t.fromNow=m;function w(C){return C.getFullYear()+"-"+String(C.getMonth()+1).padStart(2,"0")+"-"+String(C.getDate()).padStart(2,"0")+"T"+String(C.getHours()).padStart(2,"0")+":"+String(C.getMinutes()).padStart(2,"0")+":"+String(C.getSeconds()).padStart(2,"0")+"."+(C.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}t.toLocalISOString=w}),define(Y[68],Q([4,5]),function(z,t){return z.create("vs/base/common/errorMessage",t)}),define(Y[28],Q([0,1,20,11,68]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toErrorMessage=void 0;function P(m,w){return w&&(m.stack||m.stacktrace)?b.localize(0,null,T(m),D(m.stack)||D(m.stacktrace)):T(m)}function D(m){return Array.isArray(m)?m.join(`
`):m}function T(m){return typeof m.code=="string"&&typeof m.errno=="number"&&typeof m.syscall=="string"?b.localize(1,null,m.message):m.message||b.localize(2,null)}function c(m=null,w=!1){if(!m)return b.localize(3,null);if(Array.isArray(m)){const C=L.coalesce(m),f=c(C[0],w);return C.length>1?b.localize(4,null,f,C.length):f}if(I.isString(m))return m;if(m.detail){const C=m.detail;if(C.error)return P(C.error,w);if(C.exception)return P(C.exception,w)}return m.stack?P(m,w):m.message?m.message:b.localize(5,null)}t.toErrorMessage=c}),define(Y[69],Q([4,5]),function(z,t){return z.create("vs/base/node/processes",t)}),define(Y[48],Q([0,1,39,46,6,18,7,12,29,58,11,62,13,69]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.win32=t.createQueuedSender=t.LineProcess=t.AbstractProcess=t.getWindowsShell=t.removeDangerousEnvVariables=t.TerminateResponseCode=t.Source=void 0,Object.defineProperty(t,"Source",{enumerable:!0,get:function(){return m.Source}}),Object.defineProperty(t,"TerminateResponseCode",{enumerable:!0,get:function(){return m.TerminateResponseCode}});function u(e){switch(e){case 0:return 0;case 1:return 2;case 128:return 3;default:return 1}}function d(e,i){if(T.isWindows)try{const r={stdio:["pipe","pipe","ignore"]};i&&(r.cwd=i);const n=L.execFile("taskkill",["/T","/F","/PID",e.pid.toString()],r);return new Promise(o=>{n.once("error",h=>{o({success:!1,error:h})}),n.once("exit",(h,E)=>{o(h===0?{success:!0}:{success:!1,code:h!==null?h:1})})})}catch(r){return Promise.resolve({success:!1,error:r,code:r.status?u(r.status):1})}else if(T.isLinux||T.isMacintosh)try{const r=b.FileAccess.asFileUri("vs/base/node/terminateProcess.sh",z).fsPath;return new Promise(n=>{L.execFile(r,[e.pid.toString()],{encoding:"utf8",shell:!0},(o,h,E)=>{n(o?{success:!1,error:o}:{success:!0})})})}catch(r){return Promise.resolve({success:!1,error:r})}else e.kill("SIGKILL");return Promise.resolve({success:!0})}function p(e){!e||(delete e.DEBUG,T.isMacintosh&&delete e.DYLD_LIBRARY_PATH,T.isLinux&&delete e.LD_PRELOAD)}t.removeDangerousEnvVariables=p;function g(e=c.env){return e.comspec||"cmd.exe"}t.getWindowsShell=g;class y{constructor(i,r,n,o){if(r!==void 0&&n!==void 0&&o!==void 0)this.cmd=i,this.args=r,this.shell=n,this.options=o;else{const h=i;this.cmd=h.command,this.shell=h.isShellCommand,this.args=h.args.slice(0),this.options=h.options||{}}if(this.childProcess=null,this.childProcessPromise=null,this.terminateRequested=!1,this.options.env){const h=Object.create(null);Object.keys(c.env).forEach(E=>{h[E]=c.env[E]}),Object.keys(this.options.env).forEach(E=>{h[E]=this.options.env[E]}),this.options.env=h}}getSanitizedCommand(){let i=this.cmd.toLowerCase();const r=i.lastIndexOf(D.sep);return r!==-1&&(i=i.substring(r+1)),y.WellKnowCommands[i]?i:"other"}start(i){return T.isWindows&&(this.options&&this.options.cwd&&I.isUNC(this.options.cwd)||!this.options&&I.isUNC(c.cwd()))?Promise.reject(new Error(S.localize(0,null))):this.useExec().then(r=>{let n,o;const h=new Promise((E,R)=>{n=E,o=R});if(r){let E=this.cmd;this.args&&(E=E+" "+this.args.join(" ")),this.childProcess=L.exec(E,this.options,(R,v,O)=>{this.childProcess=null;const A=R;A&&A.killed?o({killed:this.terminateRequested,stdout:v.toString(),stderr:O.toString()}):this.handleExec(n,i,R,v,O)})}else{let E=null;const R=v=>{this.childProcess=null,this.childProcessPromise=null,this.handleClose(v,n,i,o);const O={terminated:this.terminateRequested};w.isNumber(v)&&(O.cmdCode=v),n(O)};if(this.shell&&T.isWindows){const v=P.deepClone(this.options);v.windowsVerbatimArguments=!0,v.detached=!1;let O=!1,A=!1;const G=[];let te=this.ensureQuotes(this.cmd);G.push(te.value),O=te.quoted,this.args&&this.args.forEach(ce=>{te=this.ensureQuotes(ce),G.push(te.value),A=A&&te.quoted});const ue=["/s","/c"];O?A?ue.push('"'+G.join(" ")+'"'):G.length>1?ue.push('"'+G[0]+'" '+G.slice(1).join(" ")):ue.push('"'+G[0]+'"'):ue.push(G.join(" ")),E=L.spawn(g(),ue,v)}else this.cmd&&(E=L.spawn(this.cmd,this.args,this.options));E&&(this.childProcess=E,this.childProcessPromise=Promise.resolve(E),this.pidResolve&&(this.pidResolve(w.isNumber(E.pid)?E.pid:-1),this.pidResolve=void 0),E.on("error",v=>{this.childProcess=null,o({terminated:this.terminateRequested,error:v})}),E.pid&&(this.childProcess.on("close",R),this.handleSpawn(E,n,i,o,!0)))}return h})}handleClose(i,r,n,o){}ensureQuotes(i){return y.regexp.test(i)?{value:'"'+i+'"',quoted:!0}:{value:i,quoted:i.length>0&&i[0]==='"'&&i[i.length-1]==='"'}}get pid(){return this.childProcessPromise?this.childProcessPromise.then(i=>i.pid,i=>-1):new Promise(i=>{this.pidResolve=i})}terminate(){return this.childProcessPromise?this.childProcessPromise.then(i=>(this.terminateRequested=!0,d(i,this.options.cwd).then(r=>(r.success&&(this.childProcess=null),r))),i=>({success:!0})):Promise.resolve({success:!0})}useExec(){return new Promise(i=>{if(!this.shell||!T.isWindows)return i(!1);const r=L.spawn(g(),["/s","/c"]);r.on("error",n=>i(!0)),r.on("exit",n=>i(!1))})}}t.AbstractProcess=y,y.WellKnowCommands={ant:!0,cmake:!0,eslint:!0,gradle:!0,grunt:!0,gulp:!0,jake:!0,jenkins:!0,jshint:!0,make:!0,maven:!0,msbuild:!0,msc:!0,nmake:!0,npm:!0,rake:!0,tsc:!0,xbuild:!0},y.regexp=/^[^"].* .*[^"]/;class l extends y{constructor(i,r,n,o){super(i,r,n,o);this.stdoutLineDecoder=null,this.stderrLineDecoder=null}handleExec(i,r,n,o,h){[o,h].forEach((E,R)=>{const v=new C.LineDecoder;v.write(E).forEach(G=>{r({line:G,source:R===0?0:1})});const A=v.end();A&&r({line:A,source:R===0?0:1})}),i({terminated:this.terminateRequested,error:n})}handleSpawn(i,r,n,o,h){const E=new C.LineDecoder,R=new C.LineDecoder;i.stdout.on("data",v=>{E.write(v).forEach(A=>n({line:A,source:0}))}),i.stderr.on("data",v=>{R.write(v).forEach(A=>n({line:A,source:1}))}),this.stdoutLineDecoder=E,this.stderrLineDecoder=R}handleClose(i,r,n,o){const h=this.stdoutLineDecoder?this.stdoutLineDecoder.end():null;h&&n({line:h,source:0});const E=this.stderrLineDecoder?this.stderrLineDecoder.end():null;E&&n({line:E,source:1})}}t.LineProcess=l;function s(e){let i=[],r=!1;const n=function(o){if(r){i.push(o);return}(!e.send(o,E=>{if(E&&console.error(E),r=!1,i.length>0){const R=i.slice(0);i=[],R.forEach(v=>n(v))}})||T.isWindows)&&(r=!0)};return{send:n}}t.createQueuedSender=s;var a;(function(e){async function i(r,n,o){if(D.isAbsolute(r))return r;if(n===void 0&&(n=c.cwd()),D.dirname(r)!=="."||(o===void 0&&w.isString(c.env.PATH)&&(o=c.env.PATH.split(D.delimiter)),o===void 0||o.length===0))return D.join(n,r);async function E(R){if(await f.Promises.exists(R)){let v;try{v=await f.Promises.stat(R)}catch(O){O.message.startsWith("EACCES")&&(v=await f.Promises.lstat(R))}return v?!v.isDirectory():!1}return!1}for(let R of o){let v;if(D.isAbsolute(R)?v=D.join(R,r):v=D.join(n,R,r),await E(v))return v;let O=v+".com";if(await E(O)||(O=v+".exe",await E(O)))return O}return D.join(n,r)}e.findExecutable=i})(a=t.win32||(t.win32={}))}),define(Y[70],Q([0,1,35,12,64,48]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSystemShellSync=t.getSystemShell=void 0;async function D(S,u){return S===1?I.isWindows?C():P.getWindowsShell(u):m(S,u)}t.getSystemShell=D;function T(S,u){return S===1?I.isWindows?f(u):P.getWindowsShell(u):m(S,u)}t.getSystemShellSync=T;let c=null;function m(S,u){if(I.isLinux&&S===2||I.isMacintosh&&S===3)return"/bin/bash";if(!c){let d;if(I.isWindows)d="/bin/bash";else{if(d=u.SHELL,!d)try{d=(0,L.userInfo)().shell}catch(p){}d||(d="sh"),d==="/bin/false"&&(d="/bin/bash")}c=d}return c}let w=null;async function C(){return w||(w=(await(0,b.getFirstAvailablePowerShellInstallation)()).exePath),w}function f(S){if(w)return w;const u=I.isWindows&&parseFloat((0,L.release)())>=10,d=S.hasOwnProperty("PROCESSOR_ARCHITEW6432"),p=`${S.windir}\\${d?"Sysnative":"System32"}\\WindowsPowerShell\\v1.0\\powershell.exe`;return u?p:P.getWindowsShell(S)}}),define(Y[40],Q([0,1,39,3,17,24,59,8,10,2,18,48,36]),function(z,t,L,I,b,P,D,T,c,m,w,C,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=t.Server=void 0;class S extends f.ChannelServer{constructor(p){super({send:g=>{try{process.send&&process.send(g.buffer.toString("base64"))}catch(y){}},onMessage:c.Event.fromNodeEventEmitter(process,"message",g=>b.VSBuffer.wrap(Buffer.from(g,"base64")))},p);process.once("disconnect",()=>this.dispose())}}t.Server=S;class u{constructor(p,g){this.modulePath=p,this.options=g,this.activeRequests=new Set,this.channels=new Map,this._onDidProcessExit=new c.Emitter,this.onDidProcessExit=this._onDidProcessExit.event;const y=g&&g.timeout?g.timeout:6e4;this.disposeDelayer=new I.Delayer(y),this.child=null,this._client=null}getChannel(p){const g=this;return{call(y,l,s){return g.requestPromise(p,y,l,s)},listen(y,l){return g.requestEvent(p,y,l)}}}requestPromise(p,g,y,l=P.CancellationToken.None){if(!this.disposeDelayer)return Promise.reject(new Error("disposed"));if(l.isCancellationRequested)return Promise.reject(T.canceled());this.disposeDelayer.cancel();const s=this.getCachedChannel(p),a=(0,I.createCancelablePromise)(r=>s.call(g,y,r)),e=l.onCancellationRequested(()=>a.cancel()),i=(0,m.toDisposable)(()=>a.cancel());return this.activeRequests.add(i),a.finally(()=>{e.dispose(),this.activeRequests.delete(i),this.activeRequests.size===0&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}),a}requestEvent(p,g,y){if(!this.disposeDelayer)return c.Event.None;this.disposeDelayer.cancel();let l;const s=new c.Emitter({onFirstListenerAdd:()=>{l=this.getCachedChannel(p).listen(g,y)(s.fire,s),this.activeRequests.add(l)},onLastListenerRemove:()=>{this.activeRequests.delete(l),l.dispose(),this.activeRequests.size===0&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}});return s.event}get client(){if(!this._client){const p=this.options&&this.options.args?this.options.args:[],g=Object.create(null);g.env={...(0,w.deepClone)(process.env),VSCODE_PARENT_PID:String(process.pid)},this.options&&this.options.env&&(g.env={...g.env,...this.options.env}),this.options&&this.options.freshExecArgv&&(g.execArgv=[]),this.options&&typeof this.options.debug=="number"&&(g.execArgv=["--nolazy","--inspect="+this.options.debug]),this.options&&typeof this.options.debugBrk=="number"&&(g.execArgv=["--nolazy","--inspect-brk="+this.options.debugBrk]),g.execArgv===void 0&&(g.execArgv=process.execArgv.filter(n=>!/^--inspect(-brk)?=/.test(n))),(0,C.removeDangerousEnvVariables)(g.env),this.child=(0,L.fork)(this.modulePath,p,g);const y=new c.Emitter;c.Event.fromNodeEventEmitter(this.child,"message",n=>n)(n=>{if((0,D.isRemoteConsoleLog)(n)){(0,D.log)(n,`IPC Library: ${this.options.serverName}`);return}y.fire(b.VSBuffer.wrap(Buffer.from(n,"base64")))});const s=this.options.useQueue?(0,C.createQueuedSender)(this.child):this.child,a=n=>this.child&&this.child.connected&&s.send(n.buffer.toString("base64")),e=y.event,i={send:a,onMessage:e};this._client=new f.ChannelClient(i);const r=()=>this.disposeClient();process.once("exit",r),this.child.on("error",n=>console.warn('IPC "'+this.options.serverName+'" errored with '+n)),this.child.on("exit",(n,o)=>{process.removeListener("exit",r),this.activeRequests.forEach(h=>(0,m.dispose)(h)),this.activeRequests.clear(),n!==0&&o!=="SIGTERM"&&console.warn('IPC "'+this.options.serverName+'" crashed with exit code '+n+" and signal "+o),this.disposeDelayer&&this.disposeDelayer.cancel(),this.disposeClient(),this._onDidProcessExit.fire({code:n,signal:o})})}return this._client}getCachedChannel(p){let g=this.channels.get(p);return g||(g=this.client.getChannel(p),this.channels.set(p,g)),g}disposeClient(){this._client&&(this.child&&(this.child.kill(),this.child=null),this._client=null,this.channels.clear())}dispose(){this._onDidProcessExit.dispose(),this.disposeDelayer&&(this.disposeDelayer.cancel(),this.disposeDelayer=void 0),this.disposeClient(),this.activeRequests.clear()}}t.Client=u}),define(Y[71],Q([4,5]),function(z,t){return z.create("vs/base/node/zip",t)}),define(Y[72],Q([4,5]),function(z,t){return z.create("vs/platform/configuration/common/configurationRegistry",t)}),define(Y[73],Q([4,5]),function(z,t){return z.create("vs/platform/environment/node/shellEnv",t)}),define(Y[74],Q([4,5]),function(z,t){return z.create("vs/platform/extensionManagement/common/abstractExtensionManagementService",t)}),define(Y[75],Q([4,5]),function(z,t){return z.create("vs/platform/extensionManagement/common/extensionManagement",t)}),define(Y[76],Q([4,5]),function(z,t){return z.create("vs/platform/extensionManagement/common/extensionManagementCLIService",t)}),define(Y[77],Q([4,5]),function(z,t){return z.create("vs/platform/extensionManagement/node/extensionManagementService",t)}),define(Y[78],Q([4,5]),function(z,t){return z.create("vs/platform/extensionManagement/node/extensionManagementUtil",t)}),define(Y[79],Q([4,5]),function(z,t){return z.create("vs/platform/extensionManagement/node/extensionsScanner",t)}),define(Y[80],Q([4,5]),function(z,t){return z.create("vs/platform/extensions/common/extensionValidator",t)}),define(Y[81],Q([4,5]),function(z,t){return z.create("vs/platform/files/common/fileService",t)}),define(Y[82],Q([4,5]),function(z,t){return z.create("vs/platform/files/common/io",t)}),define(Y[83],Q([4,5]),function(z,t){return z.create("vs/platform/files/node/diskFileSystemProvider",t)}),define(Y[84],Q([4,5]),function(z,t){return z.create("vs/platform/request/common/request",t)}),define(Y[85],Q([4,5]),function(z,t){return z.create("vs/platform/telemetry/common/telemetryService",t)}),define(Y[86],Q([0,1,67,45,6,7,29,19,9]),function(z,t,L,I,b,P,D,T,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePtyHostPort=t.parseSearchPort=t.parseExtensionHostPort=t.AbstractNativeEnvironmentService=void 0;class m{constructor(d,p,g){this._args=d,this.paths=p,this.productService=g}get appRoot(){return(0,P.dirname)(b.FileAccess.asFileUri("",z).fsPath)}get userHome(){return c.URI.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return c.URI.file((0,P.join)(this.userDataPath,"User"))}get tmpDir(){return c.URI.file(this.paths.tmpDir)}get userRoamingDataHome(){return this.appSettingsHome}get settingsResource(){return(0,T.joinPath)(this.userRoamingDataHome,"settings.json")}get userDataSyncHome(){return(0,T.joinPath)(this.userRoamingDataHome,"sync")}get logsPath(){if(!this.args.logsPath){const d=(0,L.toLocalISOString)(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=(0,P.join)(this.userDataPath,"logs",d)}return this.args.logsPath}get userDataSyncLogResource(){return c.URI.file((0,P.join)(this.logsPath,"userDataSync.log"))}get sync(){return this.args.sync}get machineSettingsResource(){return(0,T.joinPath)(c.URI.file((0,P.join)(this.userDataPath,"Machine")),"settings.json")}get globalStorageHome(){return c.URI.joinPath(this.appSettingsHome,"globalStorage")}get workspaceStorageHome(){return c.URI.joinPath(this.appSettingsHome,"workspaceStorage")}get keybindingsResource(){return(0,T.joinPath)(this.userRoamingDataHome,"keybindings.json")}get keyboardLayoutResource(){return(0,T.joinPath)(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){const d=D.env.VSCODE_PORTABLE;return d?c.URI.file((0,P.join)(d,"argv.json")):(0,T.joinPath)(this.userHome,this.productService.dataFolderName,"argv.json")}get snippetsHome(){return(0,T.joinPath)(this.userRoamingDataHome,"snippets")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return c.URI.file((0,P.join)(this.userDataPath,"Workspaces"))}get installSourcePath(){return(0,P.join)(this.userDataPath,"installSource")}get builtinExtensionsPath(){const d=this.args["builtin-extensions-dir"];return d?(0,P.resolve)(d):(0,P.normalize)((0,P.join)(b.FileAccess.asFileUri("",z).fsPath,"..","extensions"))}get extensionsDownloadPath(){const d=this.args["extensions-download-dir"];return d?(0,P.resolve)(d):(0,P.join)(this.userDataPath,"CachedExtensionVSIXs")}get extensionsPath(){const d=this.args["extensions-dir"];if(d)return(0,P.resolve)(d);const p=D.env.VSCODE_EXTENSIONS;if(p)return p;const g=D.env.VSCODE_PORTABLE;return g?(0,P.join)(g,"extensions"):(0,T.joinPath)(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){const d=this.args.extensionDevelopmentPath;if(Array.isArray(d))return d.map(p=>/^[^:/?#]+?:\/\//.test(p)?c.URI.parse(p):c.URI.file((0,P.normalize)(p)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(d=>d==="ui"||d==="workspace"||d==="web"?d:"workspace")}get extensionTestsLocationURI(){const d=this.args.extensionTestsPath;if(d)return/^[^:/?#]+?:\/\//.test(d)?c.URI.parse(d):c.URI.file((0,P.normalize)(d))}get disableExtensions(){if(this.args["disable-extensions"])return!0;const d=this.args["disable-extension"];if(d){if(typeof d=="string")return[d];if(Array.isArray(d)&&d.length>0)return d}return!1}get debugExtensionHost(){return w(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!D.env.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log}get serviceMachineIdResource(){return(0,T.joinPath)(c.URI.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get driverHandle(){return this.args.driver}get telemetryLogResource(){return c.URI.file((0,P.join)(this.logsPath,"telemetry.log"))}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get args(){return this._args}}de([I.memoize],m.prototype,"appRoot",null),de([I.memoize],m.prototype,"userHome",null),de([I.memoize],m.prototype,"userDataPath",null),de([I.memoize],m.prototype,"appSettingsHome",null),de([I.memoize],m.prototype,"tmpDir",null),de([I.memoize],m.prototype,"userRoamingDataHome",null),de([I.memoize],m.prototype,"settingsResource",null),de([I.memoize],m.prototype,"userDataSyncHome",null),de([I.memoize],m.prototype,"userDataSyncLogResource",null),de([I.memoize],m.prototype,"sync",null),de([I.memoize],m.prototype,"machineSettingsResource",null),de([I.memoize],m.prototype,"globalStorageHome",null),de([I.memoize],m.prototype,"workspaceStorageHome",null),de([I.memoize],m.prototype,"keybindingsResource",null),de([I.memoize],m.prototype,"keyboardLayoutResource",null),de([I.memoize],m.prototype,"argvResource",null),de([I.memoize],m.prototype,"snippetsHome",null),de([I.memoize],m.prototype,"isExtensionDevelopment",null),de([I.memoize],m.prototype,"untitledWorkspacesHome",null),de([I.memoize],m.prototype,"installSourcePath",null),de([I.memoize],m.prototype,"builtinExtensionsPath",null),de([I.memoize],m.prototype,"extensionsPath",null),de([I.memoize],m.prototype,"extensionDevelopmentLocationURI",null),de([I.memoize],m.prototype,"extensionDevelopmentKind",null),de([I.memoize],m.prototype,"extensionTestsLocationURI",null),de([I.memoize],m.prototype,"debugExtensionHost",null),de([I.memoize],m.prototype,"serviceMachineIdResource",null),de([I.memoize],m.prototype,"telemetryLogResource",null),de([I.memoize],m.prototype,"disableWorkspaceTrust",null),t.AbstractNativeEnvironmentService=m;function w(u,d){return S(u["inspect-extensions"],u["inspect-brk-extensions"],5870,d,u.debugId,u.extensionEnvironment)}t.parseExtensionHostPort=w;function C(u,d){return S(u["inspect-search"],u["inspect-brk-search"],5876,d,u.extensionEnvironment)}t.parseSearchPort=C;function f(u,d){return S(u["inspect-ptyhost"],u["inspect-brk-ptyhost"],5877,d,u.extensionEnvironment)}t.parsePtyHostPort=f;function S(u,d,p,g,y,l){const a=Number(d||u)||(g?null:p),e=a?Boolean(!!d):!1;let i;if(l)try{i=JSON.parse(l)}catch{}return{port:a,break:e,debugId:y,env:i}}}),function(){"use strict";function z(t,L,I,b){function P(T){const c=D(T),m=[c];return t.isAbsolute(c)||m.unshift(b),t.resolve(...m)}function D(T){const c=process.env.VSCODE_PORTABLE;if(c)return t.join(c,"user-data");let m=process.env.VSCODE_APPDATA;if(m)return t.join(m,I);const w=T["user-data-dir"];if(w)return w;switch(process.platform){case"win32":if(m=process.env.APPDATA,!m){const C=process.env.USERPROFILE;if(typeof C!="string")throw new Error("Windows: Unexpected undefined %USERPROFILE% environment variable");m=t.join(C,"AppData","Roaming")}break;case"darwin":m=t.join(L.homedir(),"Library","Application Support");break;case"linux":m=process.env.XDG_CONFIG_HOME||t.join(L.homedir(),".config");break;default:throw new Error("Platform not supported")}return t.join(m,I)}return{getUserDataPath:P}}if(typeof define=="function")define(Y[87],Q([0,129,35,6,19,29]),function(t,L,I,b,P,D){const T=P.dirname(b.FileAccess.asFileUri("",t)),c=t.__$__nodeRequire(P.joinPath(T,"package.json").fsPath);return z(L,I,c.name,D.cwd())});else if(typeof module=="object"&&typeof module.exports=="object"){const t=require("../../../../../package.json"),L=require("path"),I=require("os");module.exports=z(L,I,t.name,process.env.VSCODE_CWD||process.cwd())}else throw new Error("Unknown context")}(),define(Y[88],Q([0,1,35,86,87]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NativeEnvironmentService=void 0;class P extends I.AbstractNativeEnvironmentService{constructor(T,c){super(T,{homeDir:(0,L.homedir)(),tmpDir:(0,L.tmpdir)(),userDataDir:(0,b.getUserDataPath)(T)},c)}}t.NativeEnvironmentService=P}),define(Y[89],Q([0,1,18]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localizeManifest=void 0;const I=/^%([\w\d.-]+)%$/i;function b(P,D){const T=c=>{if(typeof c!="string")return;const m=I.exec(c);if(!m)return;const w=D[m[1]]??c;return typeof w=="string"?w:typeof w.message=="string"?w.message:c};return(0,L.cloneAndChange)(P,T)}t.localizeManifest=b}),define(Y[49],Q([0,1,80]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEngineValid=t.isValidExtensionVersion=t.isValidVersion=t.normalizeVersion=t.parseVersion=t.isValidVersionStr=void 0;const I=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,b=/^-(\d{4})(\d{2})(\d{2})$/;function P(f){return f=f.trim(),f==="*"||I.test(f)}t.isValidVersionStr=P;function D(f){if(!P(f))return null;if(f=f.trim(),f==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};let S=f.match(I);return S?{hasCaret:S[1]==="^",hasGreaterEquals:S[1]===">=",majorBase:S[2]==="x"?0:parseInt(S[2],10),majorMustEqual:S[2]!=="x",minorBase:S[4]==="x"?0:parseInt(S[4],10),minorMustEqual:S[4]!=="x",patchBase:S[6]==="x"?0:parseInt(S[6],10),patchMustEqual:S[6]!=="x",preRelease:S[8]||null}:null}t.parseVersion=D;function T(f){if(!f)return null;let S=f.majorBase,u=f.majorMustEqual,d=f.minorBase,p=f.minorMustEqual,g=f.patchBase,y=f.patchMustEqual;f.hasCaret&&(S===0||(p=!1),y=!1);let l=0;if(f.preRelease){const s=b.exec(f.preRelease);if(s){const[,a,e,i]=s;l=Date.UTC(Number(a),Number(e)-1,Number(i))}}return{majorBase:S,majorMustEqual:u,minorBase:d,minorMustEqual:p,patchBase:g,patchMustEqual:y,isMinimum:f.hasGreaterEquals,notBefore:l}}t.normalizeVersion=T;function c(f,S,u){let d;typeof f=="string"?d=T(D(f)):d=f;let p;S instanceof Date?p=S.getTime():typeof S=="string"&&(p=new Date(S).getTime());let g;if(typeof u=="string"?g=T(D(u)):g=u,!d||!g)return!1;let y=d.majorBase,l=d.minorBase,s=d.patchBase,a=g.majorBase,e=g.minorBase,i=g.patchBase,r=g.notBefore,n=g.majorMustEqual,o=g.minorMustEqual,h=g.patchMustEqual;return g.isMinimum?y>a?!0:y<a?!1:l>e?!0:l<e||p&&p<r?!1:s>=i:(y===1&&a===0&&(!n||!o||!h)&&(a=1,e=0,i=0,n=!0,o=!1,h=!1),y<a?!1:y>a?!n:l<e?!1:l>e?!o:s<i?!1:s>i?!h:!(p&&p<r))}t.isValidVersion=c;function m(f,S,u,d){return u.isBuiltin||typeof u.main=="undefined"?!0:C(f,S,u.engines.vscode,d)}t.isValidExtensionVersion=m;function w(f,S,u){return f==="*"||C(S,u,f)}t.isEngineValid=w;function C(f,S,u,d=[]){let p=T(D(u));if(!p)return d.push(L.localize(0,null,u)),!1;if(p.majorBase===0){if(!p.majorMustEqual||!p.minorMustEqual)return d.push(L.localize(1,null,u)),!1}else if(!p.majorMustEqual)return d.push(L.localize(2,null,u)),!1;return c(f,S,p)?!0:(d.push(L.localize(3,null,f,u)),!1)}}),define(Y[50],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDescriptor=void 0;class L{constructor(b,P=[],D=!1){this.ctor=b,this.staticArguments=P,this.supportsDelayedInstantiation=D}}t.SyncDescriptor=L}),define(Y[90],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=t.Node=void 0;class L{constructor(P){this.incoming=new Map,this.outgoing=new Map,this.data=P}}t.Node=L;class I{constructor(P){this._hashFn=P,this._nodes=new Map}roots(){const P=[];for(let D of this._nodes.values())D.outgoing.size===0&&P.push(D);return P}insertEdge(P,D){const T=this.lookupOrInsertNode(P),c=this.lookupOrInsertNode(D);T.outgoing.set(this._hashFn(D),c),c.incoming.set(this._hashFn(P),T)}removeNode(P){const D=this._hashFn(P);this._nodes.delete(D);for(let T of this._nodes.values())T.outgoing.delete(D),T.incoming.delete(D)}lookupOrInsertNode(P){const D=this._hashFn(P);let T=this._nodes.get(D);return T||(T=new L(P),this._nodes.set(D,T)),T}lookup(P){return this._nodes.get(this._hashFn(P))}isEmpty(){return this._nodes.size===0}toString(){let P=[];for(let[D,T]of this._nodes)P.push(`${D}, (incoming)[${[...T.incoming.keys()].join(", ")}], (outgoing)[${[...T.outgoing.keys()].join(",")}]`);return P.join(`
`)}findCycleSlow(){for(let[P,D]of this._nodes){const T=new Set([P]),c=this._findCycle(D,T);if(c)return c}}_findCycle(P,D){for(let[T,c]of P.outgoing){if(D.has(T))return[...D,T].join(" -> ");D.add(T);const m=this._findCycle(c,D);if(m)return m;D.delete(T)}}}t.Graph=I}),define(Y[51],Q([0,1,15]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDownloadService=void 0,t.IDownloadService=(0,L.createDecorator)("downloadService")}),define(Y[21],Q([0,1,15]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INativeEnvironmentService=t.IEnvironmentService=void 0,t.IEnvironmentService=(0,L.createDecorator)("environmentService"),t.INativeEnvironmentService=(0,L.refineServiceDecorator)(t.IEnvironmentService)}),define(Y[22],Q([0,1,6,75,15]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IExtensionManagementCLIService=t.PreferencesLocalizedLabel=t.PreferencesLabel=t.ExtensionsChannelId=t.ExtensionsLocalizedLabel=t.ExtensionsLabel=t.DefaultIconPath=t.IExtensionTipsService=t.IGlobalExtensionEnablementService=t.ENABLED_EXTENSIONS_STORAGE_PATH=t.DISABLED_EXTENSIONS_STORAGE_PATH=t.IExtensionManagementService=t.ExtensionManagementError=t.ExtensionManagementErrorCode=t.IExtensionGalleryService=t.InstallOperation=t.StatisticType=t.SortOrder=t.SortBy=t.isIExtensionIdentifier=t.getFallbackTargetPlarforms=t.isTargetPlatformCompatible=t.isNotWebExtensionInWebTargetPlatform=t.getTargetPlatform=t.toTargetPlatform=t.TargetPlatformToString=t.TargetPlatform=t.WEB_EXTENSION_TAG=t.EXTENSION_IDENTIFIER_REGEX=t.EXTENSION_IDENTIFIER_PATTERN=void 0,t.EXTENSION_IDENTIFIER_PATTERN="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",t.EXTENSION_IDENTIFIER_REGEX=new RegExp(t.EXTENSION_IDENTIFIER_PATTERN),t.WEB_EXTENSION_TAG="__web_extension";var P;(function(l){l.WIN32_X64="win32-x64",l.WIN32_IA32="win32-ia32",l.WIN32_ARM64="win32-arm64",l.LINUX_X64="linux-x64",l.LINUX_ARM64="linux-arm64",l.LINUX_ARMHF="linux-armhf",l.ALPINE_X64="alpine-x64",l.ALPINE_ARM64="alpine-arm64",l.DARWIN_X64="darwin-x64",l.DARWIN_ARM64="darwin-arm64",l.WEB="web",l.UNIVERSAL="universal",l.UNKNOWN="unknown",l.UNDEFINED="undefined"})(P=t.TargetPlatform||(t.TargetPlatform={}));function D(l){switch(l){case"win32-x64":return"Windows 64 bit";case"win32-ia32":return"Windows 32 bit";case"win32-arm64":return"Windows ARM";case"linux-x64":return"Linux 64 bit";case"linux-arm64":return"Linux ARM 64";case"linux-armhf":return"Linux ARM";case"alpine-x64":return"Alpine Linux 64 bit";case"alpine-arm64":return"Alpine ARM 64";case"darwin-x64":return"Mac";case"darwin-arm64":return"Mac Silicon";case"web":return"Web";case"universal":return"universal";case"unknown":return"unknown";case"undefined":return"undefined"}}t.TargetPlatformToString=D;function T(l){switch(l){case"win32-x64":return"win32-x64";case"win32-ia32":return"win32-ia32";case"win32-arm64":return"win32-arm64";case"linux-x64":return"linux-x64";case"linux-arm64":return"linux-arm64";case"linux-armhf":return"linux-armhf";case"alpine-x64":return"alpine-x64";case"alpine-arm64":return"alpine-arm64";case"darwin-x64":return"darwin-x64";case"darwin-arm64":return"darwin-arm64";case"web":return"web";case"universal":return"universal";default:return"unknown"}}t.toTargetPlatform=T;function c(l,s){switch(l){case 3:return s==="x64"?"win32-x64":s==="ia32"?"win32-ia32":s==="arm64"?"win32-arm64":"unknown";case 2:return s==="x64"?"linux-x64":s==="arm64"?"linux-arm64":s==="arm"?"linux-armhf":"unknown";case"alpine":return s==="x64"?"alpine-x64":s==="arm64"?"alpine-arm64":"unknown";case 1:return s==="x64"?"darwin-x64":s==="arm64"?"darwin-arm64":"unknown";case 0:return"web"}}t.getTargetPlatform=c;function m(l,s){return s==="web"&&!l.includes("web")}t.isNotWebExtensionInWebTargetPlatform=m;function w(l,s,a){return m(s,a)?!1:l==="undefined"||l==="universal"?!0:l==="unknown"?!1:l===a?!0:C(a).includes(l)}t.isTargetPlatformCompatible=w;function C(l){switch(l){case"win32-x64":return["win32-ia32"];case"win32-arm64":return["win32-ia32"]}return[]}t.getFallbackTargetPlarforms=C;function f(l){return l&&typeof l=="object"&&typeof l.id=="string"&&(!l.uuid||typeof l.uuid=="string")}t.isIExtensionIdentifier=f;var S;(function(l){l[l.NoneOrRelevance=0]="NoneOrRelevance",l[l.LastUpdatedDate=1]="LastUpdatedDate",l[l.Title=2]="Title",l[l.PublisherName=3]="PublisherName",l[l.InstallCount=4]="InstallCount",l[l.PublishedDate=10]="PublishedDate",l[l.AverageRating=6]="AverageRating",l[l.WeightedRating=12]="WeightedRating"})(S=t.SortBy||(t.SortBy={}));var u;(function(l){l[l.Default=0]="Default",l[l.Ascending=1]="Ascending",l[l.Descending=2]="Descending"})(u=t.SortOrder||(t.SortOrder={}));var d;(function(l){l.Install="install",l.Uninstall="uninstall"})(d=t.StatisticType||(t.StatisticType={}));var p;(function(l){l[l.None=0]="None",l[l.Install=1]="Install",l[l.Update=2]="Update"})(p=t.InstallOperation||(t.InstallOperation={})),t.IExtensionGalleryService=(0,b.createDecorator)("extensionGalleryService");var g;(function(l){l.Unsupported="Unsupported",l.Malicious="Malicious",l.Incompatible="Incompatible",l.Invalid="Invalid",l.Download="Download",l.Extract="Extract",l.Delete="Delete",l.Rename="Rename",l.CorruptZip="CorruptZip",l.IncompleteZip="IncompleteZip",l.Internal="Internal"})(g=t.ExtensionManagementErrorCode||(t.ExtensionManagementErrorCode={}));class y extends Error{constructor(s,a){super(s);this.code=a,this.name=a}}t.ExtensionManagementError=y,t.IExtensionManagementService=(0,b.createDecorator)("extensionManagementService"),t.DISABLED_EXTENSIONS_STORAGE_PATH="extensionsIdentifiers/disabled",t.ENABLED_EXTENSIONS_STORAGE_PATH="extensionsIdentifiers/enabled",t.IGlobalExtensionEnablementService=(0,b.createDecorator)("IGlobalExtensionEnablementService"),t.IExtensionTipsService=(0,b.createDecorator)("IExtensionTipsService"),t.DefaultIconPath=L.FileAccess.asBrowserUri("./media/defaultIcon.png",z).toString(!0),t.ExtensionsLabel=(0,I.localize)(0,null),t.ExtensionsLocalizedLabel={value:t.ExtensionsLabel,original:"Extensions"},t.ExtensionsChannelId="extensions",t.PreferencesLabel=(0,I.localize)(1,null),t.PreferencesLocalizedLabel={value:t.PreferencesLabel,original:"Preferences"},t.IExtensionManagementCLIService=(0,b.createDecorator)("IExtensionManagementCLIService")}),define(Y[91],Q([0,1,39,7,73,24,28,8,12,31,70,130,3]),function(z,t,L,I,b,P,D,T,c,m,w,C,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveShellEnv=void 0;const S=1e4;let u;async function d(g,y,l){return y["force-disable-user-env"]?(g.trace("resolveShellEnv(): skipped (--force-disable-user-env)"),{}):c.isWindows?(g.trace("resolveShellEnv(): skipped (Windows)"),{}):(0,C.isLaunchedFromCli)(l)&&!y["force-user-env"]?(g.trace("resolveShellEnv(): skipped (VSCODE_CLI is set)"),{}):((0,C.isLaunchedFromCli)(l)?g.trace("resolveShellEnv(): running (--force-user-env)"):g.trace("resolveShellEnv(): running (macOS/Linux)"),u||(u=f.Promises.withAsyncBody(async(s,a)=>{const e=new P.CancellationTokenSource,i=setTimeout(()=>{e.dispose(!0),a(new Error((0,b.localize)(0,null)))},S);try{s(await p(g,e.token))}catch(r){!(0,T.isPromiseCanceledError)(r)&&!e.token.isCancellationRequested?a(new Error((0,b.localize)(1,null,(0,D.toErrorMessage)(r)))):s({})}finally{clearTimeout(i),e.dispose()}})),u)}t.resolveShellEnv=d;async function p(g,y){const l=process.env.ELECTRON_RUN_AS_NODE;g.trace("getUnixShellEnvironment#runAsNode",l);const s=process.env.ELECTRON_NO_ATTACH_CONSOLE;g.trace("getUnixShellEnvironment#noAttach",s);const a=(0,m.generateUuid)().replace(/-/g,"").substr(0,12),e=new RegExp(a+"(.*)"+a),i={...process.env,ELECTRON_RUN_AS_NODE:"1",ELECTRON_NO_ATTACH_CONSOLE:"1"};g.trace("getUnixShellEnvironment#env",i);const r=await(0,w.getSystemShell)(c.OS,i);return g.trace("getUnixShellEnvironment#shell",r),new Promise((n,o)=>{if(y.isCancellationRequested)return o((0,T.canceled)());const h=(0,I.basename)(r);let E,R;const v=process.versions.electron&&process.versions["microsoft-build"]?"--ms-enable-electron-run-as-node":"";/^pwsh(-preview)?$/.test(h)?(E=`& '${process.execPath}' ${v} -p '''${a}'' + JSON.stringify(process.env) + ''${a}'''`,R=["-Login","-Command"]):(E=`'${process.execPath}' ${v} -p '"${a}" + JSON.stringify(process.env) + "${a}"'`,R=["-ilc"]),g.trace("getUnixShellEnvironment#spawn",JSON.stringify(R),E);const O=(0,L.spawn)(r,[...R,E],{detached:!0,stdio:["ignore","pipe","pipe"],env:i});y.onCancellationRequested(()=>(O.kill(),o((0,T.canceled)()))),O.on("error",te=>{g.error("getUnixShellEnvironment#errorChildProcess",(0,D.toErrorMessage)(te)),o(te)});const A=[];O.stdout.on("data",te=>A.push(te));const G=[];O.stderr.on("data",te=>G.push(te)),O.on("close",(te,ue)=>{const ce=Buffer.concat(A).toString("utf8");g.trace("getUnixShellEnvironment#raw",ce);const ne=Buffer.concat(G).toString("utf8");if(ne.trim()&&g.trace("getUnixShellEnvironment#stderr",ne),te||ue)return o(new Error((0,b.localize)(2,null,te,ue)));const B=e.exec(ce),K=B?B[1]:"{}";try{const _=JSON.parse(K);l?_.ELECTRON_RUN_AS_NODE=l:delete _.ELECTRON_RUN_AS_NODE,s?_.ELECTRON_NO_ATTACH_CONSOLE=s:delete _.ELECTRON_NO_ATTACH_CONSOLE,delete _.XDG_RUNTIME_DIR,g.trace("getUnixShellEnvironment#result",_),n(_)}catch(_){g.error("getUnixShellEnvironment#errorCaught",(0,D.toErrorMessage)(_)),o(_)}})})}}),define(Y[52],Q([0,1,17,8,82,16]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFileIntoStream=void 0;async function D(w,C,f,S,u,d){let p;try{await T(w,C,f,S,u,d)}catch(g){p=g}finally{p&&u.errorTransformer&&(p=u.errorTransformer(p)),typeof p!="undefined"&&f.error(p),f.end()}}t.readFileIntoStream=D;async function T(w,C,f,S,u,d){c(d);const p=await w.open(C,{create:!1});try{c(d);let g=0,y=0,l=u&&typeof u.length=="number"?u.length:void 0,s=L.VSBuffer.alloc(Math.min(u.bufferSize,typeof l=="number"?l:u.bufferSize)),a=u&&typeof u.position=="number"?u.position:0,e=0;do y=await w.read(p,a,s.buffer,e,s.byteLength-e),a+=y,e+=y,g+=y,typeof l=="number"&&(l-=y),e===s.byteLength&&(await f.write(S(s)),s=L.VSBuffer.alloc(Math.min(u.bufferSize,typeof l=="number"?l:u.bufferSize)),e=0);while(y>0&&(typeof l!="number"||l>0)&&c(d)&&m(g,u));if(e>0){let i=e;typeof l=="number"&&(i=Math.min(e,l)),f.write(S(s.slice(0,i)))}}catch(g){throw(0,P.ensureFileSystemProviderError)(g)}finally{await w.close(p)}}function c(w){if(w.isCancellationRequested)throw(0,I.canceled)();return!0}function m(w,C){if(C?.limits){if(typeof C.limits.memory=="number"&&w>C.limits.memory)throw(0,P.createFileSystemProviderError)((0,b.localize)(0,null),P.FileSystemProviderErrorCode.FileExceedsMemoryLimit);if(typeof C.limits.size=="number"&&w>C.limits.size)throw(0,P.createFileSystemProviderError)((0,b.localize)(1,null),P.FileSystemProviderErrorCode.FileTooLarge)}return!0}}),define(Y[32],Q([0,1,2,12,9,16]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeFileChanges=t.toFileChanges=t.WatcherService=t.AbstractWatcherService=void 0;class D extends L.Disposable{constructor(f,S,u){super();this.onFileChanges=f,this.onLogMessage=S,this.verboseLogging=u,this.serviceDisposables=this._register(new L.MutableDisposable),this.requests=void 0,this.restartCounter=0}init(){const f=new L.DisposableStore;this.serviceDisposables.value=f,this.service=this.createService(f),this.service.setVerboseLogging(this.verboseLogging),f.add(this.service.onDidChangeFile(S=>this.onFileChanges(S))),f.add(this.service.onDidLogMessage(S=>this.onLogMessage(S))),f.add(this.service.onDidError(S=>this.onError(S)))}onError(f){this.restartCounter<D.MAX_RESTARTS&&this.requests?(this.error(`restarting watcher after error: ${f}`),this.restart(this.requests)):this.error(`gave up attempting to restart watcher after error: ${f}`)}restart(f){this.restartCounter++,this.init(),this.watch(f)}async watch(f){this.requests=f,await this.service?.watch(f)}async setVerboseLogging(f){this.verboseLogging=f,await this.service?.setVerboseLogging(f)}error(f){this.onLogMessage({type:"error",message:`[File Watcher (parcel)] ${f}`})}dispose(){return this.service=void 0,super.dispose()}}t.AbstractWatcherService=D,D.MAX_RESTARTS=5;class T extends L.Disposable{}t.WatcherService=T;function c(C){return C.map(f=>({type:f.type,resource:b.URI.file(f.path)}))}t.toFileChanges=c;function m(C){const f=new w;for(const S of C)f.processEvent(S);return f.normalize()}t.normalizeFileChanges=m;class w{constructor(){this.normalized=new Set,this.mapPathToChange=new Map}toKey(f){return I.isLinux?f.path:f.path.toLowerCase()}processEvent(f){const S=this.mapPathToChange.get(this.toKey(f));let u=!1;if(S){const d=S.type,p=f.type;S.path!==f.path&&f.type===2?u=!0:d===1&&p===2?(this.mapPathToChange.delete(this.toKey(f)),this.normalized.delete(S)):d===2&&p===1?S.type=0:d===1&&p===0||(S.type=p)}else u=!0;u&&(this.normalized.add(f),this.mapPathToChange.set(this.toKey(f),f))}normalize(){const f=[],S=[];return Array.from(this.normalized).filter(u=>u.type!==2?(f.push(u),!1):!0).sort((u,d)=>u.path.length-d.path.length).filter(u=>S.some(d=>(0,P.isParent)(u.path,d,!I.isLinux))?!1:(S.push(u.path),!0)).concat(f)}}}),define(Y[92],Q([0,1,3,2,7,63,13,131,32]),function(z,t,L,I,b,P,D,T,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class m extends I.Disposable{constructor(C,f,S,u){super();this.path=C,this.onDidFilesChange=f,this.onLogMessage=S,this.verboseLogging=u,this.fileChangesDelayer=this._register(new L.ThrottledDelayer(T.CHANGE_BUFFER_DELAY*2)),this.fileChangesBuffer=[],this.startWatching()}setVerboseLogging(C){this.verboseLogging=C}async startWatching(){try{const{stat:C,symbolicLink:f}=await D.SymlinkSupport.stat(this.path);if(this.isDisposed)return;let S=this.path;if(f)try{S=await(0,P.realpath)(S)}catch(u){if(this.onError(u),f.dangling)return}C.isDirectory()?this._register((0,T.watchFolder)(S,(u,d)=>{this.onFileChange({type:u==="changed"?0:u==="added"?1:2,path:(0,b.join)(this.path,(0,b.basename)(d))})},u=>this.onError(u))):this._register((0,T.watchFile)(S,u=>{this.onFileChange({type:u==="changed"?0:2,path:this.path})},u=>this.onError(u)))}catch(C){C.code!=="ENOENT"&&this.onError(C)}}onFileChange(C){this.fileChangesBuffer.push(C),this.verboseLogging&&this.onVerbose(`${C.type===1?"[ADDED]":C.type===2?"[DELETED]":"[CHANGED]"} ${C.path}`),this.fileChangesDelayer.trigger(async()=>{const f=this.fileChangesBuffer;this.fileChangesBuffer=[];const S=(0,c.normalizeFileChanges)(f);if(this.verboseLogging)for(const u of S)this.onVerbose(`>> normalized ${u.type===1?"[ADDED]":u.type===2?"[DELETED]":"[CHANGED]"} ${u.path}`);S.length>0&&this.onDidFilesChange(S)})}onError(C){this.isDisposed||this.onLogMessage({type:"error",message:`[File Watcher (node.js)] ${C}`})}onVerbose(C){this.isDisposed||this.onLogMessage({type:"trace",message:`[File Watcher (node.js)] ${C}`})}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=m}),define(Y[93],Q([0,1,6,36,40,32]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class D extends P.WatcherService{constructor(c,m,w){super();this.onDidFilesChange=c,this.onLogMessage=m,this.verboseLogging=w,this.isDisposed=!1,this.startWatching()}startWatching(){const c=this._register(new b.Client(L.FileAccess.asFileUri("bootstrap-fork",z).fsPath,{serverName:"File Watcher (nsfw)",args:["--type=watcherServiceNSFW"],env:{VSCODE_AMD_ENTRYPOINT:"vs/platform/files/node/watcher/nsfw/watcherApp",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));this.service=I.ProxyChannel.toService((0,I.getNextTickChannel)(c.getChannel("watcher"))),this.service.setVerboseLogging(this.verboseLogging),this._register(this.service.onDidChangeFile(m=>!this.isDisposed&&this.onDidFilesChange(m))),this._register(this.service.onDidLogMessage(m=>this.onLogMessage(m)))}async setVerboseLogging(c){this.verboseLogging=c,this.isDisposed||await this.service?.setVerboseLogging(c)}error(c){this.onLogMessage({type:"error",message:`[File Watcher (nsfw)] ${c}`})}async watch(c){this.isDisposed||await this.service?.watch(c)}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=D}),define(Y[94],Q([0,1,6,36,40,32]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class D extends P.AbstractWatcherService{constructor(c,m,w){super(c,m,w);this.init()}createService(c){const m=c.add(new b.Client(L.FileAccess.asFileUri("bootstrap-fork",z).fsPath,{serverName:"File Watcher (parcel, node.js)",args:["--type=watcherServiceParcel"],env:{VSCODE_AMD_ENTRYPOINT:"vs/platform/files/node/watcher/parcel/watcherApp",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));return c.add(m.onDidProcessExit(({code:w,signal:C})=>this.onError(`terminated by itself with code ${w}, signal: ${C}`))),I.ProxyChannel.toService((0,I.getNextTickChannel)(m.getChannel("watcher")))}}t.FileWatcher=D}),define(Y[95],Q([0,1,6,36,40,32]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class D extends P.WatcherService{constructor(c,m,w,C={}){super();this.onDidFilesChange=c,this.onLogMessage=m,this.verboseLogging=w,this.watcherOptions=C,this.isDisposed=!1,this.restartCounter=0,this.requests=void 0,this.startWatching()}startWatching(){const c=this._register(new b.Client(L.FileAccess.asFileUri("bootstrap-fork",z).fsPath,{serverName:"File Watcher (chokidar)",args:["--type=watcherServiceChokidar"],env:{VSCODE_AMD_ENTRYPOINT:"vs/platform/files/node/watcher/unix/watcherApp",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));this._register(c.onDidProcessExit(()=>{this.isDisposed||(this.restartCounter<=D.MAX_RESTARTS&&this.requests?(this.error("terminated unexpectedly and is restarted again..."),this.restartCounter++,this.startWatching(),this.service?.watch(this.requests)):this.error("failed to start after retrying for some time, giving up. Please report this as a bug report!"))})),this.service=I.ProxyChannel.toService((0,I.getNextTickChannel)(c.getChannel("watcher"))),this.service.init({...this.watcherOptions,verboseLogging:this.verboseLogging}),this._register(this.service.onDidChangeFile(m=>!this.isDisposed&&this.onDidFilesChange(m))),this._register(this.service.onDidLogMessage(m=>this.onLogMessage(m)))}async setVerboseLogging(c){this.verboseLogging=c,this.isDisposed||await this.service?.setVerboseLogging(c)}error(c){this.onLogMessage({type:"error",message:`[File Watcher (chokidar)] ${c}`})}async watch(c){this.requests=c,await this.service?.watch(c)}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=D,D.MAX_RESTARTS=5}),define(Y[53],Q([0,1]),function(z,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceCollection=void 0;class L{constructor(...b){this._entries=new Map;for(let[P,D]of b)this.set(P,D)}set(b,P){const D=this._entries.get(b);return this._entries.set(b,P),D}has(b){return this._entries.has(b)}get(b){return this._entries.get(b)}}t.ServiceCollection=L}),define(Y[96],Q([0,1,3,8,50,90,15,53]),function(z,t,L,I,b,P,D,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=void 0;const c=!1;class m extends Error{constructor(u){super("cyclic dependency between services");this.message=u.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${u.toString()}`}}class w{constructor(u=new T.ServiceCollection,d=!1,p){this._activeInstantiations=new Set,this._services=u,this._strict=d,this._parent=p,this._services.set(D.IInstantiationService,this)}createChild(u){return new w(u,this._strict,this)}invokeFunction(u,...d){let p=f.traceInvocation(u),g=!1;try{return u({get:(l,s)=>{if(g)throw(0,I.illegalState)("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(l,p);if(!a&&s!==D.optional)throw new Error(`[invokeFunction] unknown service '${l}'`);return a}},...d)}finally{g=!0,p.stop()}}createInstance(u,...d){let p,g;return u instanceof b.SyncDescriptor?(p=f.traceCreation(u.ctor),g=this._createInstance(u.ctor,u.staticArguments.concat(d),p)):(p=f.traceCreation(u),g=this._createInstance(u,d,p)),p.stop(),g}_createInstance(u,d=[],p){let g=D._util.getServiceDependencies(u).sort((s,a)=>s.index-a.index),y=[];for(const s of g){let a=this._getOrCreateServiceInstance(s.id,p);if(!a&&this._strict&&!s.optional)throw new Error(`[createInstance] ${u.name} depends on UNKNOWN service ${s.id}.`);y.push(a)}let l=g.length>0?g[0].index:d.length;if(d.length!==l){console.warn(`[createInstance] First service dependency of ${u.name} at position ${l+1} conflicts with ${d.length} static arguments`);let s=l-d.length;s>0?d=d.concat(new Array(s)):d=d.slice(0,l)}return new u(...[...d,...y])}_setServiceInstance(u,d){if(this._services.get(u)instanceof b.SyncDescriptor)this._services.set(u,d);else if(this._parent)this._parent._setServiceInstance(u,d);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(u){let d=this._services.get(u);return!d&&this._parent?this._parent._getServiceInstanceOrDescriptor(u):d}_getOrCreateServiceInstance(u,d){let p=this._getServiceInstanceOrDescriptor(u);return p instanceof b.SyncDescriptor?this._safeCreateAndCacheServiceInstance(u,p,d.branch(u,!0)):(d.branch(u,!1),p)}_safeCreateAndCacheServiceInstance(u,d,p){if(this._activeInstantiations.has(u))throw new Error(`illegal state - RECURSIVELY instantiating service '${u}'`);this._activeInstantiations.add(u);try{return this._createAndCacheServiceInstance(u,d,p)}finally{this._activeInstantiations.delete(u)}}_createAndCacheServiceInstance(u,d,p){const g=new P.Graph(s=>s.id.toString());let y=0;const l=[{id:u,desc:d,_trace:p}];for(;l.length;){const s=l.pop();if(g.lookupOrInsertNode(s),y++>1e3)throw new m(g);for(let a of D._util.getServiceDependencies(s.desc.ctor)){let e=this._getServiceInstanceOrDescriptor(a.id);if(!e&&!a.optional&&console.warn(`[createInstance] ${u} depends on ${a.id} which is NOT registered.`),e instanceof b.SyncDescriptor){const i={id:a.id,desc:e,_trace:s._trace.branch(a.id,!0)};g.insertEdge(s,i),l.push(i)}}}for(;;){const s=g.roots();if(s.length===0){if(!g.isEmpty())throw new m(g);break}for(const{data:a}of s){if(this._getServiceInstanceOrDescriptor(a.id)instanceof b.SyncDescriptor){const i=this._createServiceInstanceWithOwner(a.id,a.desc.ctor,a.desc.staticArguments,a.desc.supportsDelayedInstantiation,a._trace);this._setServiceInstance(a.id,i)}g.removeNode(a)}}return this._getServiceInstanceOrDescriptor(u)}_createServiceInstanceWithOwner(u,d,p=[],g,y){if(this._services.get(u)instanceof b.SyncDescriptor)return this._createServiceInstance(d,p,g,y);if(this._parent)return this._parent._createServiceInstanceWithOwner(u,d,p,g,y);throw new Error(`illegalState - creating UNKNOWN service instance ${d.name}`)}_createServiceInstance(u,d=[],p,g){if(p){const y=new L.IdleValue(()=>this._createInstance(u,d,g));return new Proxy(Object.create(null),{get(l,s){if(s in l)return l[s];let a=y.value,e=a[s];return typeof e!="function"||(e=e.bind(a),l[s]=e),e},set(l,s,a){return y.value[s]=a,!0}})}else return this._createInstance(u,d,g)}}t.InstantiationService=w;var C;(function(S){S[S.Creation=0]="Creation",S[S.Invocation=1]="Invocation",S[S.Branch=2]="Branch"})(C||(C={}));class f{constructor(u,d){this.type=u,this.name=d,this._start=Date.now(),this._dep=[]}static traceInvocation(u){return c?new f(1,u.name||u.toString().substring(0,42).replace(/\n/g,"")):f._None}static traceCreation(u){return c?new f(0,u.name):f._None}branch(u,d){let p=new f(2,u.toString());return this._dep.push([u,d,p]),p}stop(){let u=Date.now()-this._start;f._totals+=u;let d=!1;function p(y,l){let s=[],a=new Array(y+1).join("	");for(const[e,i,r]of l._dep)if(i&&r){d=!0,s.push(`${a}CREATES -> ${e}`);let n=p(y+1,r);n&&s.push(n)}else s.push(`${a}uses -> ${e}`);return s.join(`
`)}let g=[`${this.type===0?"CREATE":"CALL"} ${this.name}`,`${p(1,this)}`,`DONE, took ${u.toFixed(2)}ms (grand total ${f._totals.toFixed(2)}ms)`];(u>2||d)&&console.log(g.join(`
`))}}f._None=new class extends f{constructor(){super(-1,null)}stop(){}branch(){return this}},f._totals=0}),define(Y[54],Q([0,1,15]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidLocalization=t.ILocalizationsService=void 0,t.ILocalizationsService=(0,L.createDecorator)("localizationsService");function I(b){if(typeof b.languageId!="string"||!Array.isArray(b.translations)||b.translations.length===0)return!1;for(const P of b.translations)if(typeof P.id!="string"||typeof P.path!="string")return!1;return!(b.languageName&&typeof b.languageName!="string"||b.localizedLanguageName&&typeof b.localizedLanguageName!="string")}t.isValidLocalization=I}),define(Y[14],Q([0,1,28,10,2,12,15]),function(z,t,L,I,b,P,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevelToString=t.parseLogLevel=t.getLogLevel=t.NullLogService=t.AbstractLoggerService=t.LogService=t.MultiplexLogService=t.AdapterLogger=t.ConsoleLogger=t.ConsoleMainLogger=t.AbstractMessageLogger=t.AbstractLogger=t.DEFAULT_LOG_LEVEL=t.LogLevel=t.ILoggerService=t.ILogService=void 0,t.ILogService=(0,D.createDecorator)("logService"),t.ILoggerService=(0,D.createDecorator)("loggerService");function T(){return new Date().toISOString()}var c;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warning=3]="Warning",a[a.Error=4]="Error",a[a.Critical=5]="Critical",a[a.Off=6]="Off"})(c=t.LogLevel||(t.LogLevel={})),t.DEFAULT_LOG_LEVEL=c.Info;class m extends b.Disposable{constructor(){super(...arguments);this.level=t.DEFAULT_LOG_LEVEL,this._onDidChangeLogLevel=this._register(new I.Emitter),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}t.AbstractLogger=m;class w extends m{constructor(e){super();this.logAlways=e}checkLogLevel(e){return this.logAlways||this.getLevel()<=e}trace(e,...i){this.checkLogLevel(c.Trace)&&this.log(c.Trace,this.format([e,...i]))}debug(e,...i){this.checkLogLevel(c.Debug)&&this.log(c.Debug,this.format([e,...i]))}info(e,...i){this.checkLogLevel(c.Info)&&this.log(c.Info,this.format([e,...i]))}warn(e,...i){this.checkLogLevel(c.Warning)&&this.log(c.Warning,this.format([e,...i]))}error(e,...i){if(this.checkLogLevel(c.Error))if(e instanceof Error){const r=Array.prototype.slice.call(arguments);r[0]=e.stack,this.log(c.Error,this.format(r))}else this.log(c.Error,this.format([e,...i]))}critical(e,...i){this.checkLogLevel(c.Critical)&&this.log(c.Critical,this.format([e,...i]))}flush(){}format(e){let i="";for(let r=0;r<e.length;r++){let n=e[r];if(typeof n=="object")try{n=JSON.stringify(n)}catch(o){}i+=(r>0?" ":"")+n}return i}}t.AbstractMessageLogger=w;class C extends m{constructor(e=t.DEFAULT_LOG_LEVEL){super();this.setLevel(e),this.useColors=!P.isWindows}trace(e,...i){this.getLevel()<=c.Trace&&(this.useColors?console.log(`[90m[main ${T()}][0m`,e,...i):console.log(`[main ${T()}]`,e,...i))}debug(e,...i){this.getLevel()<=c.Debug&&(this.useColors?console.log(`[90m[main ${T()}][0m`,e,...i):console.log(`[main ${T()}]`,e,...i))}info(e,...i){this.getLevel()<=c.Info&&(this.useColors?console.log(`[90m[main ${T()}][0m`,e,...i):console.log(`[main ${T()}]`,e,...i))}warn(e,...i){this.getLevel()<=c.Warning&&(this.useColors?console.warn(`[93m[main ${T()}][0m`,e,...i):console.warn(`[main ${T()}]`,e,...i))}error(e,...i){this.getLevel()<=c.Error&&(this.useColors?console.error(`[91m[main ${T()}][0m`,e,...i):console.error(`[main ${T()}]`,e,...i))}critical(e,...i){this.getLevel()<=c.Critical&&(this.useColors?console.error(`[90m[main ${T()}][0m`,e,...i):console.error(`[main ${T()}]`,e,...i))}dispose(){}flush(){}}t.ConsoleMainLogger=C;class f extends m{constructor(e=t.DEFAULT_LOG_LEVEL){super();this.setLevel(e)}trace(e,...i){this.getLevel()<=c.Trace&&console.log("%cTRACE","color: #888",e,...i)}debug(e,...i){this.getLevel()<=c.Debug&&console.log("%cDEBUG","background: #eee; color: #888",e,...i)}info(e,...i){this.getLevel()<=c.Info&&console.log("%c INFO","color: #33f",e,...i)}warn(e,...i){this.getLevel()<=c.Warning&&console.log("%c WARN","color: #993",e,...i)}error(e,...i){this.getLevel()<=c.Error&&console.log("%c  ERR","color: #f33",e,...i)}critical(e,...i){this.getLevel()<=c.Critical&&console.log("%cCRITI","background: #f33; color: white",e,...i)}dispose(){}flush(){}}t.ConsoleLogger=f;class S extends m{constructor(e,i=t.DEFAULT_LOG_LEVEL){super();this.adapter=e,this.setLevel(i)}trace(e,...i){this.getLevel()<=c.Trace&&this.adapter.log(c.Trace,[this.extractMessage(e),...i])}debug(e,...i){this.getLevel()<=c.Debug&&this.adapter.log(c.Debug,[this.extractMessage(e),...i])}info(e,...i){this.getLevel()<=c.Info&&this.adapter.log(c.Info,[this.extractMessage(e),...i])}warn(e,...i){this.getLevel()<=c.Warning&&this.adapter.log(c.Warning,[this.extractMessage(e),...i])}error(e,...i){this.getLevel()<=c.Error&&this.adapter.log(c.Error,[this.extractMessage(e),...i])}critical(e,...i){this.getLevel()<=c.Critical&&this.adapter.log(c.Critical,[this.extractMessage(e),...i])}extractMessage(e){return typeof e=="string"?e:(0,L.toErrorMessage)(e,this.getLevel()<=c.Trace)}dispose(){}flush(){}}t.AdapterLogger=S;class u extends m{constructor(e){super();this.logServices=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const i of this.logServices)i.setLevel(e);super.setLevel(e)}trace(e,...i){for(const r of this.logServices)r.trace(e,...i)}debug(e,...i){for(const r of this.logServices)r.debug(e,...i)}info(e,...i){for(const r of this.logServices)r.info(e,...i)}warn(e,...i){for(const r of this.logServices)r.warn(e,...i)}error(e,...i){for(const r of this.logServices)r.error(e,...i)}critical(e,...i){for(const r of this.logServices)r.critical(e,...i)}flush(){for(const e of this.logServices)e.flush()}dispose(){for(const e of this.logServices)e.dispose()}}t.MultiplexLogService=u;class d extends b.Disposable{constructor(e){super();this.logger=e,this._register(e)}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...i){this.logger.trace(e,...i)}debug(e,...i){this.logger.debug(e,...i)}info(e,...i){this.logger.info(e,...i)}warn(e,...i){this.logger.warn(e,...i)}error(e,...i){this.logger.error(e,...i)}critical(e,...i){this.logger.critical(e,...i)}flush(){this.logger.flush()}}t.LogService=d;class p extends b.Disposable{constructor(e,i){super();this.logLevel=e,this.loggers=new Map,this.logLevelChangeableLoggers=[],this._register(i(r=>{this.logLevel=r,this.logLevelChangeableLoggers.forEach(n=>n.setLevel(r))}))}getLogger(e){return this.loggers.get(e.toString())}createLogger(e,i){let r=this.loggers.get(e.toString());return r||(r=this.doCreateLogger(e,i?.always?c.Trace:this.logLevel,i),this.loggers.set(e.toString(),r),i?.always||this.logLevelChangeableLoggers.push(r)),r}dispose(){this.logLevelChangeableLoggers.splice(0,this.logLevelChangeableLoggers.length),this.loggers.forEach(e=>e.dispose()),this.loggers.clear(),super.dispose()}}t.AbstractLoggerService=p;class g{constructor(){this.onDidChangeLogLevel=new I.Emitter().event}setLevel(e){}getLevel(){return c.Info}trace(e,...i){}debug(e,...i){}info(e,...i){}warn(e,...i){}error(e,...i){}critical(e,...i){}dispose(){}flush(){}}t.NullLogService=g;function y(a){if(a.verbose)return c.Trace;if(typeof a.logLevel=="string"){const e=l(a.logLevel.toLowerCase());if(e!==void 0)return e}return t.DEFAULT_LOG_LEVEL}t.getLogLevel=y;function l(a){switch(a){case"trace":return c.Trace;case"debug":return c.Debug;case"info":return c.Info;case"warn":return c.Warning;case"error":return c.Error;case"critical":return c.Critical;case"off":return c.Off}}t.parseLogLevel=l;function s(a){switch(a){case c.Trace:return"trace";case c.Debug:return"debug";case c.Info:return"info";case c.Warning:return"warn";case c.Error:return"error";case c.Critical:return"critical";case c.Off:return"off"}}t.LogLevelToString=s});var ae=this&&this.__param||function(z,t){return function(L,I){t(L,I,z)}};define(Y[97],Q([0,1,39,3,28,10,2,6,7,13,21,14]),function(z,t,L,I,b,P,D,T,c,m,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsLifecycle=void 0;let f=class extends D.Disposable{constructor(u,d){super();this.environmentService=u,this.logService=d,this.processesLimiter=new I.Limiter(5)}async postUninstall(u){const d=this.parseScript(u,"uninstall");return d&&(this.logService.info(u.identifier.id,u.manifest.version,"Running post uninstall script"),await this.processesLimiter.queue(()=>this.runLifecycleHook(d.script,"uninstall",d.args,!0,u).then(()=>this.logService.info(u.identifier.id,u.manifest.version,"Finished running post uninstall script"),p=>this.logService.error(u.identifier.id,u.manifest.version,`Failed to run post uninstall script: ${p}`)))),m.Promises.rm(this.getExtensionStoragePath(u)).then(void 0,p=>this.logService.error("Error while removing extension storage path",p))}parseScript(u,d){const p=`vscode:${d}`;if(u.location.scheme===T.Schemas.file&&u.manifest&&u.manifest.scripts&&typeof u.manifest.scripts[p]=="string"){const g=u.manifest.scripts[p].split(" ");return g.length<2||g[0]!=="node"||!g[1]?(this.logService.warn(u.identifier.id,u.manifest.version,`${p} should be a node script`),null):{script:(0,c.join)(u.location.fsPath,g[1]),args:g.slice(2)||[]}}return null}runLifecycleHook(u,d,p,g,y){return new Promise((l,s)=>{const a=this.start(u,d,p,y);let e;const i=r=>{e&&(clearTimeout(e),e=null),r?s(r):l(void 0)};a.on("error",r=>{i((0,b.toErrorMessage)(r)||"Unknown")}),a.on("exit",(r,n)=>{i(r?`post-${d} process exited with code ${r}`:void 0)}),g&&(e=setTimeout(()=>{e=null,a.kill(),s("timed out")},5e3))})}start(u,d,p,g){const y={silent:!0,execArgv:void 0},l=(0,L.fork)(u,[`--type=extension-post-${d}`,...p],y);l.stdout.setEncoding("utf8"),l.stderr.setEncoding("utf8");const s=P.Event.fromNodeEventEmitter(l.stdout,"data"),a=P.Event.fromNodeEventEmitter(l.stderr,"data");s(r=>this.logService.info(g.identifier.id,g.manifest.version,`post-${d}`,r)),a(r=>this.logService.error(g.identifier.id,g.manifest.version,`post-${d}`,r));const e=P.Event.any(P.Event.map(s,r=>({data:`%c${r}`,format:[""]})),P.Event.map(a,r=>({data:`%c${r}`,format:["color: red"]})));return P.Event.debounce(e,(r,n)=>r?{data:r.data+n.data,format:[...r.format,...n.format]}:{data:n.data,format:n.format},100)(r=>{console.group(g.identifier.id),console.log(r.data,...r.format),console.groupEnd()}),l}getExtensionStoragePath(u){return(0,c.join)(this.environmentService.globalStorageHome.fsPath,u.identifier.id.toLowerCase())}};f=de([ae(0,w.IEnvironmentService),ae(1,C.ILogService)],f),t.ExtensionsLifecycle=f}),define(Y[98],Q([0,1,20,3,8,10,2,7,32,14]),function(z,t,L,I,b,P,D,T,c,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractDiskFileSystemProvider=void 0;class w extends D.Disposable{constructor(f){super();this.logService=f,this._onDidErrorOccur=this._register(new P.Emitter),this.onDidErrorOccur=this._onDidErrorOccur.event,this._onDidChangeFile=this._register(new P.Emitter),this.onDidChangeFile=this._onDidChangeFile.event,this.recursiveFoldersToWatch=[],this.recursiveWatchRequestDelayer=this._register(new I.ThrottledDelayer(0))}watch(f,S){return S.recursive?this.watchRecursive(f,S):this.watchNonRecursive(f)}watchRecursive(f,S){const u={path:this.toFilePath(f),excludes:S.excludes},d=(0,L.insert)(this.recursiveFoldersToWatch,u);return this.refreshRecursiveWatchers(),(0,D.toDisposable)(()=>{d(),this.refreshRecursiveWatchers()})}refreshRecursiveWatchers(){this.recursiveWatchRequestDelayer.trigger(()=>this.doRefreshRecursiveWatchers()).catch(f=>(0,b.onUnexpectedError)(f))}doRefreshRecursiveWatchers(){return this.recursiveWatcher||(this.recursiveWatcher=this._register(this.createRecursiveWatcher(this.recursiveFoldersToWatch.length,f=>this._onDidChangeFile.fire((0,c.toFileChanges)(f)),f=>this.onWatcherLogMessage(f),this.logService.getLevel()===m.LogLevel.Trace)),this._register(this.logService.onDidChangeLogLevel(()=>{this.recursiveWatcher?.setVerboseLogging(this.logService.getLevel()===m.LogLevel.Trace)}))),this.doWatch(this.recursiveWatcher,this.recursiveFoldersToWatch)}doWatch(f,S){return f.watch(S)}watchNonRecursive(f){const S=this.createNonRecursiveWatcher(this.toFilePath(f),d=>this._onDidChangeFile.fire((0,c.toFileChanges)(d)),d=>this.onWatcherLogMessage(d),this.logService.getLevel()===m.LogLevel.Trace),u=this.logService.onDidChangeLogLevel(()=>{S.setVerboseLogging(this.logService.getLevel()===m.LogLevel.Trace)});return(0,D.combinedDisposable)(S,u)}onWatcherLogMessage(f){f.type==="error"&&this._onDidErrorOccur.fire(f.message),this.logService[f.type](f.message)}toFilePath(f){return(0,T.normalize)(f.fsPath)}}t.AbstractDiskFileSystemProvider=w}),define(Y[99],Q([0,1,20,3,17,24,10,132,2,100,6,101,19,38,81,16,52,14]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileService=void 0;let y=class xe extends c.Disposable{constructor(s){super();this.logService=s,this.BUFFER_SIZE=256*1024,this._onDidChangeFileSystemProviderRegistrations=this._register(new D.Emitter),this.onDidChangeFileSystemProviderRegistrations=this._onDidChangeFileSystemProviderRegistrations.event,this._onWillActivateFileSystemProvider=this._register(new D.Emitter),this.onWillActivateFileSystemProvider=this._onWillActivateFileSystemProvider.event,this._onDidChangeFileSystemProviderCapabilities=this._register(new D.Emitter),this.onDidChangeFileSystemProviderCapabilities=this._onDidChangeFileSystemProviderCapabilities.event,this.provider=new Map,this._onDidRunOperation=this._register(new D.Emitter),this.onDidRunOperation=this._onDidRunOperation.event,this._onError=this._register(new D.Emitter),this.onError=this._onError.event,this._onDidFilesChange=this._register(new D.Emitter),this.onDidFilesChange=this._onDidFilesChange.event,this._onDidChangeFilesRaw=this._register(new D.Emitter),this.onDidChangeFilesRaw=this._onDidChangeFilesRaw.event,this.activeWatchers=new Map,this.caseSensitiveFileEventsWorker=this._register(new I.ThrottledWorker(xe.FILE_EVENTS_THROTTLING.maxChangesChunkSize,xe.FILE_EVENTS_THROTTLING.maxChangesBufferSize,xe.FILE_EVENTS_THROTTLING.coolDownDelay,a=>this._onDidFilesChange.fire(new d.FileChangesEvent(a,!1)))),this.caseInsensitiveFileEventsWorker=this._register(new I.ThrottledWorker(xe.FILE_EVENTS_THROTTLING.maxChangesChunkSize,xe.FILE_EVENTS_THROTTLING.maxChangesBufferSize,xe.FILE_EVENTS_THROTTLING.coolDownDelay,a=>this._onDidFilesChange.fire(new d.FileChangesEvent(a,!0)))),this.watchedResources=m.TernarySearchTree.forUris(a=>{const e=this.getProvider(a.scheme);return e?!this.isPathCaseSensitive(e):!1}),this.writeQueue=this._register(new I.ResourceQueue)}registerProvider(s,a){if(this.provider.has(s))throw new Error(`A filesystem provider for the scheme '${s}' is already registered.`);(0,C.mark)(`code/registerFilesystem/${s}`),this.provider.set(s,a),this._onDidChangeFileSystemProviderRegistrations.fire({added:!0,scheme:s,provider:a});const e=new c.DisposableStore;return e.add(a.onDidChangeFile(i=>this.onDidChangeFile(i,this.isPathCaseSensitive(a)))),e.add(a.onDidChangeCapabilities(()=>this._onDidChangeFileSystemProviderCapabilities.fire({provider:a,scheme:s}))),typeof a.onDidErrorOccur=="function"&&e.add(a.onDidErrorOccur(i=>this._onError.fire(new Error(i)))),(0,c.toDisposable)(()=>{this._onDidChangeFileSystemProviderRegistrations.fire({added:!1,scheme:s,provider:a}),this.provider.delete(s),(0,c.dispose)(e)})}getProvider(s){return this.provider.get(s)}async activateProvider(s){const a=[];this._onWillActivateFileSystemProvider.fire({scheme:s,join(e){a.push(e)}}),!this.provider.has(s)&&await I.Promises.settled(a)}async canHandleResource(s){return await this.activateProvider(s.scheme),this.hasProvider(s)}hasProvider(s){return this.provider.has(s.scheme)}hasCapability(s,a){const e=this.provider.get(s.scheme);return!!(e&&e.capabilities&a)}listCapabilities(){return T.Iterable.map(this.provider,([s,a])=>({scheme:s,capabilities:a.capabilities}))}async withProvider(s){if(!(0,f.isAbsolutePath)(s))throw new d.FileOperationError((0,u.localize)(0,null,this.resourceForError(s)),8);await this.activateProvider(s.scheme);const a=this.provider.get(s.scheme);if(!a){const e=new Error;throw e.name="ENOPRO",e.message=(0,u.localize)(1,null,s.toString()),e}return a}async withReadProvider(s){const a=await this.withProvider(s);if((0,d.hasOpenReadWriteCloseCapability)(a)||(0,d.hasReadWriteCapability)(a)||(0,d.hasFileReadStreamCapability)(a))return a;throw new Error(`Filesystem provider for scheme '${s.scheme}' neither has FileReadWrite, FileReadStream nor FileOpenReadWriteClose capability which is needed for the read operation.`)}async withWriteProvider(s){const a=await this.withProvider(s);if((0,d.hasOpenReadWriteCloseCapability)(a)||(0,d.hasReadWriteCapability)(a))return a;throw new Error(`Filesystem provider for scheme '${s.scheme}' neither has FileReadWrite nor FileOpenReadWriteClose capability which is needed for the write operation.`)}async resolve(s,a){try{return await this.doResolveFile(s,a)}catch(e){throw(0,d.toFileSystemProviderErrorCode)(e)===d.FileSystemProviderErrorCode.FileNotFound?new d.FileOperationError((0,u.localize)(2,null,this.resourceForError(s)),1):(0,d.ensureFileSystemProviderError)(e)}}async doResolveFile(s,a){const e=await this.withProvider(s),i=this.isPathCaseSensitive(e),r=a?.resolveTo,n=a?.resolveSingleChildDescendants,o=a?.resolveMetadata,h=await e.stat(s);let E;return this.toFileStat(e,s,h,void 0,!!o,(R,v)=>(E||(E=m.TernarySearchTree.forUris(()=>!i),E.set(s,!0),r&&E.fill(!0,r)),E.get(R.resource)||E.findSuperstr(R.resource.with({query:null,fragment:null}))?!0:R.isDirectory&&n?v===1:!1))}async toFileStat(s,a,e,i,r,n){const{providerExtUri:o}=this.getExtUri(s),h={resource:a,name:o.basename(a),isFile:(e.type&d.FileType.File)!=0,isDirectory:(e.type&d.FileType.Directory)!=0,isSymbolicLink:(e.type&d.FileType.SymbolicLink)!=0,mtime:e.mtime,ctime:e.ctime,size:e.size,readonly:Boolean((e.permissions??0)&d.FilePermission.Readonly)||Boolean(s.capabilities&2048),etag:(0,d.etag)({mtime:e.mtime,size:e.size})};if(h.isDirectory&&n(h,i)){try{const E=await s.readdir(a),R=await I.Promises.settled(E.map(async([v,O])=>{try{const A=o.joinPath(a,v),G=r?await s.stat(A):{type:O};return await this.toFileStat(s,A,G,E.length,r,n)}catch(A){return this.logService.trace(A),null}}));h.children=(0,L.coalesce)(R)}catch(E){this.logService.trace(E),h.children=[]}return h}return h}async resolveAll(s){return I.Promises.settled(s.map(async a=>{try{return{stat:await this.doResolveFile(a.resource,a.options),success:!0}}catch(e){return this.logService.trace(e),{stat:void 0,success:!1}}}))}async exists(s){const a=await this.withProvider(s);try{return!!await a.stat(s)}catch(e){return!1}}async canCreateFile(s,a){try{await this.doValidateCreateFile(s,a)}catch(e){return e}return!0}async doValidateCreateFile(s,a){if(!a?.overwrite&&await this.exists(s))throw new d.FileOperationError((0,u.localize)(3,null,this.resourceForError(s)),3,a)}async createFile(s,a=b.VSBuffer.fromString(""),e){await this.doValidateCreateFile(s,e);const i=await this.writeFile(s,a);return this._onDidRunOperation.fire(new d.FileOperationEvent(s,0,i)),i}async writeFile(s,a,e){const i=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(s),s),{providerExtUri:r}=this.getExtUri(i);try{await this.validateWriteFile(i,s,e)||await this.mkdirp(i,r.dirname(s));let o;if((0,d.hasReadWriteCapability)(i)&&!(a instanceof b.VSBuffer))if((0,S.isReadableStream)(a)){const h=await(0,S.peekStream)(a,3);h.ended?o=b.VSBuffer.concat(h.buffer):o=h}else o=(0,S.peekReadable)(a,h=>b.VSBuffer.concat(h),3);else o=a;!(0,d.hasOpenReadWriteCloseCapability)(i)||(0,d.hasReadWriteCapability)(i)&&o instanceof b.VSBuffer?await this.doWriteUnbuffered(i,s,e,o):await this.doWriteBuffered(i,s,e,o instanceof b.VSBuffer?(0,b.bufferToReadable)(o):o)}catch(n){throw new d.FileOperationError((0,u.localize)(4,null,this.resourceForError(s),(0,d.ensureFileSystemProviderError)(n).toString()),(0,d.toFileOperationResult)(n),e)}return this.resolve(s,{resolveMetadata:!0})}async validateWriteFile(s,a,e){if(!!e?.unlock&&!(s.capabilities&8192))throw new Error((0,u.localize)(5,null,this.resourceForError(a)));let r;try{r=await s.stat(a)}catch(n){return}if((r.type&d.FileType.Directory)!=0)throw new d.FileOperationError((0,u.localize)(6,null,this.resourceForError(a)),0,e);if(this.throwIfFileIsReadonly(a,r),typeof e?.mtime=="number"&&typeof e.etag=="string"&&e.etag!==d.ETAG_DISABLED&&typeof r.mtime=="number"&&typeof r.size=="number"&&e.mtime<r.mtime&&e.etag!==(0,d.etag)({mtime:e.mtime,size:r.size}))throw new d.FileOperationError((0,u.localize)(7,null),3,e);return r}async readFile(s,a){const e=await this.withReadProvider(s);return a?.atomic?this.doReadFileAtomic(e,s,a):this.doReadFile(e,s,a)}async doReadFileAtomic(s,a,e){return new Promise((i,r)=>{this.writeQueue.queueFor(a,this.getExtUri(s).providerExtUri).queue(async()=>{try{const n=await this.doReadFile(s,a,e);i(n)}catch(n){r(n)}})})}async doReadFile(s,a,e){const i=await this.doReadFileStream(s,a,{...e,preferUnbuffered:!0});return{...i,value:await(0,b.streamToBuffer)(i.value)}}async readFileStream(s,a){const e=await this.withReadProvider(s);return this.doReadFileStream(e,s,a)}async doReadFileStream(s,a,e){const i=new P.CancellationTokenSource,r=this.validateReadFile(a,e).then(o=>o,o=>{throw i.cancel(),o});let n;try{return typeof e?.etag=="string"&&e.etag!==d.ETAG_DISABLED&&await r,!((0,d.hasOpenReadWriteCloseCapability)(s)||(0,d.hasFileReadStreamCapability)(s))||(0,d.hasReadWriteCapability)(s)&&e?.preferUnbuffered?n=this.readFileUnbuffered(s,a,e):(0,d.hasFileReadStreamCapability)(s)?n=this.readFileStreamed(s,a,i.token,e):n=this.readFileBuffered(s,a,i.token,e),{...await r,value:n}}catch(o){n&&await(0,S.consumeStream)(n);const h=(0,u.localize)(8,null,this.resourceForError(a),(0,d.ensureFileSystemProviderError)(o).toString());throw o instanceof d.NotModifiedSinceFileOperationError?new d.NotModifiedSinceFileOperationError(h,o.stat,e):new d.FileOperationError(h,(0,d.toFileOperationResult)(o),e)}}readFileStreamed(s,a,e,i=Object.create(null)){const r=s.readFileStream(a,i,e);return(0,S.transform)(r,{data:n=>n instanceof b.VSBuffer?n:b.VSBuffer.wrap(n),error:n=>new d.FileOperationError((0,u.localize)(9,null,this.resourceForError(a),(0,d.ensureFileSystemProviderError)(n).toString()),(0,d.toFileOperationResult)(n),i)},n=>b.VSBuffer.concat(n))}readFileBuffered(s,a,e,i=Object.create(null)){const r=(0,b.newWriteableBufferStream)();return(0,p.readFileIntoStream)(s,a,r,n=>n,{...i,bufferSize:this.BUFFER_SIZE,errorTransformer:n=>new d.FileOperationError((0,u.localize)(10,null,this.resourceForError(a),(0,d.ensureFileSystemProviderError)(n).toString()),(0,d.toFileOperationResult)(n),i)},e),r}readFileUnbuffered(s,a,e){const i=(0,S.newWriteableStream)(r=>b.VSBuffer.concat(r));return(async()=>{try{let r=await s.readFile(a);typeof e?.position=="number"&&(r=r.slice(e.position)),typeof e?.length=="number"&&(r=r.slice(0,e.length)),this.validateReadFileLimits(a,r.byteLength,e),i.end(b.VSBuffer.wrap(r))}catch(r){i.error(r),i.end()}})(),i}async validateReadFile(s,a){const e=await this.resolve(s,{resolveMetadata:!0});if(e.isDirectory)throw new d.FileOperationError((0,u.localize)(11,null,this.resourceForError(s)),0,a);if(typeof a?.etag=="string"&&a.etag!==d.ETAG_DISABLED&&a.etag===e.etag)throw new d.NotModifiedSinceFileOperationError((0,u.localize)(12,null),e,a);return this.validateReadFileLimits(s,e.size,a),e}validateReadFileLimits(s,a,e){if(e?.limits){let i;if(typeof e.limits.memory=="number"&&a>e.limits.memory&&(i=9),typeof e.limits.size=="number"&&a>e.limits.size&&(i=7),typeof i=="number")throw new d.FileOperationError((0,u.localize)(13,null,this.resourceForError(s)),i)}}async canMove(s,a,e){return this.doCanMoveCopy(s,a,"move",e)}async canCopy(s,a,e){return this.doCanMoveCopy(s,a,"copy",e)}async doCanMoveCopy(s,a,e,i){if(s.toString()!==a.toString())try{const r=e==="move"?this.throwIfFileSystemIsReadonly(await this.withWriteProvider(s),s):await this.withReadProvider(s),n=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(a),a);await this.doValidateMoveCopy(r,s,n,a,e,i)}catch(r){return r}return!0}async move(s,a,e){const i=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(s),s),r=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(a),a),n=await this.doMoveCopy(i,s,r,a,"move",!!e),o=await this.resolve(a,{resolveMetadata:!0});return this._onDidRunOperation.fire(new d.FileOperationEvent(s,n==="move"?2:3,o)),o}async copy(s,a,e){const i=await this.withReadProvider(s),r=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(a),a),n=await this.doMoveCopy(i,s,r,a,"copy",!!e),o=await this.resolve(a,{resolveMetadata:!0});return this._onDidRunOperation.fire(new d.FileOperationEvent(s,n==="copy"?3:2,o)),o}async doMoveCopy(s,a,e,i,r,n){if(a.toString()===i.toString())return r;const{exists:o,isSameResourceWithDifferentPathCase:h}=await this.doValidateMoveCopy(s,a,e,i,r,n);if(o&&!h&&n&&await this.del(i,{recursive:!0}),await this.mkdirp(e,this.getExtUri(e).providerExtUri.dirname(i)),r==="copy"){if(s===e&&(0,d.hasFileFolderCopyCapability)(s))await s.copy(a,i,{overwrite:n});else{const E=await this.resolve(a);E.isDirectory?await this.doCopyFolder(s,E,e,i):await this.doCopyFile(s,a,e,i)}return r}else return s===e?(await s.rename(a,i,{overwrite:n}),r):(await this.doMoveCopy(s,a,e,i,"copy",n),await this.del(a,{recursive:!0}),"copy")}async doCopyFile(s,a,e,i){if((0,d.hasOpenReadWriteCloseCapability)(s)&&(0,d.hasOpenReadWriteCloseCapability)(e))return this.doPipeBuffered(s,a,e,i);if((0,d.hasOpenReadWriteCloseCapability)(s)&&(0,d.hasReadWriteCapability)(e))return this.doPipeBufferedToUnbuffered(s,a,e,i);if((0,d.hasReadWriteCapability)(s)&&(0,d.hasOpenReadWriteCloseCapability)(e))return this.doPipeUnbufferedToBuffered(s,a,e,i);if((0,d.hasReadWriteCapability)(s)&&(0,d.hasReadWriteCapability)(e))return this.doPipeUnbuffered(s,a,e,i)}async doCopyFolder(s,a,e,i){await e.mkdir(i),Array.isArray(a.children)&&await I.Promises.settled(a.children.map(async r=>{const n=this.getExtUri(e).providerExtUri.joinPath(i,r.name);return r.isDirectory?this.doCopyFolder(s,await this.resolve(r.resource),e,n):this.doCopyFile(s,r.resource,e,n)}))}async doValidateMoveCopy(s,a,e,i,r,n){let o=!1;if(s===e){const{providerExtUri:E,isPathCaseSensitive:R}=this.getExtUri(s);if(R||(o=E.isEqual(a,i)),o&&r==="copy")throw new Error((0,u.localize)(14,null,this.resourceForError(a),this.resourceForError(i)));if(!o&&E.isEqualOrParent(i,a))throw new Error((0,u.localize)(15,null,this.resourceForError(a),this.resourceForError(i)))}const h=await this.exists(i);if(h&&!o){if(!n)throw new d.FileOperationError((0,u.localize)(16,null,this.resourceForError(a),this.resourceForError(i)),4);if(s===e){const{providerExtUri:E}=this.getExtUri(s);if(E.isEqualOrParent(a,i))throw new Error((0,u.localize)(17,null,this.resourceForError(a),this.resourceForError(i)))}}return{exists:h,isSameResourceWithDifferentPathCase:o}}getExtUri(s){const a=this.isPathCaseSensitive(s);return{providerExtUri:a?f.extUri:f.extUriIgnorePathCase,isPathCaseSensitive:a}}isPathCaseSensitive(s){return!!(s.capabilities&1024)}async createFolder(s){const a=this.throwIfFileSystemIsReadonly(await this.withProvider(s),s);await this.mkdirp(a,s);const e=await this.resolve(s,{resolveMetadata:!0});return this._onDidRunOperation.fire(new d.FileOperationEvent(s,0,e)),e}async mkdirp(s,a){const e=[],{providerExtUri:i}=this.getExtUri(s);for(;!i.isEqual(a,i.dirname(a));)try{if(((await s.stat(a)).type&d.FileType.Directory)==0)throw new Error((0,u.localize)(18,null,this.resourceForError(a)));break}catch(r){if((0,d.toFileSystemProviderErrorCode)(r)!==d.FileSystemProviderErrorCode.FileNotFound)throw r;e.push(i.basename(a)),a=i.dirname(a)}for(let r=e.length-1;r>=0;r--){a=i.joinPath(a,e[r]);try{await s.mkdir(a)}catch(n){if((0,d.toFileSystemProviderErrorCode)(n)!==d.FileSystemProviderErrorCode.FileExists)throw n}}}async canDelete(s,a){try{await this.doValidateDelete(s,a)}catch(e){return e}return!0}async doValidateDelete(s,a){const e=this.throwIfFileSystemIsReadonly(await this.withProvider(s),s);if(!!a?.useTrash&&!(e.capabilities&4096))throw new Error((0,u.localize)(19,null,this.resourceForError(s)));let r;try{r=await e.stat(s)}catch(o){}if(r)this.throwIfFileIsReadonly(s,r);else throw new d.FileOperationError((0,u.localize)(20,null,this.resourceForError(s)),1);if(!!!a?.recursive){const o=await this.resolve(s);if(o.isDirectory&&Array.isArray(o.children)&&o.children.length>0)throw new Error((0,u.localize)(21,null,this.resourceForError(s)))}return e}async del(s,a){const e=await this.doValidateDelete(s,a),i=!!a?.useTrash,r=!!a?.recursive;await e.delete(s,{recursive:r,useTrash:i}),this._onDidRunOperation.fire(new d.FileOperationEvent(s,1))}onDidChangeFile(s,a){this._onDidChangeFilesRaw.fire({changes:s});let e,i;{for(const r of s)this.watchedResources.has(r.resource)?(e||(e=[]),e.push(r)):(i||(i=[]),i.push(r));e&&this._onDidFilesChange.fire(new d.FileChangesEvent(e,!a))}if(i){const r=a?this.caseSensitiveFileEventsWorker:this.caseInsensitiveFileEventsWorker;!r.work(i)&&xe.FILE_EVENTS_THROTTLING.warningscounter++<10&&this.logService.warn(`[File watcher]: started ignoring events due to too many file change events at once (incoming: ${i.length}, most recent change: ${i[0].resource.toString()}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`),r.pending>0&&this.logService.trace(`[File watcher]: started throttling events due to large amount of file change events at once (pending: ${r.pending}, most recent change: ${i[0].resource.toString()}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`)}}watch(s,a={recursive:!1,excludes:[]}){const e=new c.DisposableStore;let i=!1,r=()=>{i=!0};return e.add((0,c.toDisposable)(()=>r())),this.doWatch(s,a).then(n=>{i?(0,c.dispose)(n):r=()=>(0,c.dispose)(n)},n=>this.logService.error(n)),a.recursive||(this.watchedResources.set(s,(this.watchedResources.get(s)??0)+1),e.add((0,c.toDisposable)(()=>{const n=this.watchedResources.get(s);typeof n=="number"&&(n<=1?this.watchedResources.delete(s):this.watchedResources.set(s,n-1))}))),e}async doWatch(s,a){const e=await this.withProvider(s),i=this.toWatchKey(e,s,a);let r=this.activeWatchers.get(i);return r||(r={count:0,disposable:e.watch(s,a)},this.activeWatchers.set(i,r)),r.count+=1,(0,c.toDisposable)(()=>{r&&(r.count--,r.count===0&&((0,c.dispose)(r.disposable),this.activeWatchers.delete(i)))})}toWatchKey(s,a,e){const{providerExtUri:i}=this.getExtUri(s);return[i.getComparisonKey(a),String(e.recursive),e.excludes.join()].join()}dispose(){super.dispose();for(const[,s]of this.activeWatchers)(0,c.dispose)(s.disposable);this.activeWatchers.clear()}async doWriteBuffered(s,a,e,i){return this.writeQueue.queueFor(a,this.getExtUri(s).providerExtUri).queue(async()=>{const r=await s.open(a,{create:!0,unlock:e?.unlock??!1});try{(0,S.isReadableStream)(i)||(0,S.isReadableBufferedStream)(i)?await this.doWriteStreamBufferedQueued(s,r,i):await this.doWriteReadableBufferedQueued(s,r,i)}catch(n){throw(0,d.ensureFileSystemProviderError)(n)}finally{await s.close(r)}})}async doWriteStreamBufferedQueued(s,a,e){let i=0,r;if((0,S.isReadableBufferedStream)(e)){if(e.buffer.length>0){const n=b.VSBuffer.concat(e.buffer);await this.doWriteBuffer(s,a,n,n.byteLength,i,0),i+=n.byteLength}if(e.ended)return;r=e.stream}else r=e;return new Promise((n,o)=>{(0,S.listenStream)(r,{onData:async h=>{r.pause();try{await this.doWriteBuffer(s,a,h,h.byteLength,i,0)}catch(E){return o(E)}i+=h.byteLength,setTimeout(()=>r.resume())},onError:h=>o(h),onEnd:()=>n()})})}async doWriteReadableBufferedQueued(s,a,e){let i=0,r;for(;(r=e.read())!==null;)await this.doWriteBuffer(s,a,r,r.byteLength,i,0),i+=r.byteLength}async doWriteBuffer(s,a,e,i,r,n){let o=0;for(;o<i;)o+=await s.write(a,r+o,e.buffer,n+o,i-o)}async doWriteUnbuffered(s,a,e,i){return this.writeQueue.queueFor(a,this.getExtUri(s).providerExtUri).queue(()=>this.doWriteUnbufferedQueued(s,a,e,i))}async doWriteUnbufferedQueued(s,a,e,i){let r;i instanceof b.VSBuffer?r=i:(0,S.isReadableStream)(i)?r=await(0,b.streamToBuffer)(i):(0,S.isReadableBufferedStream)(i)?r=await(0,b.bufferedStreamToBuffer)(i):r=(0,b.readableToBuffer)(i),await s.writeFile(a,r.buffer,{create:!0,overwrite:!0,unlock:e?.unlock??!1})}async doPipeBuffered(s,a,e,i){return this.writeQueue.queueFor(i,this.getExtUri(e).providerExtUri).queue(()=>this.doPipeBufferedQueued(s,a,e,i))}async doPipeBufferedQueued(s,a,e,i){let r,n;try{r=await s.open(a,{create:!1}),n=await e.open(i,{create:!0,unlock:!1});const o=b.VSBuffer.alloc(this.BUFFER_SIZE);let h=0,E=0,R=0;do R=await s.read(r,h,o.buffer,E,o.byteLength-E),await this.doWriteBuffer(e,n,o,R,h,E),h+=R,E+=R,E===o.byteLength&&(E=0);while(R>0)}catch(o){throw(0,d.ensureFileSystemProviderError)(o)}finally{await I.Promises.settled([typeof r=="number"?s.close(r):Promise.resolve(),typeof n=="number"?e.close(n):Promise.resolve()])}}async doPipeUnbuffered(s,a,e,i){return this.writeQueue.queueFor(i,this.getExtUri(e).providerExtUri).queue(()=>this.doPipeUnbufferedQueued(s,a,e,i))}async doPipeUnbufferedQueued(s,a,e,i){return e.writeFile(i,await s.readFile(a),{create:!0,overwrite:!0,unlock:!1})}async doPipeUnbufferedToBuffered(s,a,e,i){return this.writeQueue.queueFor(i,this.getExtUri(e).providerExtUri).queue(()=>this.doPipeUnbufferedToBufferedQueued(s,a,e,i))}async doPipeUnbufferedToBufferedQueued(s,a,e,i){const r=await e.open(i,{create:!0,unlock:!1});try{const n=await s.readFile(a);await this.doWriteBuffer(e,r,b.VSBuffer.wrap(n),n.byteLength,0,0)}catch(n){throw(0,d.ensureFileSystemProviderError)(n)}finally{await e.close(r)}}async doPipeBufferedToUnbuffered(s,a,e,i){const r=await(0,b.streamToBuffer)(this.readFileBuffered(s,a,P.CancellationToken.None));await this.doWriteUnbuffered(e,i,void 0,r)}throwIfFileSystemIsReadonly(s,a){if(s.capabilities&2048)throw new d.FileOperationError((0,u.localize)(22,null,this.resourceForError(a)),6);return s}throwIfFileIsReadonly(s,a){if((a.permissions??0)&d.FilePermission.Readonly)throw new d.FileOperationError((0,u.localize)(23,null,this.resourceForError(s)),6)}resourceForError(s){return s.scheme===w.Schemas.file?s.fsPath:s.toString(!0)}};y.FILE_EVENTS_THROTTLING={maxChangesChunkSize:500,maxChangesBufferSize:3e4,coolDownDelay:200,warningscounter:0},y=de([ae(0,g.ILogService)],y),t.FileService=y}),define(Y[102],Q([0,1,16,14]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpdLogLogger=t.createRotatingLogger=void 0;async function b(c,m,w,C){try{const f=await new Promise((S,u)=>{z(["spdlog"],S,u)});return f.setFlushOn(I.LogLevel.Trace),f.createAsyncRotatingLogger(c,m,w,C)}catch(f){console.error(f)}return null}function P(c,m,w,C){const f=z.__$__nodeRequire("spdlog");return f.setFlushOn(I.LogLevel.Trace),f.createRotatingLogger(c,m,w,C)}t.createRotatingLogger=P;function D(c,m,w){switch(m){case I.LogLevel.Trace:c.trace(w);break;case I.LogLevel.Debug:c.debug(w);break;case I.LogLevel.Info:c.info(w);break;case I.LogLevel.Warning:c.warn(w);break;case I.LogLevel.Error:c.error(w);break;case I.LogLevel.Critical:c.critical(w);break;default:throw new Error("Invalid log level")}}class T extends I.AbstractMessageLogger{constructor(m,w,C,f){super();this.name=m,this.filepath=w,this.rotating=C,this.buffer=[],this.setLevel(f),this._loggerCreationPromise=this._createSpdLogLogger(),this._register(this.onDidChangeLogLevel(S=>{this._logger&&this._logger.setLevel(S)}))}_createSpdLogLogger(){const m=this.rotating?6:1,w=30/m*L.ByteSize.MB;return b(this.name,this.filepath,w,m).then(C=>{if(C){this._logger=C,this._logger.setLevel(this.getLevel());for(const{level:f,message:S}of this.buffer)D(this._logger,f,S);this.buffer=[]}})}log(m,w){this._logger?D(this._logger,m,w):this.getLevel()<=m&&this.buffer.push({level:m,message:w})}clearFormatters(){this._logger?this._logger.clearFormatters():this._loggerCreationPromise.then(()=>this.clearFormatters())}flush(){this._logger?this._logger.flush():this._loggerCreationPromise.then(()=>this.flush())}dispose(){this._logger?this.disposeLogger():this._loggerCreationPromise.then(()=>this.disposeLogger())}disposeLogger(){this._logger&&(this._logger.drop(),this._logger=void 0)}}t.SpdLogLogger=T}),define(Y[103],Q([0,1,47,133,3,17,10,46,7,12,19,38,13,83,16,52,92,93,94,95,55,98,28]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d,p,g,y,l,s,a,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiskFileSystemProvider=void 0,(()=>{try{(0,I.gracefulify)(L)}catch(r){console.error(`Error enabling graceful-fs: ${(0,e.toErrorMessage)(r)}`)}})();class i extends a.AbstractDiskFileSystemProvider{constructor(n,o){super(n);this.options=o,this.onDidChangeCapabilities=D.Event.None,this.mapHandleToPos=new Map,this.writeHandles=new Map,this.canFlush=!0}get capabilities(){return this._capabilities||(this._capabilities=2|4|16|8|8192,m.isLinux&&(this._capabilities|=1024)),this._capabilities}async stat(n){try{const{stat:o,symbolicLink:h}=await f.SymlinkSupport.stat(this.toFilePath(n));return{type:this.toType(o,h),ctime:o.birthtime.getTime(),mtime:o.mtime.getTime(),size:o.size}}catch(o){throw this.toFileSystemProviderError(o)}}async readdir(n){try{const o=await f.Promises.readdir(this.toFilePath(n),{withFileTypes:!0}),h=[];return await Promise.all(o.map(async E=>{try{let R;E.isSymbolicLink()?R=(await this.stat((0,w.joinPath)(n,E.name))).type:R=this.toType(E),h.push([E.name,R])}catch(R){this.logService.trace(R)}})),h}catch(o){throw this.toFileSystemProviderError(o)}}toType(n,o){let h;return o?.dangling?h=u.FileType.Unknown:n.isFile()?h=u.FileType.File:n.isDirectory()?h=u.FileType.Directory:h=u.FileType.Unknown,o&&(h|=u.FileType.SymbolicLink),h}async readFile(n){try{const o=this.toFilePath(n);return await f.Promises.readFile(o)}catch(o){throw this.toFileSystemProviderError(o)}}readFileStream(n,o,h){const E=(0,C.newWriteableStream)(R=>P.VSBuffer.concat(R.map(v=>P.VSBuffer.wrap(v))).buffer);return(0,d.readFileIntoStream)(this,n,E,R=>R.buffer,{...o,bufferSize:256*1024},h),E}async writeFile(n,o,h){let E;try{const R=this.toFilePath(n);if(!h.create||!h.overwrite){if(await f.Promises.exists(R)){if(!h.overwrite)throw(0,u.createFileSystemProviderError)((0,S.localize)(0,null),u.FileSystemProviderErrorCode.FileExists)}else if(!h.create)throw(0,u.createFileSystemProviderError)((0,S.localize)(1,null),u.FileSystemProviderErrorCode.FileNotFound)}E=await this.open(n,{create:!0,unlock:h.unlock}),await this.write(E,0,o,0,o.byteLength)}catch(R){throw await this.toFileSystemProviderWriteError(n,R)}finally{typeof E=="number"&&await this.close(E)}}async open(n,o){try{const h=this.toFilePath(n);if((0,u.isFileOpenForWriteOptions)(o)&&o.unlock)try{const{stat:v}=await f.SymlinkSupport.stat(h);v.mode&128||await f.Promises.chmod(h,v.mode|128)}catch(v){this.logService.trace(v)}let E;if((0,u.isFileOpenForWriteOptions)(o)){if(m.isWindows)try{await f.Promises.truncate(h,0),E="r+"}catch(v){v.code!=="ENOENT"&&this.logService.trace(v)}E||(E="w")}else E="r";const R=await f.Promises.open(h,E);return this.mapHandleToPos.set(R,0),(0,u.isFileOpenForWriteOptions)(o)&&this.writeHandles.set(R,n),R}catch(h){throw(0,u.isFileOpenForWriteOptions)(o)?await this.toFileSystemProviderWriteError(n,h):this.toFileSystemProviderError(h)}}async close(n){try{if(this.mapHandleToPos.delete(n),this.writeHandles.delete(n)&&this.canFlush)try{await f.Promises.fdatasync(n)}catch(o){this.canFlush=!1,this.logService.error(o)}return await f.Promises.close(n)}catch(o){throw this.toFileSystemProviderError(o)}}async read(n,o,h,E,R){const v=this.normalizePos(n,o);let O=null;try{const A=await f.Promises.read(n,h,E,R,v);return typeof A=="number"?O=A:O=A.bytesRead,O}catch(A){throw this.toFileSystemProviderError(A)}finally{this.updatePos(n,v,O)}}normalizePos(n,o){return o===this.mapHandleToPos.get(n)?null:o}updatePos(n,o,h){const E=this.mapHandleToPos.get(n);typeof E=="number"&&(typeof o=="number"||(typeof h=="number"?this.mapHandleToPos.set(n,E+h):this.mapHandleToPos.delete(n)))}async write(n,o,h,E,R){return(0,b.retry)(()=>this.doWrite(n,o,h,E,R),100,3)}async doWrite(n,o,h,E,R){const v=this.normalizePos(n,o);let O=null;try{const A=await f.Promises.write(n,h,E,R,v);return typeof A=="number"?O=A:O=A.bytesWritten,O}catch(A){throw await this.toFileSystemProviderWriteError(this.writeHandles.get(n),A)}finally{this.updatePos(n,v,O)}}async mkdir(n){try{await f.Promises.mkdir(this.toFilePath(n))}catch(o){throw this.toFileSystemProviderError(o)}}async delete(n,o){try{const h=this.toFilePath(n);await this.doDelete(h,o)}catch(h){throw this.toFileSystemProviderError(h)}}async doDelete(n,o){o.recursive?await f.Promises.rm(n,f.RimRafMode.MOVE):await f.Promises.unlink(n)}async rename(n,o,h){const E=this.toFilePath(n),R=this.toFilePath(o);if(E!==R)try{await this.validateTargetDeleted(n,o,"move",h.overwrite),await f.Promises.move(E,R)}catch(v){throw(v.code==="EINVAL"||v.code==="EBUSY"||v.code==="ENAMETOOLONG")&&(v=new Error((0,S.localize)(2,null,(0,c.basename)(E),(0,c.basename)((0,c.dirname)(R)),v.toString()))),this.toFileSystemProviderError(v)}}async copy(n,o,h){const E=this.toFilePath(n),R=this.toFilePath(o);if(E!==R)try{await this.validateTargetDeleted(n,o,"copy",h.overwrite),await f.Promises.copy(E,R,{preserveSymlinks:!0})}catch(v){throw(v.code==="EINVAL"||v.code==="EBUSY"||v.code==="ENAMETOOLONG")&&(v=new Error((0,S.localize)(3,null,(0,c.basename)(E),(0,c.basename)((0,c.dirname)(R)),v.toString()))),this.toFileSystemProviderError(v)}}async validateTargetDeleted(n,o,h,E){const R=this.toFilePath(n),v=this.toFilePath(o);let O=!1;if(!!(this.capabilities&1024)||(O=(0,T.isEqual)(R,v,!0)),O&&h==="copy")throw(0,u.createFileSystemProviderError)((0,S.localize)(4,null),u.FileSystemProviderErrorCode.FileExists);if(!O&&await f.Promises.exists(v)){if(!E)throw(0,u.createFileSystemProviderError)((0,S.localize)(5,null),u.FileSystemProviderErrorCode.FileExists);await this.delete(o,{recursive:!0,useTrash:!1})}}createRecursiveWatcher(n,o,h,E){let R,v=!1;return this.options?.watcher?.usePolling?v=!1:this.options?.legacyWatcher==="on"||this.options?.legacyWatcher==="off"?v=this.options.legacyWatcher==="on":s.default.quality==="stable"&&(v=n===1),v?m.isLinux?R=l.FileWatcher:R=g.FileWatcher:R=y.FileWatcher,new R(O=>o(O),O=>h(O),E,this.options?.watcher)}doWatch(n,o){const h=this.options?.watcher?.usePolling;if(h===!0)for(const E of o)E.pollingInterval=this.options?.watcher?.pollingInterval??5e3;else if(Array.isArray(h))for(const E of o)h.includes(E.path)&&(E.pollingInterval=this.options?.watcher?.pollingInterval??5e3);return super.doWatch(n,o)}createNonRecursiveWatcher(n,o,h,E){return new p.FileWatcher(n,R=>o(R),R=>h(R),E)}toFileSystemProviderError(n){if(n instanceof u.FileSystemProviderError)return n;let o;switch(n.code){case"ENOENT":o=u.FileSystemProviderErrorCode.FileNotFound;break;case"EISDIR":o=u.FileSystemProviderErrorCode.FileIsADirectory;break;case"ENOTDIR":o=u.FileSystemProviderErrorCode.FileNotADirectory;break;case"EEXIST":o=u.FileSystemProviderErrorCode.FileExists;break;case"EPERM":case"EACCES":o=u.FileSystemProviderErrorCode.NoPermissions;break;default:o=u.FileSystemProviderErrorCode.Unknown}return(0,u.createFileSystemProviderError)(n,o)}async toFileSystemProviderWriteError(n,o){let h=this.toFileSystemProviderError(o);if(n&&h.code===u.FileSystemProviderErrorCode.NoPermissions)try{const{stat:E}=await f.SymlinkSupport.stat(this.toFilePath(n));E.mode&128||(h=(0,u.createFileSystemProviderError)(o,u.FileSystemProviderErrorCode.FileWriteLocked))}catch(E){this.logService.trace(E)}return h}}t.DiskFileSystemProvider=i}),define(Y[33],Q([0,1,15]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IProductService=void 0,t.IProductService=(0,L.createDecorator)("productService")}),define(Y[25],Q([0,1,56,11]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Registry=void 0;class b{constructor(){this.data=new Map}add(D,T){L.ok(I.isString(D)),L.ok(I.isObject(T)),L.ok(!this.data.has(D),"There is already an extension with this id"),this.data.set(D,T)}knows(D){return this.data.has(D)}as(D){return this.data.get(D)||null}}t.Registry=new b}),define(Y[104],Q([0,1,10,25]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Extensions=void 0,t.Extensions={JSONContribution:"base.contributions.json"};function b(T){return T.length>0&&T.charAt(T.length-1)==="#"?T.substring(0,T.length-1):T}class P{constructor(){this._onDidChangeSchema=new L.Emitter,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(c,m){this.schemasById[b(c)]=m,this._onDidChangeSchema.fire(c)}notifySchemaChanged(c){this._onDidChangeSchema.fire(c)}getSchemaContributions(){return{schemas:this.schemasById}}}const D=new P;I.Registry.add(t.Extensions.JSONContribution,D)}),define(Y[34],Q([0,1,20,10,11,72,104,25]),function(z,t,L,I,b,P,D,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScopes=t.validateProperty=t.getDefaultValue=t.overrideIdentifierFromKey=t.OVERRIDE_PROPERTY_PATTERN=t.resourceLanguageSettingsSchemaId=t.resourceSettings=t.windowSettings=t.machineOverridableSettings=t.machineSettings=t.applicationSettings=t.allSettings=t.ConfigurationScope=t.Extensions=t.EditPresentationTypes=void 0;var c;(function(y){y.Multiline="multilineText",y.Singleline="singlelineText"})(c=t.EditPresentationTypes||(t.EditPresentationTypes={})),t.Extensions={Configuration:"base.contributions.configuration"};var m;(function(y){y[y.APPLICATION=1]="APPLICATION",y[y.MACHINE=2]="MACHINE",y[y.WINDOW=3]="WINDOW",y[y.RESOURCE=4]="RESOURCE",y[y.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",y[y.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"})(m=t.ConfigurationScope||(t.ConfigurationScope={})),t.allSettings={properties:{},patternProperties:{}},t.applicationSettings={properties:{},patternProperties:{}},t.machineSettings={properties:{},patternProperties:{}},t.machineOverridableSettings={properties:{},patternProperties:{}},t.windowSettings={properties:{},patternProperties:{}},t.resourceSettings={properties:{},patternProperties:{}},t.resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage";const w=T.Registry.as(D.Extensions.JSONContribution);class C{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new I.Emitter,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new I.Emitter,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.defaultValues={},this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:P.localize(0,null),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},w.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema)}registerConfiguration(l,s=!0){this.registerConfigurations([l],s)}registerConfigurations(l,s=!0){const a=this.doRegisterConfigurations(l,s);w.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(a)}deregisterConfigurations(l){const s=this.doDeregisterConfigurations(l);w.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(s)}updateConfigurations({add:l,remove:s}){const a=[];a.push(...this.doDeregisterConfigurations(s)),a.push(...this.doRegisterConfigurations(l,!1)),w.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire((0,L.distinct)(a))}registerDefaultConfigurations(l){const s=[],a=[];for(const e of l)for(const i in e)if(s.push(i),t.OVERRIDE_PROPERTY_PATTERN.test(i)){this.defaultValues[i]={...this.defaultValues[i]||{},...e[i]};const r={type:"object",default:this.defaultValues[i],description:P.localize(1,null,i),$ref:t.resourceLanguageSettingsSchemaId};a.push(S(i)),this.configurationProperties[i]=r,this.defaultLanguageConfigurationOverridesNode.properties[i]=r}else{this.defaultValues[i]=e[i];const r=this.configurationProperties[i];r&&(this.updatePropertyDefaultValue(i,r),this.updateSchema(i,r))}this.registerOverrideIdentifiers(a),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(s)}deregisterDefaultConfigurations(l){const s=[];for(const a of l)for(const e in a)if(s.push(e),delete this.defaultValues[e],t.OVERRIDE_PROPERTY_PATTERN.test(e))delete this.configurationProperties[e],delete this.defaultLanguageConfigurationOverridesNode.properties[e];else{const i=this.configurationProperties[e];i&&(this.updatePropertyDefaultValue(e,i),this.updateSchema(e,i))}this.updateOverridePropertyPatternKey(),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(s)}notifyConfigurationSchemaUpdated(...l){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(l){for(const s of l)this.overrideIdentifiers.add(s);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(l,s){const a=[];return l.forEach(e=>{a.push(...this.validateAndRegisterProperties(e,s,e.extensionInfo)),this.configurationContributors.push(e),this.registerJSONConfiguration(e)}),a}doDeregisterConfigurations(l){const s=[],a=e=>{if(e.properties)for(const i in e.properties)s.push(i),delete this.configurationProperties[i],this.removeFromSchema(i,e.properties[i]);e.allOf&&e.allOf.forEach(i=>a(i))};for(const e of l){a(e);const i=this.configurationContributors.indexOf(e);i!==-1&&this.configurationContributors.splice(i,1)}return s}validateAndRegisterProperties(l,s=!0,a,e=3){e=b.isUndefinedOrNull(l.scope)?e:l.scope;let i=[],r=l.properties;if(r)for(let o in r){if(s&&p(o)){delete r[o];continue}const h=r[o];if(this.updatePropertyDefaultValue(o,h),t.OVERRIDE_PROPERTY_PATTERN.test(o)?h.scope=void 0:(h.scope=b.isUndefinedOrNull(h.scope)?e:h.scope,h.restricted=b.isUndefinedOrNull(h.restricted)?!!a?.restrictedConfigurations?.includes(o):h.restricted),r[o].hasOwnProperty("included")&&!r[o].included){this.excludedConfigurationProperties[o]=r[o],delete r[o];continue}else this.configurationProperties[o]=r[o];!r[o].deprecationMessage&&r[o].markdownDeprecationMessage&&(r[o].deprecationMessage=r[o].markdownDeprecationMessage),i.push(o)}let n=l.allOf;if(n)for(let o of n)i.push(...this.validateAndRegisterProperties(o,s,a,e));return i}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}registerJSONConfiguration(l){const s=a=>{let e=a.properties;if(e)for(const r in e)this.updateSchema(r,e[r]);let i=a.allOf;i&&i.forEach(s)};s(l)}updateSchema(l,s){switch(t.allSettings.properties[l]=s,s.scope){case 1:t.applicationSettings.properties[l]=s;break;case 2:t.machineSettings.properties[l]=s;break;case 6:t.machineOverridableSettings.properties[l]=s;break;case 3:t.windowSettings.properties[l]=s;break;case 4:t.resourceSettings.properties[l]=s;break;case 5:t.resourceSettings.properties[l]=s,this.resourceLanguageSettingsSchema.properties[l]=s;break}}removeFromSchema(l,s){switch(delete t.allSettings.properties[l],s.scope){case 1:delete t.applicationSettings.properties[l];break;case 2:delete t.machineSettings.properties[l];break;case 6:delete t.machineOverridableSettings.properties[l];break;case 3:delete t.windowSettings.properties[l];break;case 4:case 5:delete t.resourceSettings.properties[l];break}}updateOverridePropertyPatternKey(){for(const l of this.overrideIdentifiers.values()){const s=`[${l}]`,a={type:"object",description:P.localize(2,null),errorMessage:P.localize(3,null),$ref:t.resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(s,a),t.allSettings.properties[s]=a,t.applicationSettings.properties[s]=a,t.machineSettings.properties[s]=a,t.machineOverridableSettings.properties[s]=a,t.windowSettings.properties[s]=a,t.resourceSettings.properties[s]=a}this._onDidSchemaChange.fire()}updatePropertyDefaultValue(l,s){let a=this.defaultValues[l];b.isUndefined(a)&&(a=s.default),b.isUndefined(a)&&(a=u(s.type)),s.default=a}}const f="\\[.*\\]$";t.OVERRIDE_PROPERTY_PATTERN=new RegExp(f);function S(y){return y.substring(1,y.length-1)}t.overrideIdentifierFromKey=S;function u(y){switch(Array.isArray(y)?y[0]:y){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}t.getDefaultValue=u;const d=new C;T.Registry.add(t.Extensions.Configuration,d);function p(y){return y.trim()?t.OVERRIDE_PROPERTY_PATTERN.test(y)?P.localize(5,null,y):d.getConfigurationProperties()[y]!==void 0?P.localize(6,null,y):null:P.localize(4,null)}t.validateProperty=p;function g(){const y=[],l=d.getConfigurationProperties();for(const s of Object.keys(l))y.push([s,l[s].scope]);return y.push(["launch",4]),y.push(["task",4]),y}t.getScopes=g}),define(Y[26],Q([0,1,18,11,9,34,15,25]),function(z,t,L,I,b,P,D,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMigratedSettingValue=t.keyFromOverrideIdentifier=t.getDefaultValues=t.getConfigurationKeys=t.merge=t.getConfigurationValue=t.removeFromValueTree=t.addToValueTree=t.toValuesTree=t.toOverrides=t.compare=t.ConfigurationTargetToString=t.ConfigurationTarget=t.isConfigurationOverrides=t.IConfigurationService=void 0,t.IConfigurationService=(0,D.createDecorator)("configurationService");function c(i){return i&&typeof i=="object"&&(!i.overrideIdentifier||typeof i.overrideIdentifier=="string")&&(!i.resource||i.resource instanceof b.URI)}t.isConfigurationOverrides=c;var m;(function(i){i[i.USER=1]="USER",i[i.USER_LOCAL=2]="USER_LOCAL",i[i.USER_REMOTE=3]="USER_REMOTE",i[i.WORKSPACE=4]="WORKSPACE",i[i.WORKSPACE_FOLDER=5]="WORKSPACE_FOLDER",i[i.DEFAULT=6]="DEFAULT",i[i.MEMORY=7]="MEMORY"})(m=t.ConfigurationTarget||(t.ConfigurationTarget={}));function w(i){switch(i){case 1:return"USER";case 2:return"USER_LOCAL";case 3:return"USER_REMOTE";case 4:return"WORKSPACE";case 5:return"WORKSPACE_FOLDER";case 6:return"DEFAULT";case 7:return"MEMORY"}}t.ConfigurationTargetToString=w;function C(i,r){const n=r?i?r.keys.filter(A=>i.keys.indexOf(A)===-1):[...r.keys]:[],o=i?r?i.keys.filter(A=>r.keys.indexOf(A)===-1):[...i.keys]:[],h=[];if(r&&i){for(const A of i.keys)if(r.keys.indexOf(A)!==-1){const G=g(i.contents,A),te=g(r.contents,A);L.equals(G,te)||h.push(A)}}const E=[],R=A=>{const G={};for(const te of A)for(const ue of te.identifiers)G[a(ue)]=te;return G},v=r?R(r.overrides):{},O=i?R(i.overrides):{};if(Object.keys(v).length)for(const A of n){const G=v[A];G&&E.push([(0,P.overrideIdentifierFromKey)(A),G.keys])}if(Object.keys(O).length)for(const A of o){const G=O[A];G&&E.push([(0,P.overrideIdentifierFromKey)(A),G.keys])}if(Object.keys(v).length&&Object.keys(O).length)for(const A of h){const G=O[A],te=v[A];if(G&&te){const ue=C({contents:G.contents,keys:G.keys,overrides:[]},{contents:te.contents,keys:te.keys,overrides:[]});E.push([(0,P.overrideIdentifierFromKey)(A),[...ue.added,...ue.removed,...ue.updated]])}}return{added:n,removed:o,updated:h,overrides:E}}t.compare=C;function f(i,r){const n=[];for(const o of Object.keys(i))if(P.OVERRIDE_PROPERTY_PATTERN.test(o)){const h={};for(const E in i[o])h[E]=i[o][E];n.push({identifiers:[(0,P.overrideIdentifierFromKey)(o).trim()],keys:Object.keys(h),contents:S(h,r)})}return n}t.toOverrides=f;function S(i,r){const n=Object.create(null);for(let o in i)u(n,o,i[o],r);return n}t.toValuesTree=S;function u(i,r,n,o){const h=r.split("."),E=h.pop();let R=i;for(let v=0;v<h.length;v++){let O=h[v],A=R[O];switch(typeof A){case"undefined":A=R[O]=Object.create(null);break;case"object":break;default:o(`Ignoring ${r} as ${h.slice(0,v+1).join(".")} is ${JSON.stringify(A)}`);return}R=A}if(typeof R=="object"&&R!==null)try{R[E]=n}catch(v){o(`Ignoring ${r} as ${h.join(".")} is ${JSON.stringify(R)}`)}else o(`Ignoring ${r} as ${h.join(".")} is ${JSON.stringify(R)}`)}t.addToValueTree=u;function d(i,r){const n=r.split(".");p(i,n)}t.removeFromValueTree=d;function p(i,r){const n=r.shift();if(r.length===0){delete i[n];return}if(Object.keys(i).indexOf(n)!==-1){const o=i[n];typeof o=="object"&&!Array.isArray(o)&&(p(o,r),Object.keys(o).length===0&&delete i[n])}}function g(i,r,n){function o(R,v){let O=R;for(const A of v){if(typeof O!="object"||O===null)return;O=O[A]}return O}const h=r.split("."),E=o(i,h);return typeof E=="undefined"?n:E}t.getConfigurationValue=g;function y(i,r,n){Object.keys(r).forEach(o=>{o!=="__proto__"&&(o in i?I.isObject(i[o])&&I.isObject(r[o])?y(i[o],r[o],n):n&&(i[o]=r[o]):i[o]=r[o])})}t.merge=y;function l(){const i=T.Registry.as(P.Extensions.Configuration).getConfigurationProperties();return Object.keys(i)}t.getConfigurationKeys=l;function s(){const i=Object.create(null),r=T.Registry.as(P.Extensions.Configuration).getConfigurationProperties();for(let n in r){let o=r[n].default;u(i,n,o,h=>console.error(`Conflict in default settings: ${h}`))}return i}t.getDefaultValues=s;function a(i){return`[${i}]`}t.keyFromOverrideIdentifier=a;function e(i,r,n){const o=i.inspect(r),h=i.inspect(n);return typeof o.userValue!="undefined"||typeof o.workspaceValue!="undefined"||typeof o.workspaceFolderValue!="undefined"?o.value:typeof h.userValue!="undefined"||typeof h.workspaceValue!="undefined"||typeof h.workspaceFolderValue!="undefined"?h.value:o.defaultValue}t.getMigratedSettingValue=e}),define(Y[105],Q([0,1,20,10,57,2,100,18,11,9,26,34,25]),function(z,t,L,I,b,P,D,T,c,m,w,C,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllKeysConfigurationChangeEvent=t.ConfigurationChangeEvent=t.mergeChanges=t.Configuration=t.UserSettings=t.ConfigurationModelParser=t.DefaultConfigurationModel=t.ConfigurationModel=void 0;class S{constructor(e={},i=[],r=[]){this._contents=e,this._keys=i,this._overrides=r,this.isFrozen=!1,this.overrideConfigurations=new Map}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?(0,w.getConfigurationValue)(this.contents,e):this.contents}getOverrideValue(e,i){const r=this.getContentsForOverrideIdentifer(i);return r?e?(0,w.getConfigurationValue)(r,e):r:void 0}getKeysForOverrideIdentifier(e){for(const i of this.overrides)if(i.identifiers.indexOf(e)!==-1)return i.keys;return[]}override(e){let i=this.overrideConfigurations.get(e);return i||(i=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,i)),i}merge(...e){const i=T.deepClone(this.contents),r=T.deepClone(this.overrides),n=[...this.keys];for(const o of e){this.mergeContents(i,o.contents);for(const h of o.overrides){const[E]=r.filter(R=>L.equals(R.identifiers,h.identifiers));E?this.mergeContents(E.contents,h.contents):r.push(T.deepClone(h))}for(const h of o.keys)n.indexOf(h)===-1&&n.push(h)}return new S(i,n,r)}freeze(){return this.isFrozen=!0,this}createOverrideConfigurationModel(e){const i=this.getContentsForOverrideIdentifer(e);if(!i||typeof i!="object"||!Object.keys(i).length)return this;let r={};for(const n of L.distinct([...Object.keys(this.contents),...Object.keys(i)])){let o=this.contents[n],h=i[n];h&&(typeof o=="object"&&typeof h=="object"?(o=T.deepClone(o),this.mergeContents(o,h)):o=h),r[n]=o}return new S(r,this.keys,this.overrides)}mergeContents(e,i){for(const r of Object.keys(i)){if(r in e&&c.isObject(e[r])&&c.isObject(i[r])){this.mergeContents(e[r],i[r]);continue}e[r]=T.deepClone(i[r])}}checkAndFreeze(e){return this.isFrozen&&!Object.isFrozen(e)?T.deepFreeze(e):e}getContentsForOverrideIdentifer(e){for(const i of this.overrides)if(i.identifiers.indexOf(e)!==-1)return i.contents;return null}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,i){this.addKey(e),(0,w.addToValueTree)(this.contents,e,i,r=>{throw new Error(r)})}removeValue(e){this.removeKey(e)&&(0,w.removeFromValueTree)(this.contents,e)}addKey(e){let i=this.keys.length;for(let r=0;r<i;r++)e.indexOf(this.keys[r])===0&&(i=r);this.keys.splice(i,1,e)}removeKey(e){let i=this.keys.indexOf(e);return i!==-1?(this.keys.splice(i,1),!0):!1}}t.ConfigurationModel=S;class u extends S{constructor(){const e=(0,w.getDefaultValues)(),i=(0,w.getConfigurationKeys)(),r=[];for(const n of Object.keys(e))C.OVERRIDE_PROPERTY_PATTERN.test(n)&&r.push({identifiers:[(0,C.overrideIdentifierFromKey)(n).trim()],keys:Object.keys(e[n]),contents:(0,w.toValuesTree)(e[n],o=>console.error(`Conflict in default settings file: ${o}`))});super(e,i,r)}}t.DefaultConfigurationModel=u;class d{constructor(e){this._name=e,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||new S}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,i){if(!c.isUndefinedOrNull(e)){const r=this.doParseContent(e);this.parseRaw(r,i)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,i){this._raw=e;const{contents:r,keys:n,overrides:o,restricted:h}=this.doParseRaw(e,i);this._configurationModel=new S(r,n,o),this._restrictedConfigurations=h||[]}doParseContent(e){let i={},r=null,n=[],o=[],h=[];function E(v){Array.isArray(n)?n.push(v):r!==null&&(n[r]=v)}let R={onObjectBegin:()=>{let v={};E(v),o.push(n),n=v,r=null},onObjectProperty:v=>{r=v},onObjectEnd:()=>{n=o.pop()},onArrayBegin:()=>{let v=[];E(v),o.push(n),n=v,r=null},onArrayEnd:()=>{n=o.pop()},onLiteralValue:E,onError:(v,O,A)=>{h.push({error:v,offset:O,length:A})}};if(e)try{b.visit(e,R),i=n[0]||{}}catch(v){console.error(`Error while parsing settings file ${this._name}: ${v}`),this._parseErrors=[v]}return i}doParseRaw(e,i){const r=f.Registry.as(C.Extensions.Configuration).getConfigurationProperties(),n=this.filter(e,r,!0,i);e=n.raw;const o=(0,w.toValuesTree)(e,R=>console.error(`Conflict in settings file ${this._name}: ${R}`)),h=Object.keys(e),E=(0,w.toOverrides)(e,R=>console.error(`Conflict in settings file ${this._name}: ${R}`));return{contents:o,keys:h,overrides:E,restricted:n.restricted}}filter(e,i,r,n){if(!n?.scopes&&!n?.skipRestricted)return{raw:e,restricted:[]};const o={},h=[];for(let E in e)if(C.OVERRIDE_PROPERTY_PATTERN.test(E)&&r){const R=this.filter(e[E],i,!1,n);o[E]=R.raw,h.push(...R.restricted)}else{const R=i[E],v=R?typeof R.scope!="undefined"?R.scope:3:void 0;R?.restricted&&h.push(E),(v===void 0||n.scopes===void 0||n.scopes.includes(v))&&(n.skipRestricted&&R?.restricted||(o[E]=e[E]))}return{raw:o,restricted:h}}}t.ConfigurationModelParser=d;class p extends P.Disposable{constructor(e,i,r,n){super();this.userSettingsResource=e,this.scopes=i,this.fileService=n,this._onDidChange=this._register(new I.Emitter),this.onDidChange=this._onDidChange.event,this.parser=new d(this.userSettingsResource.toString()),this.parseOptions={scopes:this.scopes},this._register(this.fileService.watch(r.dirname(this.userSettingsResource))),this._register(this.fileService.watch(this.userSettingsResource)),this._register(I.Event.filter(this.fileService.onDidFilesChange,o=>o.contains(this.userSettingsResource))(()=>this._onDidChange.fire()))}async loadConfiguration(){try{const e=await this.fileService.readFile(this.userSettingsResource);return this.parser.parse(e.value.toString()||"{}",this.parseOptions),this.parser.configurationModel}catch(e){return new S}}reparse(){return this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}}t.UserSettings=p;class g{constructor(e,i,r=new S,n=new S,o=new D.ResourceMap,h=new S,E=new D.ResourceMap,R=!0){this._defaultConfiguration=e,this._localUserConfiguration=i,this._remoteUserConfiguration=r,this._workspaceConfiguration=n,this._folderConfigurations=o,this._memoryConfiguration=h,this._memoryConfigurationByResource=E,this._freeze=R,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new D.ResourceMap,this._userConfiguration=null}getValue(e,i,r){return this.getConsolidateConfigurationModel(i,r).getValue(e)}updateValue(e,i,r={}){let n;r.resource?(n=this._memoryConfigurationByResource.get(r.resource),n||(n=new S,this._memoryConfigurationByResource.set(r.resource,n))):n=this._memoryConfiguration,i===void 0?n.removeValue(e):n.setValue(e,i),r.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,i,r){const n=this.getConsolidateConfigurationModel(i,r),o=this.getFolderConfigurationModelForResource(i.resource,r),h=i.resource?this._memoryConfigurationByResource.get(i.resource)||this._memoryConfiguration:this._memoryConfiguration,E=i.overrideIdentifier?this._defaultConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this._defaultConfiguration.freeze().getValue(e),R=i.overrideIdentifier?this.userConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this.userConfiguration.freeze().getValue(e),v=i.overrideIdentifier?this.localUserConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this.localUserConfiguration.freeze().getValue(e),O=i.overrideIdentifier?this.remoteUserConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this.remoteUserConfiguration.freeze().getValue(e),A=r?i.overrideIdentifier?this._workspaceConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this._workspaceConfiguration.freeze().getValue(e):void 0,G=o?i.overrideIdentifier?o.freeze().override(i.overrideIdentifier).getValue(e):o.freeze().getValue(e):void 0,te=i.overrideIdentifier?h.override(i.overrideIdentifier).getValue(e):h.getValue(e),ue=n.getValue(e),ce=L.distinct(L.flatten(n.overrides.map(ne=>ne.identifiers))).filter(ne=>n.getOverrideValue(e,ne)!==void 0);return{defaultValue:E,userValue:R,userLocalValue:v,userRemoteValue:O,workspaceValue:A,workspaceFolderValue:G,memoryValue:te,value:ue,default:E!==void 0?{value:this._defaultConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this._defaultConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,user:R!==void 0?{value:this.userConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this.userConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,userLocal:v!==void 0?{value:this.localUserConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this.localUserConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,userRemote:O!==void 0?{value:this.remoteUserConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this.remoteUserConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,workspace:A!==void 0?{value:this._workspaceConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this._workspaceConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,workspaceFolder:G!==void 0?{value:o?.freeze().getValue(e),override:i.overrideIdentifier?o?.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,memory:te!==void 0?{value:h.getValue(e),override:i.overrideIdentifier?h.getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,overrideIdentifiers:ce.length?ce:void 0}}keys(e){const i=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.freeze().keys,user:this.userConfiguration.freeze().keys,workspace:this._workspaceConfiguration.freeze().keys,workspaceFolder:i?i.freeze().keys:[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,i){this._folderConfigurations.set(e,i),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,i){const r=i.filter(n=>C.OVERRIDE_PROPERTY_PATTERN.test(n)).map(n=>{const o=(0,C.overrideIdentifierFromKey)(n),h=this._defaultConfiguration.getKeysForOverrideIdentifier(o),E=e.getKeysForOverrideIdentifier(o),R=[...E.filter(v=>h.indexOf(v)===-1),...h.filter(v=>E.indexOf(v)===-1),...h.filter(v=>!T.equals(this._defaultConfiguration.override(o).getValue(v),e.override(o).getValue(v)))];return[o,R]});return this.updateDefaultConfiguration(e),{keys:i,overrides:r}}compareAndUpdateLocalUserConfiguration(e){const{added:i,updated:r,removed:n,overrides:o}=(0,w.compare)(this.localUserConfiguration,e),h=[...i,...r,...n];return h.length&&this.updateLocalUserConfiguration(e),{keys:h,overrides:o}}compareAndUpdateRemoteUserConfiguration(e){const{added:i,updated:r,removed:n,overrides:o}=(0,w.compare)(this.remoteUserConfiguration,e);let h=[...i,...r,...n];return h.length&&this.updateRemoteUserConfiguration(e),{keys:h,overrides:o}}compareAndUpdateWorkspaceConfiguration(e){const{added:i,updated:r,removed:n,overrides:o}=(0,w.compare)(this.workspaceConfiguration,e);let h=[...i,...r,...n];return h.length&&this.updateWorkspaceConfiguration(e),{keys:h,overrides:o}}compareAndUpdateFolderConfiguration(e,i){const r=this.folderConfigurations.get(e),{added:n,updated:o,removed:h,overrides:E}=(0,w.compare)(r,i);let R=[...n,...o,...h];return(R.length||!r)&&this.updateFolderConfiguration(e,i),{keys:R,overrides:E}}compareAndDeleteFolderConfiguration(e){const i=this.folderConfigurations.get(e);if(!i)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:r,updated:n,removed:o,overrides:h}=(0,w.compare)(i,void 0);return{keys:[...r,...n,...o],overrides:h}}get defaults(){return this._defaultConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidateConfigurationModel(e,i){let r=this.getConsolidatedConfigurationModelForResource(e,i);return e.overrideIdentifier?r.override(e.overrideIdentifier):r}getConsolidatedConfigurationModelForResource({resource:e},i){let r=this.getWorkspaceConsolidatedConfiguration();if(i&&e){const n=i.getFolder(e);n&&(r=this.getFolderConsolidatedConfiguration(n.uri)||r);const o=this._memoryConfigurationByResource.get(e);o&&(r=r.merge(o))}return r}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let i=this._foldersConsolidatedConfigurations.get(e);if(!i){const r=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(i=r.merge(n),this._freeze&&(i=i.freeze()),this._foldersConsolidatedConfigurations.set(e,i)):i=r}return i}getFolderConfigurationModelForResource(e,i){if(i&&e){const r=i.getFolder(e);if(r)return this._folderConfigurations.get(r.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,i)=>{const{contents:r,overrides:n,keys:o}=this._folderConfigurations.get(i);return e.push([i,{contents:r,overrides:n,keys:o}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.freeze().keys.forEach(i=>e.add(i)),this.userConfiguration.freeze().keys.forEach(i=>e.add(i)),this._workspaceConfiguration.freeze().keys.forEach(i=>e.add(i)),this._folderConfigurations.forEach(i=>i.freeze().keys.forEach(r=>e.add(r))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const i=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(r=>i.add(r)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(r=>i.add(r)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(r=>i.add(r)),this._folderConfigurations.forEach(r=>r.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n))),[...i.values()]}static parse(e){const i=this.parseConfigurationModel(e.defaults),r=this.parseConfigurationModel(e.user),n=this.parseConfigurationModel(e.workspace),o=e.folders.reduce((h,E)=>(h.set(m.URI.revive(E[0]),this.parseConfigurationModel(E[1])),h),new D.ResourceMap);return new g(i,r,new S,n,o,new S,new D.ResourceMap,!1)}static parseConfigurationModel(e){return new S(e.contents,e.keys,e.overrides).freeze()}}t.Configuration=g;function y(...a){if(a.length===0)return{keys:[],overrides:[]};if(a.length===1)return a[0];const e=new Set,i=new Map;for(const n of a)n.keys.forEach(o=>e.add(o)),n.overrides.forEach(([o,h])=>{const E=(0,D.getOrSet)(i,o,new Set);h.forEach(R=>E.add(R))});const r=[];return i.forEach((n,o)=>r.push([o,[...n.values()]])),{keys:[...e.values()],overrides:r}}t.mergeChanges=y;class l{constructor(e,i,r,n){this.change=e,this.previous=i,this.currentConfiguraiton=r,this.currentWorkspace=n,this._previousConfiguration=void 0;const o=new Set;e.keys.forEach(E=>o.add(E)),e.overrides.forEach(([,E])=>E.forEach(R=>o.add(R))),this.affectedKeys=[...o.values()];const h=new S;this.affectedKeys.forEach(E=>h.setValue(E,{})),this.affectedKeysTree=h.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=g.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,i){if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(i){const r=this.previousConfiguration?this.previousConfiguration.getValue(e,i,this.previous?.workspace):void 0,n=this.currentConfiguraiton.getValue(e,i,this.currentWorkspace);return!T.equals(r,n)}return!0}return!1}doesAffectedKeysTreeContains(e,i){let r=(0,w.toValuesTree)({[i]:!0},()=>{}),n;for(;typeof r=="object"&&(n=Object.keys(r)[0]);){if(e=e[n],!e)return!1;r=r[n]}return!0}}t.ConfigurationChangeEvent=l;class s extends l{constructor(e,i,r,n){super({keys:e.allKeys(),overrides:[]},void 0,e,i);this.source=r,this.sourceConfig=n}}t.AllKeysConfigurationChangeEvent=s}),define(Y[106],Q([0,1,3,10,2,19,26,105,34,25]),function(z,t,L,I,b,P,D,T,c,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationService=void 0;class w extends b.Disposable{constructor(f,S){super();this.settingsResource=f,this._onDidChangeConfiguration=this._register(new I.Emitter),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.userConfiguration=this._register(new T.UserSettings(this.settingsResource,void 0,P.extUriBiasedIgnorePathCase,S)),this.configuration=new T.Configuration(new T.DefaultConfigurationModel,new T.ConfigurationModel),this.reloadConfigurationScheduler=this._register(new L.RunOnceScheduler(()=>this.reloadConfiguration(),50)),this._register(m.Registry.as(c.Extensions.Configuration).onDidUpdateConfiguration(u=>this.onDidDefaultConfigurationChange(u))),this._register(this.userConfiguration.onDidChange(()=>this.reloadConfigurationScheduler.schedule()))}async initialize(){const f=await this.userConfiguration.loadConfiguration();this.configuration=new T.Configuration(new T.DefaultConfigurationModel,f)}getConfigurationData(){return this.configuration.toData()}getValue(f,S){const u=typeof f=="string"?f:void 0,d=(0,D.isConfigurationOverrides)(f)?f:(0,D.isConfigurationOverrides)(S)?S:{};return this.configuration.getValue(u,d,void 0)}updateValue(f,S,u,d){return Promise.reject(new Error("not supported"))}inspect(f){return this.configuration.inspect(f,{},void 0)}keys(){return this.configuration.keys(void 0)}async reloadConfiguration(){const f=await this.userConfiguration.loadConfiguration();this.onDidChangeUserConfiguration(f)}onDidChangeUserConfiguration(f){const S=this.configuration.toData(),u=this.configuration.compareAndUpdateLocalUserConfiguration(f);this.trigger(u,S,1)}onDidDefaultConfigurationChange(f){const S=this.configuration.toData(),u=this.configuration.compareAndUpdateDefaultConfiguration(new T.DefaultConfigurationModel,f);this.trigger(u,S,6)}trigger(f,S,u){const d=new T.ConfigurationChangeEvent(f,{data:S},this.configuration);d.source=u,d.sourceConfig=this.getTargetConfiguration(u),this._onDidChangeConfiguration.fire(d)}getTargetConfiguration(f){switch(f){case 6:return this.configuration.defaults.contents;case 1:return this.configuration.localUserConfiguration.contents}return{}}}t.ConfigurationService=w}),define(Y[107],Q([0,1,6]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVirtualWorkspace=t.getVirtualWorkspaceScheme=t.getVirtualWorkspaceLocation=t.isVirtualResource=t.getRemoteName=t.getRemoteAuthority=void 0;function I(m){return m.scheme===L.Schemas.vscodeRemote?m.authority:void 0}t.getRemoteAuthority=I;function b(m){if(!m)return;const w=m.indexOf("+");return w<0?m:m.substr(0,w)}t.getRemoteName=b;function P(m){return m.scheme!==L.Schemas.file&&m.scheme!==L.Schemas.vscodeRemote}t.isVirtualResource=P;function D(m){if(m.folders.length)return m.folders.every(w=>P(w.uri))?m.folders[0].uri:void 0;if(m.configuration&&P(m.configuration))return m.configuration}t.getVirtualWorkspaceLocation=D;function T(m){return D(m)?.scheme}t.getVirtualWorkspaceScheme=T;function c(m){return D(m)!==void 0}t.isVirtualWorkspace=c}),define(Y[41],Q([0,1,27,15,107]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IBuiltinExtensionsScannerService=t.isResolverExtension=t.isAuthenticationProviderExtension=t.isLanguagePackExtension=t.ExtensionIdentifier=t.ExtensionType=t.EXTENSION_CATEGORIES=t.isIExtensionIdentifier=t.getWorkspaceSupportTypeMessage=t.ALL_EXTENSION_KINDS=t.BUILTIN_MANIFEST_CACHE_FILE=t.USER_MANIFEST_CACHE_FILE=t.MANIFEST_CACHE_FOLDER=void 0,t.MANIFEST_CACHE_FOLDER="CachedExtensions",t.USER_MANIFEST_CACHE_FILE="user",t.BUILTIN_MANIFEST_CACHE_FILE="builtin",t.ALL_EXTENSION_KINDS=["ui","workspace","web"];function P(f){if(typeof f=="object"&&f!==null&&f.supported!==!0)return f.description}t.getWorkspaceSupportTypeMessage=P;function D(f){return f&&typeof f=="object"&&typeof f.id=="string"&&(!f.uuid||typeof f.uuid=="string")}t.isIExtensionIdentifier=D,t.EXTENSION_CATEGORIES=["Azure","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var T;(function(f){f[f.System=0]="System",f[f.User=1]="User"})(T=t.ExtensionType||(t.ExtensionType={}));class c{constructor(S){this.value=S,this._lower=S.toLowerCase()}static equals(S,u){if(typeof S=="undefined"||S===null)return typeof u=="undefined"||u===null;if(typeof u=="undefined"||u===null)return!1;if(typeof S=="string"||typeof u=="string"){let d=typeof S=="string"?S:S.value,p=typeof u=="string"?u:u.value;return L.equalsIgnoreCase(d,p)}return S._lower===u._lower}static toKey(S){return typeof S=="string"?S.toLowerCase():S._lower}}t.ExtensionIdentifier=c;function m(f){return f.contributes&&f.contributes.localizations?f.contributes.localizations.length>0:!1}t.isLanguagePackExtension=m;function w(f){return f.contributes&&f.contributes.authentication?f.contributes.authentication.length>0:!1}t.isAuthenticationProviderExtension=w;function C(f,S){if(S&&f.enableProposedApi){const u=`onResolveRemoteAuthority:${(0,b.getRemoteName)(S)}`;return f.activationEvents?.indexOf(u)!==-1}return!1}t.isResolverExtension=C,t.IBuiltinExtensionsScannerService=(0,I.createDecorator)("IBuiltinExtensionsScannerService")}),define(Y[23],Q([0,1,27,41]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionDependencies=t.getMaliciousExtensionsSet=t.BetterMergeId=t.getGalleryExtensionTelemetryData=t.getLocalExtensionTelemetryData=t.groupByExtension=t.getGalleryExtensionId=t.adoptToGalleryExtensionId=t.getExtensionId=t.ExtensionIdentifierWithVersion=t.areSameExtensions=void 0;function b(u,d){return u.uuid&&d.uuid?u.uuid===d.uuid:u.id===d.id?!0:(0,L.compareIgnoreCase)(u.id,d.id)===0}t.areSameExtensions=b;class P{constructor(d,p){this.version=p,this.id=d.id,this.uuid=d.uuid}key(){return`${this.id}-${this.version}`}equals(d){return d instanceof P?b(this,d)&&this.version===d.version:!1}}t.ExtensionIdentifierWithVersion=P;function D(u,d){return`${u}.${d}`}t.getExtensionId=D;function T(u){return u.toLocaleLowerCase()}t.adoptToGalleryExtensionId=T;function c(u,d){return T(D(u,d))}t.getGalleryExtensionId=c;function m(u,d){const p=[],g=y=>{for(const l of p)if(l.some(s=>b(d(s),d(y))))return l;return null};for(const y of u){const l=g(y);l?l.push(y):p.push([y])}return p}t.groupByExtension=m;function w(u){return{id:u.identifier.id,name:u.manifest.name,galleryId:null,publisherId:u.publisherId,publisherName:u.manifest.publisher,publisherDisplayName:u.publisherDisplayName,dependencies:u.manifest.extensionDependencies&&u.manifest.extensionDependencies.length>0}}t.getLocalExtensionTelemetryData=w;function C(u){return{id:u.identifier.id,name:u.name,galleryId:u.identifier.uuid,publisherId:u.publisherId,publisherName:u.publisher,publisherDisplayName:u.publisherDisplayName,dependencies:!!(u.properties.dependencies&&u.properties.dependencies.length>0),...u.telemetryData}}t.getGalleryExtensionTelemetryData=C,t.BetterMergeId=new I.ExtensionIdentifier("pprice.better-merge");function f(u){const d=new Set;for(const p of u)p.malicious&&d.add(p.id.id);return d}t.getMaliciousExtensionsSet=f;function S(u,d){const p=[],g=d.manifest.extensionDependencies?.slice(0)??[];for(;g.length;){const y=g.shift();if(y&&p.every(l=>!b(l.identifier,{id:y}))){const l=u.filter(s=>b(s.identifier,{id:y}));l.length===1&&(p.push(l[0]),g.push(...l[0].manifest.extensionDependencies?.slice(0)??[]))}}return p}t.getExtensionDependencies=S}),define(Y[108],Q([0,1,24,8,61,6,42,9,76,22,23,41]),function(z,t,L,I,b,P,D,T,c,m,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManagementCLIService=t.getIdAndVersion=void 0;const f=y=>(0,c.localize)(0,null,y),S=(0,c.localize)(1,null,"ms-dotnettools.csharp");function u(y,l){return l?`${y.publisher}.${y.name}@${y.version}`:`${y.publisher}.${y.name}`}const d=/^([^.]+\..+)@(\d+\.\d+\.\d+(-.*)?)$/;function p(y){const l=d.exec(y);return l&&l[1]?[(0,w.adoptToGalleryExtensionId)(l[1]),l[2]]:[(0,w.adoptToGalleryExtensionId)(y),void 0]}t.getIdAndVersion=p;let g=class{constructor(l,s){this.extensionManagementService=l,this.extensionGalleryService=s}get location(){}async listExtensions(l,s,a=console){let e=await this.extensionManagementService.getInstalled(1);const i=C.EXTENSION_CATEGORIES.map(n=>n.toLowerCase());if(s&&s!==""){if(i.indexOf(s.toLowerCase())<0){a.log("Invalid category please enter a valid category. To list valid categories run --category without a category specified");return}e=e.filter(n=>n.manifest.categories?n.manifest.categories.map(h=>h.toLowerCase()).indexOf(s.toLowerCase())>-1:!1)}else if(s===""){a.log("Possible Categories: "),i.forEach(n=>{a.log(n)});return}this.location&&a.log((0,c.localize)(2,null,this.location)),e=e.sort((n,o)=>n.identifier.id.localeCompare(o.identifier.id));let r;for(let n of e)r!==n.identifier.id&&(r=n.identifier.id,a.log(u(n.manifest,l)))}async installExtensions(l,s,a,e,i=console){const r=[],n=[];l.length&&i.log(this.location?(0,c.localize)(3,null,this.location):(0,c.localize)(4,null));const o=await this.extensionManagementService.getInstalled(1),h=(v,O)=>{const A=o.find(G=>(0,w.areSameExtensions)(G.identifier,{id:v}));if(A){if(!O&&!e)return i.log((0,c.localize)(5,null,v,A.manifest.version,v)),!1;if(O&&A.manifest.version===O)return i.log((0,c.localize)(6,null,`${v}@${O}`)),!1}return!0},E=[],R=[];for(const v of l)if(v instanceof T.URI)E.push(v);else{const[O,A]=p(v);h(O,A)&&R.push({id:O,version:A,installOptions:{isBuiltin:!1,isMachineScoped:a}})}for(const v of s){const[O,A]=p(v);h(O,A)&&R.push({id:O,version:A,installOptions:{isBuiltin:!0,isMachineScoped:!1}})}if(E.length&&await Promise.all(E.map(async v=>{try{const O=await this.installVSIX(v,{isBuiltin:!1,isMachineScoped:a},e,i);O&&n.push(O)}catch(O){i.error(O.message||O.stack||O),r.push(v.toString())}})),R.length){const v=await this.getGalleryExtensions(R);await Promise.all(R.map(async O=>{const A=v.get(O.id.toLowerCase());if(A)try{const G=await this.installFromGallery(O,A,o,e,i);G&&n.push(G)}catch(G){i.error(G.message||G.stack||G),r.push(O.id)}else i.error(`${f(O.version?`${O.id}@${O.version}`:O.id)}
${S}`),r.push(O.id)}))}if(r.length)throw new Error((0,c.localize)(7,null,r.join(", ")))}async installVSIX(l,s,a,e){const i=await this.extensionManagementService.getManifest(l);if(!i)throw new Error("Invalid vsix");if(await this.validateVSIX(i,a,e))try{return await this.extensionManagementService.install(l,s),e.log((0,c.localize)(8,null,(0,b.getBaseLabel)(l))),i}catch(n){if((0,I.isPromiseCanceledError)(n))return e.log((0,c.localize)(9,null,(0,b.getBaseLabel)(l))),null;throw n}return null}async getGalleryExtensions(l){const s=new Map,a=await this.extensionGalleryService.getExtensions(l,L.CancellationToken.None);for(const e of a)s.set(e.identifier.id.toLowerCase(),e);return s}async installFromGallery({id:l,version:s,installOptions:a},e,i,r,n){const o=await this.extensionGalleryService.getManifest(e,L.CancellationToken.None);if(o&&!this.validateExtensionKind(o,n))return null;const h=i.find(E=>(0,w.areSameExtensions)(E.identifier,e.identifier));if(h){if(e.version===h.manifest.version)return n.log((0,c.localize)(10,null,s?`${l}@${s}`:l)),null;n.log((0,c.localize)(11,null,l,e.version))}try{return a.isBuiltin?n.log(s?(0,c.localize)(12,null,l,s):(0,c.localize)(13,null,l)):n.log(s?(0,c.localize)(14,null,l,s):(0,c.localize)(15,null,l)),await this.extensionManagementService.installFromGallery(e,{...a,installGivenVersion:!!s}),n.log((0,c.localize)(16,null,l,e.version)),o}catch(E){if((0,I.isPromiseCanceledError)(E))return n.log((0,c.localize)(17,null,l)),null;throw E}}validateExtensionKind(l,s){return!0}async validateVSIX(l,s,a){const e={id:(0,w.getGalleryExtensionId)(l.publisher,l.name)},r=(await this.extensionManagementService.getInstalled(1)).find(n=>(0,w.areSameExtensions)(e,n.identifier)&&(0,D.gt)(n.manifest.version,l.version));return r&&!s?(a.log((0,c.localize)(18,null,r.identifier.id,r.manifest.version,l.version)),!1):this.validateExtensionKind(l,a)}async uninstallExtensions(l,s,a=console){const e=async r=>{if(r instanceof T.URI){const n=await this.extensionManagementService.getManifest(r);return u(n)}return r},i=[];for(const r of l){const n=await e(r),h=(await this.extensionManagementService.getInstalled()).filter(E=>(0,w.areSameExtensions)(E.identifier,{id:n}));if(!h.length)throw new Error(`${this.notInstalled(n)}
${S}`);if(h.some(E=>E.type===0)){a.log((0,c.localize)(19,null,n));return}if(!s&&h.some(E=>E.isBuiltin)){a.log((0,c.localize)(20,null,n));return}a.log((0,c.localize)(21,null,n));for(const E of h)await this.extensionManagementService.uninstall(E),i.push(E);this.location?a.log((0,c.localize)(22,null,n,this.location)):a.log((0,c.localize)(23,null,n))}}async locateExtension(l,s=console){const a=await this.extensionManagementService.getInstalled();l.forEach(e=>{a.forEach(i=>{if(i.identifier.id===e&&i.location.scheme===P.Schemas.file){s.log(i.location.fsPath);return}})})}notInstalled(l){return this.location?(0,c.localize)(24,null,l,this.location):(0,c.localize)(25,null,l)}};g=de([ae(0,m.IExtensionManagementService),ae(1,m.IExtensionGalleryService)],g),t.ExtensionManagementCLIService=g}),define(Y[109],Q([0,1,3,8,2,12,19,42,9,31,13,21,22,23,16,14]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsDownloader=void 0;const p=/^([^.]+\..+)-(\d+\.\d+\.\d+)$/;let g=class extends b.Disposable{constructor(l,s,a,e){super();this.fileService=s,this.extensionGalleryService=a,this.logService=e,this.extensionsDownloadDir=c.URI.file(l.extensionsDownloadPath),this.cache=20,this.cleanUpPromise=this.cleanUp()}async downloadExtension(l,s){await this.cleanUpPromise;const a=this.getName(l),e=(0,D.joinPath)(this.extensionsDownloadDir,a);if(!await this.fileService.exists(e)){const i=(0,D.joinPath)(this.extensionsDownloadDir,`.${(0,m.generateUuid)()}`);await this.fileService.exists(i)||await this.extensionGalleryService.download(l,i,s);try{await this.rename(i,e,Date.now()+2*60*1e3)}catch(r){try{await this.fileService.del(i)}catch(n){}if(r.code==="ENOTEMPTY")this.logService.info("Rename failed because vsix was downloaded by another source. So ignoring renaming.",l.identifier.id);else throw this.logService.info(`Rename failed because of ${(0,I.getErrorMessage)(r)}. Deleted the vsix from downloaded location`,i.path),r}}return e}async delete(l){await this.cleanUpPromise,await this.fileService.del(l)}async rename(l,s,a){try{await w.Promises.rename(l.fsPath,s.fsPath)}catch(e){if(P.isWindows&&e&&e.code==="EPERM"&&Date.now()<a)return this.logService.info(`Failed renaming ${l} to ${s} with 'EPERM' error. Trying again...`),this.rename(l,s,a);throw e}}async cleanUp(){try{if(!await this.fileService.exists(this.extensionsDownloadDir)){this.logService.trace("Extension VSIX downlads cache dir does not exist");return}const l=await this.fileService.resolve(this.extensionsDownloadDir,{resolveMetadata:!0});if(l.children){const s=[],a=[];for(const r of l.children){const n=this.parse(r.name);n&&a.push([n,r])}const e=(0,S.groupByExtension)(a,([r])=>r),i=[];for(const r of e)r.sort((n,o)=>T.rcompare(n[0].version,o[0].version)),s.push(...r.slice(1).map(n=>n[1].resource)),i.push(r[0][1]);i.sort((r,n)=>r.mtime-n.mtime),s.push(...i.slice(0,Math.max(0,i.length-this.cache)).map(r=>r.resource)),await L.Promises.settled(s.map(r=>(this.logService.trace("Deleting vsix from cache",r.path),this.fileService.del(r))))}}catch(l){this.logService.error(l)}}getName(l){return this.cache?`${new S.ExtensionIdentifierWithVersion(l.identifier,l.version).key().toLowerCase()}${l.properties.targetPlatform!=="undefined"?`-${l.properties.targetPlatform}`:""}`:(0,m.generateUuid)()}parse(l){const s=p.exec(l);return s&&s[1]&&s[2]?new S.ExtensionIdentifierWithVersion({id:s[1]},s[2]):null}};g=de([ae(0,C.INativeEnvironmentService),ae(1,u.IFileService),ae(2,f.IExtensionGalleryService),ae(3,d.ILogService)],g),t.ExtensionsDownloader=g}),define(Y[110],Q([0,1,2,7,13,41]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsManifestCache=void 0;class D extends L.Disposable{constructor(c,m){super();this.environmentService=c,this.extensionsManifestCache=(0,I.join)(this.environmentService.userDataPath,P.MANIFEST_CACHE_FOLDER,P.USER_MANIFEST_CACHE_FILE),this._register(m.onDidInstallExtensions(w=>this.onDidInstallExtensions(w))),this._register(m.onDidUninstallExtension(w=>this.onDidUnInstallExtension(w)))}onDidInstallExtensions(c){c.some(m=>!!m.local)&&this.invalidate()}onDidUnInstallExtension(c){c.error||this.invalidate()}invalidate(){b.Promises.rm(this.extensionsManifestCache,b.RimRafMode.MOVE).then(()=>{},()=>{})}}t.ExtensionsManifestCache=D}),define(Y[111],Q([0,1,10,2,19,9,21,23,16,14]),function(z,t,L,I,b,P,D,T,c,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsWatcher=void 0;let w=class extends I.Disposable{constructor(f,S,u,d){super();this.extensionsManagementService=f,this.logService=d,this._onDidChangeExtensionsByAnotherSource=this._register(new L.Emitter),this.onDidChangeExtensionsByAnotherSource=this._onDidChangeExtensionsByAnotherSource.event,this.startTimestamp=0,this.installingExtensions=[],this.extensionsManagementService.getInstalled(1).then(y=>{this.installedExtensions=y.map(l=>l.identifier),this.startTimestamp=Date.now()}),this._register(f.onInstallExtension(y=>this.onInstallExtension(y))),this._register(f.onDidInstallExtensions(y=>this.onDidInstallExtensions(y))),this._register(f.onDidUninstallExtension(y=>this.onDidUninstallExtension(y)));const p=P.URI.file(u.extensionsPath),g=new b.ExtUri(y=>!S.hasCapability(y,1024));this._register(S.watch(p)),this._register(L.Event.filter(S.onDidChangeFilesRaw,y=>y.changes.some(l=>this.doesChangeAffects(l,p,g)))(()=>this.onDidChange()))}doesChangeAffects(f,S,u){return u.isEqual(u.dirname(f.resource),S)?u.isEqual(f.resource,u.joinPath(S,".obsolete"))?!0:!(f.type!==1&&f.type!==2||u.basename(f.resource).startsWith(".")):!1}onInstallExtension(f){this.addInstallingExtension(f.identifier)}onDidInstallExtensions(f){for(const S of f)this.removeInstallingExtension(S.identifier),S.local&&this.addInstalledExtension(S.identifier)}onDidUninstallExtension(f){f.error||this.removeInstalledExtension(f.identifier)}addInstallingExtension(f){this.removeInstallingExtension(f),this.installingExtensions.push(f)}removeInstallingExtension(f){this.installingExtensions=this.installingExtensions.filter(S=>!(0,T.areSameExtensions)(S,f))}addInstalledExtension(f){this.installedExtensions&&(this.removeInstalledExtension(f),this.installedExtensions.push(f))}removeInstalledExtension(f){this.installedExtensions&&(this.installedExtensions=this.installedExtensions.filter(S=>!(0,T.areSameExtensions)(S,f)))}async onDidChange(){if(this.installedExtensions){const f=await this.extensionsManagementService.getInstalled(1),S=f.filter(d=>[...this.installingExtensions,...this.installedExtensions].some(p=>(0,T.areSameExtensions)(p,d.identifier))?!1:d.installedTimestamp&&d.installedTimestamp>this.startTimestamp?(this.logService.info("Detected extension installed from another source",d.identifier.id),!0):(this.logService.info("Ignored extension installed by another source because of invalid timestamp",d.identifier.id),!1)),u=this.installedExtensions.filter(d=>this.installingExtensions.some(p=>(0,T.areSameExtensions)(p,d))?!1:f.every(p=>!(0,T.areSameExtensions)(p.identifier,d))?(this.logService.info("Detected extension removed from another source",d.id),!0):!1);this.installedExtensions=f.map(d=>d.identifier),(S.length||u.length)&&this._onDidChangeExtensionsByAnotherSource.fire({added:S,removed:u})}}};w=de([ae(1,c.IFileService),ae(2,D.INativeEnvironmentService),ae(3,m.ILogService)],w),t.ExtensionsWatcher=w}),define(Y[112],Q([0,1,134,20,3,2,6,7,13,21,22,23,54,14]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizationsService=void 0;let u=class extends P.Disposable{constructor(g,y,l){super();this.extensionManagementService=g,this.logService=l,this.cache=this._register(new d(y,l)),this.extensionManagementService.registerParticipant({postInstall:async s=>this.postInstallExtension(s),postUninstall:async s=>this.postUninstallExtension(s)})}async getLanguageIds(){const g=await this.cache.getLanguagePacks(),y=["en",...Object.keys(g)];return(0,I.distinct)(y)}async postInstallExtension(g){g&&g.manifest&&g.manifest.contributes&&g.manifest.contributes.localizations&&g.manifest.contributes.localizations.length&&(this.logService.info("Adding language packs from the extension",g.identifier.id),await this.update())}async postUninstallExtension(g){const y=await this.cache.getLanguagePacks();Object.keys(y).some(l=>y[l]&&y[l].extensions.some(s=>(0,C.areSameExtensions)(s.extensionIdentifier,g.identifier)))&&(this.logService.info("Removing language packs from the extension",g.identifier.id),await this.update())}async update(){const[g,y]=await Promise.all([this.cache.getLanguagePacks(),this.extensionManagementService.getInstalled()]),l=await this.cache.update(y);return!(0,I.equals)(Object.keys(g),Object.keys(l))}};u=de([ae(0,w.IExtensionManagementService),ae(1,m.INativeEnvironmentService),ae(2,S.ILogService)],u),t.LocalizationsService=u;let d=class extends P.Disposable{constructor(g,y){super();this.logService=y,this.languagePacks={},this.languagePacksFilePath=(0,T.join)(g.userDataPath,"languagepacks.json"),this.languagePacksFileLimiter=new b.Queue}getLanguagePacks(){return this.languagePacksFileLimiter.size||!this.initializedCache?this.withLanguagePacks().then(()=>this.languagePacks):Promise.resolve(this.languagePacks)}update(g){return this.withLanguagePacks(y=>{Object.keys(y).forEach(l=>delete y[l]),this.createLanguagePacksFromExtensions(y,...g)}).then(()=>this.languagePacks)}createLanguagePacksFromExtensions(g,...y){for(const l of y)l&&l.manifest&&l.manifest.contributes&&l.manifest.contributes.localizations&&l.manifest.contributes.localizations.length&&this.createLanguagePacksFromExtension(g,l);Object.keys(g).forEach(l=>this.updateHash(g[l]))}createLanguagePacksFromExtension(g,y){const l=y.identifier,s=y.manifest.contributes&&y.manifest.contributes.localizations?y.manifest.contributes.localizations:[];for(const a of s)if(y.location.scheme===D.Schemas.file&&(0,f.isValidLocalization)(a)){let e=g[a.languageId];e||(e={hash:"",extensions:[],translations:{}},g[a.languageId]=e);let i=e.extensions.filter(r=>(0,C.areSameExtensions)(r.extensionIdentifier,l))[0];i?i.version=y.manifest.version:e.extensions.push({extensionIdentifier:l,version:y.manifest.version});for(const r of a.translations)e.translations[r.id]=(0,T.join)(y.location.fsPath,r.path)}}updateHash(g){if(g){const y=(0,L.createHash)("md5");for(const l of g.extensions)y.update(l.extensionIdentifier.uuid||l.extensionIdentifier.id).update(l.version);g.hash=y.digest("hex")}}withLanguagePacks(g=()=>null){return this.languagePacksFileLimiter.queue(()=>{let y=null;return c.Promises.readFile(this.languagePacksFilePath,"utf8").then(void 0,l=>l.code==="ENOENT"?Promise.resolve("{}"):Promise.reject(l)).then(l=>{try{return JSON.parse(l)}catch(s){return{}}}).then(l=>(y=g(l),l)).then(l=>{for(const a of Object.keys(l))l[a]||delete l[a];this.languagePacks=l,this.initializedCache=!0;const s=JSON.stringify(this.languagePacks);return this.logService.debug("Writing language packs",s),c.Promises.writeFile(this.languagePacksFilePath,s)}).then(()=>y,l=>this.logService.error(l))})}};d=de([ae(0,m.INativeEnvironmentService),ae(1,S.ILogService)],d)}),define(Y[43],Q([0,1,17,84,34,15,25]),function(z,t,L,I,b,P,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateProxyConfigurationsScope=t.asJson=t.asText=t.isSuccess=t.IRequestService=void 0,t.IRequestService=(0,P.createDecorator)("requestService");function T(u){return u.res.statusCode&&u.res.statusCode>=200&&u.res.statusCode<300||u.res.statusCode===1223}t.isSuccess=T;function c(u){return u.res.statusCode===204}async function m(u){if(!T(u))throw new Error("Server returned "+u.res.statusCode);return c(u)?null:(await(0,L.streamToBuffer)(u.stream)).toString()}t.asText=m;async function w(u){if(!T(u))throw new Error("Server returned "+u.res.statusCode);if(c(u))return null;const p=(await(0,L.streamToBuffer)(u.stream)).toString();try{return JSON.parse(p)}catch(g){throw g.message+=`:
`+p,g}}t.asJson=w;function C(u){S(u)}t.updateProxyConfigurationsScope=C;let f;function S(u){const d=D.Registry.as(b.Extensions.Configuration),p=f;f={id:"http",order:15,title:(0,I.localize)(0,null),type:"object",scope:u,properties:{"http.proxy":{type:"string",pattern:"^https?://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:(0,I.localize)(1,null),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:(0,I.localize)(2,null),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:(0,I.localize)(3,null),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[(0,I.localize)(4,null),(0,I.localize)(5,null),(0,I.localize)(6,null),(0,I.localize)(7,null)],default:"override",description:(0,I.localize)(8,null),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:(0,I.localize)(9,null),restricted:!0}}},d.updateConfigurations({add:[f],remove:p?[p]:[]})}S(2)}),define(Y[113],Q([0,1,24,6,16,43]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadService=void 0;let D=class{constructor(c,m){this.requestService=c,this.fileService=m}async download(c,m,w=L.CancellationToken.None){if(c.scheme===I.Schemas.file||c.scheme===I.Schemas.vscodeRemote){await this.fileService.copy(c,m);return}const C={type:"GET",url:c.toString()},f=await this.requestService.request(C,w);if(f.res.statusCode===200)await this.fileService.writeFile(m,f.stream);else{const S=await(0,P.asText)(f);throw new Error(`Expected 200, got back ${f.res.statusCode} instead.

${S}`)}}};D=de([ae(0,P.IRequestService),ae(1,b.IFileService)],D),t.DownloadService=D}),define(Y[114],Q([0,1,115,11]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxyAgent=void 0;function b(D,T){return D.protocol==="http:"?T.HTTP_PROXY||T.http_proxy||null:D.protocol==="https:"&&(T.HTTPS_PROXY||T.https_proxy||T.HTTP_PROXY||T.http_proxy)||null}async function P(D,T,c={}){const m=(0,L.parse)(D),w=c.proxyUrl||b(m,T);if(!w)return null;const C=(0,L.parse)(w);if(!/^https?:$/.test(C.protocol||""))return null;const f={host:C.hostname||"",port:C.port||(C.protocol==="https"?"443":"80"),auth:C.auth,rejectUnauthorized:(0,I.isBoolean)(c.strictSSL)?c.strictSSL:!0};return m.protocol==="http:"?new(await new Promise((S,u)=>{z(["http-proxy-agent"],S,u)}))(f):new(await new Promise((S,u)=>{z(["https-proxy-agent"],S,u)}))(f)}t.getProxyAgent=P}),define(Y[116],Q([0,1,17,31]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceMachineId=void 0;async function b(P,D,T){let c=T&&T.get("storage.serviceMachineId",0)||null;if(c)return c;try{const w=(await D.readFile(P.serviceMachineIdResource)).value.toString();c=(0,I.isUUID)(w)?w:null}catch(m){c=null}if(!c){c=(0,I.generateUuid)();try{await D.writeFile(P.serviceMachineIdResource,L.VSBuffer.fromString(c))}catch(m){}}return T&&T.store("storage.serviceMachineId",c,0,1),c}t.getServiceMachineId=b}),define(Y[117],Q([0,1,3,10,2,101,11,65,15]),function(z,t,L,I,b,P,D,T,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logStorage=t.InMemoryStorageService=t.AbstractStorageService=t.StorageTarget=t.StorageScope=t.WillSaveStateReason=t.IStorageService=t.IS_NEW_KEY=void 0,t.IS_NEW_KEY="__$__isNewStorageMarker";const m="__$__targetStorageMarker";t.IStorageService=(0,c.createDecorator)("storageService");var w;(function(p){p[p.NONE=0]="NONE",p[p.SHUTDOWN=1]="SHUTDOWN"})(w=t.WillSaveStateReason||(t.WillSaveStateReason={}));var C;(function(p){p[p.GLOBAL=0]="GLOBAL",p[p.WORKSPACE=1]="WORKSPACE"})(C=t.StorageScope||(t.StorageScope={}));var f;(function(p){p[p.USER=0]="USER",p[p.MACHINE=1]="MACHINE"})(f=t.StorageTarget||(t.StorageTarget={}));class S extends b.Disposable{constructor(g={flushInterval:S.DEFAULT_FLUSH_INTERVAL}){super();this.options=g,this._onDidChangeValue=this._register(new I.PauseableEmitter),this.onDidChangeValue=this._onDidChangeValue.event,this._onDidChangeTarget=this._register(new I.PauseableEmitter),this.onDidChangeTarget=this._onDidChangeTarget.event,this._onWillSaveState=this._register(new I.Emitter),this.onWillSaveState=this._onWillSaveState.event,this.flushWhenIdleScheduler=this._register(new L.RunOnceScheduler(()=>this.doFlushWhenIdle(),this.options.flushInterval)),this.runFlushWhenIdle=this._register(new b.MutableDisposable),this._workspaceKeyTargets=void 0,this._globalKeyTargets=void 0}doFlushWhenIdle(){this.runFlushWhenIdle.value=(0,L.runWhenIdle)(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){(0,b.dispose)([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{(0,P.mark)("code/willInitStorage");try{await this.doInitialize()}finally{(0,P.mark)("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(g,y){y===m?(g===0?this._globalKeyTargets=void 0:g===1&&(this._workspaceKeyTargets=void 0),this._onDidChangeTarget.fire({scope:g})):this._onDidChangeValue.fire({scope:g,key:y,target:this.getKeyTargets(g)[y]})}emitWillSaveState(g){this._onWillSaveState.fire({reason:g})}get(g,y,l){return this.getStorage(y)?.get(g,l)}getBoolean(g,y,l){return this.getStorage(y)?.getBoolean(g,l)}getNumber(g,y,l){return this.getStorage(y)?.getNumber(g,l)}store(g,y,l,s){if((0,D.isUndefinedOrNull)(y)){this.remove(g,l);return}this.withPausedEmitters(()=>{this.updateKeyTarget(g,l,s),this.getStorage(l)?.set(g,y)})}remove(g,y){this.withPausedEmitters(()=>{this.updateKeyTarget(g,y,void 0),this.getStorage(y)?.delete(g)})}withPausedEmitters(g){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{g()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(g,y){const l=[],s=this.getKeyTargets(g);for(const a of Object.keys(s))s[a]===y&&l.push(a);return l}updateKeyTarget(g,y,l){const s=this.getKeyTargets(y);typeof l=="number"?s[g]!==l&&(s[g]=l,this.getStorage(y)?.set(m,JSON.stringify(s))):typeof s[g]=="number"&&(delete s[g],this.getStorage(y)?.set(m,JSON.stringify(s)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get globalKeyTargets(){return this._globalKeyTargets||(this._globalKeyTargets=this.loadKeyTargets(0)),this._globalKeyTargets}getKeyTargets(g){return g===0?this.globalKeyTargets:this.workspaceKeyTargets}loadKeyTargets(g){const y=this.get(m,g);if(y)try{return JSON.parse(y)}catch(l){}return Object.create(null)}isNew(g){return this.getBoolean(t.IS_NEW_KEY,g)===!0}async flush(g=w.NONE){this._onWillSaveState.fire({reason:g}),await L.Promises.settled([this.getStorage(0)?.whenFlushed()??Promise.resolve(),this.getStorage(1)?.whenFlushed()??Promise.resolve()])}async logStorage(){const g=this.getStorage(0)?.items??new Map,y=this.getStorage(1)?.items??new Map;return d(g,y,this.getLogDetails(0)??"",this.getLogDetails(1)??"")}}t.AbstractStorageService=S,S.DEFAULT_FLUSH_INTERVAL=60*1e3;class u extends S{constructor(){super();this.globalStorage=this._register(new T.Storage(new T.InMemoryStorageDatabase)),this.workspaceStorage=this._register(new T.Storage(new T.InMemoryStorageDatabase)),this._register(this.workspaceStorage.onDidChangeStorage(g=>this.emitDidChangeValue(1,g))),this._register(this.globalStorage.onDidChangeStorage(g=>this.emitDidChangeValue(0,g)))}getStorage(g){return g===0?this.globalStorage:this.workspaceStorage}getLogDetails(g){return g===0?"inMemory (global)":"inMemory (workspace)"}async doInitialize(){}async migrate(g){}}t.InMemoryStorageService=u;async function d(p,g,y,l){const s=h=>{try{return JSON.parse(h)}catch(E){return h}},a=new Map,e=new Map;p.forEach((h,E)=>{a.set(E,h),e.set(E,s(h))});const i=new Map,r=new Map;g.forEach((h,E)=>{i.set(E,h),r.set(E,s(h))}),console.group(`Storage: Global (path: ${y})`);let n=[];a.forEach((h,E)=>{n.push({key:E,value:h})}),console.table(n),console.groupEnd(),console.log(e),console.group(`Storage: Workspace (path: ${l})`);let o=[];i.forEach((h,E)=>{o.push({key:E,value:h})}),console.table(o),console.groupEnd(),console.log(r)}t.logStorage=d}),define(Y[118],Q([0,1,12,29,9,31]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyMicrosoftInternalDomain=t.resolveCommonProperties=void 0;function D(m){if(L.platform===2&&/^penguin(\.|$)/i.test(m))return"chromebook"}async function T(m,w,C,f,S,u,d,p,g,y){const l=Object.create(null);l["common.machineId"]=d,l.sessionID=(0,P.generateUuid)()+Date.now(),l.commitHash=S,l.version=u,l["common.platformVersion"]=(w||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),l["common.platform"]=(0,L.PlatformToString)(L.platform),l["common.nodePlatform"]=I.platform,l["common.nodeArch"]=f,l["common.product"]=y||"desktop";const s=c(p||[]);s&&(l["common.msftInternal"]=s);let a=0;const e=Date.now();Object.defineProperties(l,{timestamp:{get:()=>new Date,enumerable:!0},"common.timesincesessionstart":{get:()=>Date.now()-e,enumerable:!0},"common.sequence":{get:()=>a++,enumerable:!0}}),L.isLinuxSnap&&(l["common.snap"]="true");const i=D(C);i&&(l["common.platformDetail"]=i);try{const r=await m.readFile(b.URI.file(g));l["common.source"]=r.value.toString().slice(0,30)}catch(r){}return l}t.resolveCommonProperties=T;function c(m){const w=I.env.USERDNSDOMAIN;if(!w)return!1;const C=w.toLowerCase();return m.some(f=>C===f)}t.verifyMicrosoftInternalDomain=c}),define(Y[30],Q([0,1,15]),function(z,t,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryConfiguration=t.TelemetryLevel=t.TELEMETRY_OLD_SETTING_ID=t.TELEMETRY_SETTING_ID=t.TELEMETRY_SECTION_ID=t.machineIdKey=t.lastSessionDateStorageKey=t.firstSessionDateStorageKey=t.currentSessionDateStorageKey=t.instanceStorageKey=t.ICustomEndpointTelemetryService=t.ITelemetryService=void 0,t.ITelemetryService=(0,L.createDecorator)("telemetryService"),t.ICustomEndpointTelemetryService=(0,L.createDecorator)("customEndpointTelemetryService"),t.instanceStorageKey="telemetry.instanceId",t.currentSessionDateStorageKey="telemetry.currentSessionDate",t.firstSessionDateStorageKey="telemetry.firstSessionDate",t.lastSessionDateStorageKey="telemetry.lastSessionDate",t.machineIdKey="telemetry.machineId",t.TELEMETRY_SECTION_ID="telemetry",t.TELEMETRY_SETTING_ID="telemetry.telemetryLevel",t.TELEMETRY_OLD_SETTING_ID="telemetry.enableTelemetry";var I;(function(P){P[P.NONE=0]="NONE",P[P.CRASH=1]="CRASH",P[P.ERROR=2]="ERROR",P[P.USAGE=3]="USAGE"})(I=t.TelemetryLevel||(t.TelemetryLevel={}));var b;(function(P){P.OFF="off",P.CRASH="crash",P.ERROR="error",P.ON="all"})(b=t.TelemetryConfiguration||(t.TelemetryConfiguration={}))}),define(Y[119],Q([0,1,20,3,24,8,10,2,12,9,74,22,23,14,33,30]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractExtensionTask=t.reportTelemetry=t.joinErrors=t.AbstractExtensionManagementService=void 0;let p=class extends T.Disposable{constructor(e,i,r,n){super();this.galleryService=e,this.telemetryService=i,this.logService=r,this.productService=n,this.lastReportTimestamp=0,this.installingExtensions=new Map,this.uninstallingExtensions=new Map,this._onInstallExtension=this._register(new D.Emitter),this.onInstallExtension=this._onInstallExtension.event,this._onDidInstallExtensions=this._register(new D.Emitter),this.onDidInstallExtensions=this._onDidInstallExtensions.event,this._onUninstallExtension=this._register(new D.Emitter),this.onUninstallExtension=this._onUninstallExtension.event,this._onDidUninstallExtension=this._register(new D.Emitter),this.onDidUninstallExtension=this._onDidUninstallExtension.event,this.participants=[],this._register((0,T.toDisposable)(()=>{this.installingExtensions.forEach(o=>o.cancel()),this.uninstallingExtensions.forEach(o=>o.cancel()),this.installingExtensions.clear(),this.uninstallingExtensions.clear()}))}async canInstall(e){const i=await this.getTargetPlatform();return e.allTargetPlatforms.some(r=>(0,C.isTargetPlatformCompatible)(r,e.allTargetPlatforms,i))}async installFromGallery(e,i={}){try{return await this.doInstallFromGallery(e,i)}catch(r){throw y(r)}}async uninstall(e,i={}){return this.logService.trace("ExtensionManagementService#uninstall",e.identifier.id),this.unininstallExtension(e,i)}async reinstallFromGallery(e){if(this.logService.trace("ExtensionManagementService#reinstallFromGallery",e.identifier.id),!this.galleryService.isEnabled())throw new Error(w.localize(0,null));const i=await this.findGalleryExtension(e);if(!i)throw new Error(w.localize(1,null));await this.createUninstallExtensionTask(e,{remove:!0,versionOnly:!0}).run(),await this.installFromGallery(i)}getExtensionsReport(){const e=new Date().getTime();return(!this.reportedExtensions||e-this.lastReportTimestamp>1e3*60*5)&&(this.reportedExtensions=this.updateReportCache(),this.lastReportTimestamp=e),this.reportedExtensions}registerParticipant(e){this.participants.push(e)}async doInstallFromGallery(e,i={}){if(!this.galleryService.isEnabled())throw new C.ExtensionManagementError(w.localize(2,null),C.ExtensionManagementErrorCode.Internal);if(!await this.canInstall(e)){const n=await this.getTargetPlatform(),o=new C.ExtensionManagementError(w.localize(3,null,e.identifier.id,this.productService.nameLong,(0,C.TargetPlatformToString)(n)),C.ExtensionManagementErrorCode.Incompatible);throw this.logService.error("Cannot install extension.",e.identifier.id,o.message),l(this.telemetryService,"extensionGallery:install",(0,f.getGalleryExtensionTelemetryData)(e),void 0,o),o}try{e=await this.checkAndGetCompatibleVersion(e,!i.installGivenVersion)}catch(n){throw this.logService.error((0,P.getErrorMessage)(n)),l(this.telemetryService,"extensionGallery:install",(0,f.getGalleryExtensionTelemetryData)(e),void 0,n),n}const r=await this.galleryService.getManifest(e,b.CancellationToken.None);if(r===null){const n=new C.ExtensionManagementError(`Missing manifest for extension ${e.identifier.id}`,C.ExtensionManagementErrorCode.Invalid);throw this.logService.error("Failed to install extension:",e.identifier.id,n.message),l(this.telemetryService,"extensionGallery:install",(0,f.getGalleryExtensionTelemetryData)(e),void 0,n),n}if(r.version!==e.version){const n=new C.ExtensionManagementError(`Cannot install '${e.identifier.id}' extension because of version mismatch in Marketplace`,C.ExtensionManagementErrorCode.Invalid);throw this.logService.error(n.message),l(this.telemetryService,"extensionGallery:install",(0,f.getGalleryExtensionTelemetryData)(e),void 0,n),n}return this.installExtension(r,e,i)}async installExtension(e,i,r){if(!m.URI.isUri(i)){let R=this.installingExtensions.get(new f.ExtensionIdentifierWithVersion(i.identifier,i.version).key());if(R)return this.logService.info("Extensions is already requested to install",i.identifier.id),R.waitUntilTaskIsFinished();r={...r,installOnlyNewlyAddedFromExtensionPack:!0}}const n=[],o=[],h=this.createInstallExtensionTask(e,i,r);m.URI.isUri(i)||this.installingExtensions.set(new f.ExtensionIdentifierWithVersion(h.identifier,e.version).key(),h),this._onInstallExtension.fire({identifier:h.identifier,source:i}),this.logService.info("Installing extension:",h.identifier.id),n.push({task:h,manifest:e});let E=!1;try{if(r.donotIncludePackAndDependencies)this.logService.info("Installing the extension without checking dependencies and pack",h.identifier.id);else try{const v=await this.getAllDepsAndPackExtensionsToInstall(h.identifier,e,!!r.installOnlyNewlyAddedFromExtensionPack);for(const{gallery:O,manifest:A}of v)if(E=E||!!A.extensionDependencies?.some(G=>(0,f.areSameExtensions)({id:G},h.identifier)),this.installingExtensions.has(new f.ExtensionIdentifierWithVersion(O.identifier,O.version).key()))this.logService.info("Extension is already requested to install",O.identifier.id);else{const G=this.createInstallExtensionTask(A,O,{...r,donotIncludePackAndDependencies:!0});this.installingExtensions.set(new f.ExtensionIdentifierWithVersion(G.identifier,A.version).key(),G),this._onInstallExtension.fire({identifier:G.identifier,source:O}),this.logService.info("Installing extension:",G.identifier.id),n.push({task:G,manifest:A})}}catch(v){if(m.URI.isUri(h.source))(0,L.isNonEmptyArray)(e.extensionDependencies)&&this.logService.warn("Cannot install dependencies of extension:",h.identifier.id,v.message),(0,L.isNonEmptyArray)(e.extensionPack)&&this.logService.warn("Cannot install packed extensions of extension:",h.identifier.id,v.message);else throw this.logService.error("Error while preparing to install dependencies and extension packs of the extension:",h.identifier.id),this.logService.error(v),v}const R=n.reduce((v,{task:O,manifest:A})=>(v.set(O.identifier.id.toLowerCase(),{task:O,manifest:A}),v),new Map);for(;R.size;){let v;const O=[...R.values()].filter(({manifest:A})=>!A.extensionDependencies?.some(G=>R.has(G.toLowerCase())));O.length?v=R.size===1?O:O.filter(({task:A})=>!(A===h&&!E)):(this.logService.info("Found extensions with circular dependencies",O.map(({task:A})=>A.identifier.id)),v=[...R.values()]),await this.joinAllSettled(v.map(async({task:A})=>{const G=new Date().getTime();try{const te=await A.run();if(await this.joinAllSettled(this.participants.map(ue=>ue.postInstall(te,A.source,r,b.CancellationToken.None))),!m.URI.isUri(A.source)&&(l(this.telemetryService,A.operation===2?"extensionGallery:update":"extensionGallery:install",(0,f.getGalleryExtensionTelemetryData)(A.source),new Date().getTime()-G,void 0),c.isWeb&&A.operation===1))try{await this.galleryService.reportStatistic(te.manifest.publisher,te.manifest.name,te.manifest.version,"install")}catch(ue){}o.push({local:te,identifier:A.identifier,operation:A.operation,source:A.source})}catch(te){throw m.URI.isUri(A.source)||l(this.telemetryService,A.operation===2?"extensionGallery:update":"extensionGallery:install",(0,f.getGalleryExtensionTelemetryData)(A.source),new Date().getTime()-G,te),this.logService.error("Error while installing the extension:",A.identifier.id),this.logService.error(te),te}finally{R.delete(A.identifier.id.toLowerCase())}}))}return o.forEach(({identifier:v})=>this.logService.info("Extension installed successfully:",v.id)),this._onDidInstallExtensions.fire(o),o.filter(({identifier:v})=>(0,f.areSameExtensions)(v,h.identifier))[0].local}catch(R){if(n.forEach(({task:v})=>v.cancel()),o.length)try{const v=await Promise.allSettled(o.map(({local:O})=>this.createUninstallExtensionTask(O,{versionOnly:!0}).run()));for(let O=0;O<v.length;O++){const A=v[O],{identifier:G}=o[O];A.status==="fulfilled"?this.logService.info("Rollback: Uninstalled extension",G.id):this.logService.warn("Rollback: Error while uninstalling extension",G.id,(0,P.getErrorMessage)(A.reason))}}catch(v){this.logService.warn("Error while rolling back extensions",(0,P.getErrorMessage)(v),o.map(({identifier:O})=>O.id))}throw this.logService.error("Failed to install extension:",h.identifier.id,(0,P.getErrorMessage)(R)),this._onDidInstallExtensions.fire(n.map(({task:v})=>({identifier:v.identifier,operation:1,source:v.source}))),R instanceof Error&&(R.name=R&&R.code?R.code:C.ExtensionManagementErrorCode.Internal),R}finally{for(const{task:R,manifest:v}of n)if(!m.URI.isUri(R.source)){const O=new f.ExtensionIdentifierWithVersion(R.identifier,v.version).key();this.installingExtensions.delete(O)||this.logService.warn("Installation task is not found in the cache",O)}}}async joinAllSettled(e){const i=[],r=[],n=await Promise.allSettled(e);for(const o of n)o.status==="fulfilled"?i.push(o.value):r.push(o.reason);if(r.length)throw g(r);return i}async getAllDepsAndPackExtensionsToInstall(e,i,r){if(!this.galleryService.isEnabled())return[];let n=await this.getInstalled();const o=[e,...n.map(R=>R.identifier)],h=[],E=async(R,v)=>{const O=v.extensionDependencies||[],A=[...O];if(v.extensionPack){const G=r?n.find(te=>(0,f.areSameExtensions)(te.identifier,R)):void 0;for(const te of v.extensionPack)G&&G.manifest.extensionPack&&G.manifest.extensionPack.some(ue=>(0,f.areSameExtensions)({id:ue},{id:te}))||A.every(ue=>!(0,f.areSameExtensions)({id:ue},{id:te}))&&A.push(te)}if(A.length){const G=[...o,...h.map(ue=>ue.gallery.identifier)],te=A.filter(ue=>G.every(ce=>!(0,f.areSameExtensions)(ce,{id:ue})));if(te.length){const ue=await this.galleryService.query({names:te,pageSize:A.length},b.CancellationToken.None);for(const ce of ue.firstPage){if(G.find(_=>(0,f.areSameExtensions)(_,ce.identifier)))continue;if(!O.some(_=>(0,f.areSameExtensions)({id:_},ce.identifier))&&!await this.canInstall(ce)){this.logService.info("Skipping the packed extension as it cannot be installed",ce.identifier.id);continue}const B=await this.checkAndGetCompatibleVersion(ce,!0),K=await this.galleryService.getManifest(B,b.CancellationToken.None);if(K===null)throw new C.ExtensionManagementError(`Missing manifest for extension ${B.identifier.id}`,C.ExtensionManagementErrorCode.Invalid);h.push({gallery:B,manifest:K}),await E(B.identifier,K)}}}};return await E(e,i),n=await this.getInstalled(),h.filter(R=>!n.some(v=>(0,f.areSameExtensions)(v.identifier,R.gallery.identifier)))}async checkAndGetCompatibleVersion(e,i){if(await this.isMalicious(e))throw new C.ExtensionManagementError(w.localize(4,null,e.identifier.id),C.ExtensionManagementErrorCode.Malicious);const r=await this.getCompatibleVersion(e,i);if(!r)throw new C.ExtensionManagementError(w.localize(5,null,e.identifier.id,this.productService.nameLong,this.productService.version),C.ExtensionManagementErrorCode.Incompatible);return r}async getCompatibleVersion(e,i){const r=await this.getTargetPlatform();let n=null;return await this.galleryService.isExtensionCompatible(e,r)&&(n=e),!n&&i&&(n=await this.galleryService.getCompatibleExtension(e,r)),n}async isMalicious(e){const i=await this.getExtensionsReport();return(0,f.getMaliciousExtensionsSet)(i).has(e.identifier.id)}async unininstallExtension(e,i){const r=this.uninstallingExtensions.get(e.identifier.id.toLowerCase());if(r)return this.logService.info("Extensions is already requested to uninstall",e.identifier.id),r.waitUntilTaskIsFinished();const n=(R,v)=>{const O=this.createUninstallExtensionTask(R,v);return this.uninstallingExtensions.set(O.extension.identifier.id.toLowerCase(),O),this.logService.info("Uninstalling extension:",R.identifier.id),this._onUninstallExtension.fire(R.identifier),O},o=(R,v)=>{v?this.logService.error("Failed to uninstall extension:",R.identifier.id,v.message):this.logService.info("Successfully uninstalled extension:",R.identifier.id),l(this.telemetryService,"extensionGallery:uninstall",(0,f.getLocalExtensionTelemetryData)(R),void 0,v),this._onDidUninstallExtension.fire({identifier:R.identifier,error:v?.code})},h=[],E=[];try{h.push(n(e,{}));const R=await this.getInstalled(1);if(i.donotIncludePack)this.logService.info("Uninstalling the extension without including packed extension",e.identifier.id);else{const v=this.getAllPackExtensionsToUninstall(e,R);for(const O of v)this.uninstallingExtensions.has(O.identifier.id.toLowerCase())?this.logService.info("Extensions is already requested to uninstall",O.identifier.id):h.push(n(O,{}))}i.donotCheckDependents?this.logService.info("Uninstalling the extension without checking dependents",e.identifier.id):this.checkForDependents(h.map(v=>v.extension),R,e),await this.joinAllSettled(h.map(async v=>{try{if(await v.run(),await this.joinAllSettled(this.participants.map(O=>O.postUninstall(v.extension,i,b.CancellationToken.None))),v.extension.identifier.uuid)try{await this.galleryService.reportStatistic(v.extension.manifest.publisher,v.extension.manifest.name,v.extension.manifest.version,"uninstall")}catch(O){}o(v.extension)}catch(O){const A=O instanceof C.ExtensionManagementError?O:new C.ExtensionManagementError((0,P.getErrorMessage)(O),C.ExtensionManagementErrorCode.Internal);throw o(v.extension,A),A}finally{E.push(v)}}))}catch(R){const v=R instanceof C.ExtensionManagementError?R:new C.ExtensionManagementError((0,P.getErrorMessage)(R),C.ExtensionManagementErrorCode.Internal);for(const O of h){try{O.cancel()}catch(A){}E.includes(O)||o(O.extension,v)}throw v}finally{for(const R of h)this.uninstallingExtensions.delete(R.extension.identifier.id.toLowerCase())||this.logService.warn("Uninstallation task is not found in the cache",R.extension.identifier.id)}}checkForDependents(e,i,r){for(const n of e){const o=this.getDependents(n,i);if(o.length){const h=o.filter(E=>!e.some(R=>(0,f.areSameExtensions)(R.identifier,E.identifier)));if(h.length)throw new Error(this.getDependentsErrorMessage(n,h,r))}}}getDependentsErrorMessage(e,i,r){return r===e?i.length===1?w.localize(6,null,r.manifest.displayName||r.manifest.name,i[0].manifest.displayName||i[0].manifest.name):i.length===2?w.localize(7,null,r.manifest.displayName||r.manifest.name,i[0].manifest.displayName||i[0].manifest.name,i[1].manifest.displayName||i[1].manifest.name):w.localize(8,null,r.manifest.displayName||r.manifest.name,i[0].manifest.displayName||i[0].manifest.name,i[1].manifest.displayName||i[1].manifest.name):i.length===1?w.localize(9,null,r.manifest.displayName||r.manifest.name,e.manifest.displayName||e.manifest.name,i[0].manifest.displayName||i[0].manifest.name):i.length===2?w.localize(10,null,r.manifest.displayName||r.manifest.name,e.manifest.displayName||e.manifest.name,i[0].manifest.displayName||i[0].manifest.name,i[1].manifest.displayName||i[1].manifest.name):w.localize(11,null,r.manifest.displayName||r.manifest.name,e.manifest.displayName||e.manifest.name,i[0].manifest.displayName||i[0].manifest.name,i[1].manifest.displayName||i[1].manifest.name)}getAllPackExtensionsToUninstall(e,i,r=[]){if(r.indexOf(e)!==-1)return[];r.push(e);const n=e.manifest.extensionPack?e.manifest.extensionPack:[];if(n.length){const o=i.filter(E=>!E.isBuiltin&&n.some(R=>(0,f.areSameExtensions)({id:R},E.identifier))),h=[];for(const E of o)h.push(...this.getAllPackExtensionsToUninstall(E,i,r));return[...o,...h]}return[]}getDependents(e,i){return i.filter(r=>r.manifest.extensionDependencies&&r.manifest.extensionDependencies.some(n=>(0,f.areSameExtensions)({id:n},e.identifier)))}async findGalleryExtension(e){if(e.identifier.uuid){const i=await this.findGalleryExtensionById(e.identifier.uuid);return i||this.findGalleryExtensionByName(e.identifier.id)}return this.findGalleryExtensionByName(e.identifier.id)}async findGalleryExtensionById(e){return(await this.galleryService.query({ids:[e],pageSize:1},b.CancellationToken.None)).firstPage[0]}async findGalleryExtensionByName(e){return(await this.galleryService.query({names:[e],pageSize:1},b.CancellationToken.None)).firstPage[0]}async updateReportCache(){try{this.logService.trace("ExtensionManagementService.refreshReportedCache");const e=await this.galleryService.getExtensionsReport();return this.logService.trace(`ExtensionManagementService.refreshReportedCache - got ${e.length} reported extensions from service`),e}catch(e){return this.logService.trace("ExtensionManagementService.refreshReportedCache - failed to get extension report"),[]}}};p=de([ae(0,C.IExtensionGalleryService),ae(1,d.ITelemetryService),ae(2,S.ILogService),ae(3,u.IProductService)],p),t.AbstractExtensionManagementService=p;function g(a){const e=Array.isArray(a)?a:[a];return e.length===1?e[0]instanceof Error?e[0]:new Error(e[0]):e.reduce((i,r)=>new Error(`${i.message}${i.message?",":""}${r instanceof Error?r.message:r}`),new Error(""))}t.joinErrors=g;function y(a){if(a instanceof C.ExtensionManagementError)return a;const e=new C.ExtensionManagementError(a.message,C.ExtensionManagementErrorCode.Internal);return e.stack=a.stack,e}function l(a,e,i,r,n){const o=n?n instanceof C.ExtensionManagementError?n.code:C.ExtensionManagementErrorCode.Internal:void 0;a.publicLogError(e,{...i,success:!n,duration:r,errorcode:o})}t.reportTelemetry=l;class s{constructor(){this.barrier=new I.Barrier}async waitUntilTaskIsFinished(){return await this.barrier.wait(),this.cancellablePromise}async run(){return this.cancellablePromise||(this.cancellablePromise=(0,I.createCancelablePromise)(e=>this.doRun(e))),this.barrier.open(),this.cancellablePromise}cancel(){this.cancellablePromise||(this.cancellablePromise=(0,I.createCancelablePromise)(e=>new Promise((i,r)=>{const n=e.onCancellationRequested(()=>{n.dispose(),r((0,P.canceled)())})})),this.barrier.open()),this.cancellablePromise.cancel()}}t.AbstractExtensionTask=s}),define(Y[37],Q([0,1,18,11,26,30]),function(z,t,L,I,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanRemoteAuthority=t.validateTelemetryData=t.getTelemetryLevel=t.supportsTelemetry=t.configurationTelemetry=t.NullAppender=t.NullEndpointTelemetryService=t.NullTelemetryService=t.NullTelemetryServiceShape=void 0;class D{constructor(){this.sendErrorTelemetry=!1,this.telemetryLevel=0}publicLog(g,y){return Promise.resolve(void 0)}publicLog2(g,y){return this.publicLog(g,y)}publicLogError(g,y){return Promise.resolve(void 0)}publicLogError2(g,y){return this.publicLogError(g,y)}setExperimentProperty(){}getTelemetryInfo(){return Promise.resolve({instanceId:"someValue.instanceId",sessionId:"someValue.sessionId",machineId:"someValue.machineId",firstSessionDate:"someValue.firstSessionDate"})}}t.NullTelemetryServiceShape=D,t.NullTelemetryService=new D;class T{async publicLog(g,y,l){}async publicLogError(g,y,l){}}t.NullEndpointTelemetryService=T,t.NullAppender={log:()=>null,flush:()=>Promise.resolve(null)};function c(p,g){return g.onDidChangeConfiguration(y=>{y.source!==6&&p.publicLog2("updateConfiguration",{configurationSource:(0,b.ConfigurationTargetToString)(y.source),configurationKeys:u(y.sourceConfig)})})}t.configurationTelemetry=c;function m(p,g){return!(g.disableTelemetry||!p.enableTelemetry)}t.supportsTelemetry=m;function w(p){const g=p.getValue(P.TELEMETRY_SETTING_ID),y=p.getValue("telemetry.enableCrashReporter");if(p.getValue(P.TELEMETRY_OLD_SETTING_ID)===!1||y===!1)return 0;switch(g??"all"){case"all":return 3;case"error":return 2;case"crash":return 1;case"off":return 0}}t.getTelemetryLevel=w;function C(p){const g=Object.create(null),y=Object.create(null),l=Object.create(null);S(p,l);for(let s in l){s=s.length>150?s.substr(s.length-149):s;const a=l[s];typeof a=="number"?y[s]=a:typeof a=="boolean"?y[s]=a?1:0:typeof a=="string"?g[s]=a.substring(0,1023):typeof a!="undefined"&&a!==null&&(g[s]=a)}return{properties:g,measurements:y}}t.validateTelemetryData=C;function f(p){if(!p)return"none";let g="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(l=>{p.indexOf(`${l}+`)===0&&(g=l)}),g}t.cleanRemoteAuthority=f;function S(p,g,y=0,l){if(!!p)for(let s of Object.getOwnPropertyNames(p)){const a=p[s],e=l?l+s:s;Array.isArray(a)?g[e]=(0,L.safeStringify)(a):a instanceof Date?g[e]=a.toISOString():(0,I.isObject)(a)?y<2?S(a,g,y+1,e+"."):g[e]=(0,L.safeStringify)(a):g[e]=a}}function u(p){if(!p)return[];const g=[];return d(g,"",p),g}function d(p,g,y){y&&typeof y=="object"&&!Array.isArray(y)?Object.keys(y).forEach(l=>d(p,g?`${g}.${l}`:l,y[l])):p.push(g)}}),define(Y[120],Q([0,1,20,24,8,18,12,29,9,26,21,22,23,49,16,14,33,43,116,117,30,37]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d,p,g,y,l,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveMarketplaceHeaders=t.ExtensionGalleryServiceWithNoStorageService=t.ExtensionGalleryService=t.sortExtensionVersions=void 0;const e=D.isWeb?"web":(0,C.getTargetPlatform)(D.platform,T.arch);var i;(function(M){M[M.None=0]="None",M[M.IncludeVersions=1]="IncludeVersions",M[M.IncludeFiles=2]="IncludeFiles",M[M.IncludeCategoryAndTags=4]="IncludeCategoryAndTags",M[M.IncludeSharedAccounts=8]="IncludeSharedAccounts",M[M.IncludeVersionProperties=16]="IncludeVersionProperties",M[M.ExcludeNonValidated=32]="ExcludeNonValidated",M[M.IncludeInstallationTargets=64]="IncludeInstallationTargets",M[M.IncludeAssetUri=128]="IncludeAssetUri",M[M.IncludeStatistics=256]="IncludeStatistics",M[M.IncludeLatestVersionOnly=512]="IncludeLatestVersionOnly",M[M.Unpublished=4096]="Unpublished"})(i||(i={}));function r(...M){return String(M.reduce((N,q)=>N|q,0))}var n;(function(M){M[M.Tag=1]="Tag",M[M.ExtensionId=4]="ExtensionId",M[M.Category=5]="Category",M[M.ExtensionName=7]="ExtensionName",M[M.Target=8]="Target",M[M.Featured=9]="Featured",M[M.SearchText=10]="SearchText",M[M.ExcludeWithFlags=12]="ExcludeWithFlags"})(n||(n={}));const o={Icon:"Microsoft.VisualStudio.Services.Icons.Default",Details:"Microsoft.VisualStudio.Services.Content.Details",Changelog:"Microsoft.VisualStudio.Services.Content.Changelog",Manifest:"Microsoft.VisualStudio.Code.Manifest",VSIX:"Microsoft.VisualStudio.Services.VSIXPackage",License:"Microsoft.VisualStudio.Services.Content.License",Repository:"Microsoft.VisualStudio.Services.Links.Source"},h={Dependency:"Microsoft.VisualStudio.Code.ExtensionDependencies",ExtensionPack:"Microsoft.VisualStudio.Code.ExtensionPack",Engine:"Microsoft.VisualStudio.Code.Engine",LocalizedLanguages:"Microsoft.VisualStudio.Code.LocalizedLanguages",WebExtension:"Microsoft.VisualStudio.Code.WebExtension"},R={pageNumber:1,pageSize:10,sortBy:0,sortOrder:0,flags:i.None,criteria:[],assetTypes:[]};class v{constructor(N=R){this.state=N}get pageNumber(){return this.state.pageNumber}get pageSize(){return this.state.pageSize}get sortBy(){return this.state.sortBy}get sortOrder(){return this.state.sortOrder}get flags(){return this.state.flags}withPage(N,q=this.state.pageSize){return new v({...this.state,pageNumber:N,pageSize:q})}withFilter(N,...q){const V=[...this.state.criteria,...q.length?q.map(J=>({filterType:N,value:J})):[{filterType:N}]];return new v({...this.state,criteria:V})}withSortBy(N){return new v({...this.state,sortBy:N})}withSortOrder(N){return new v({...this.state,sortOrder:N})}withFlags(...N){return new v({...this.state,flags:N.reduce((q,V)=>q|V,0)})}withAssetTypes(...N){return new v({...this.state,assetTypes:N})}get raw(){const{criteria:N,pageNumber:q,pageSize:V,sortBy:J,sortOrder:ee,flags:se,assetTypes:re}=this.state;return{filters:[{criteria:N,pageNumber:q,pageSize:V,sortBy:J,sortOrder:ee}],assetTypes:re,flags:se}}get searchText(){const N=this.state.criteria.filter(q=>q.filterType===n.SearchText)[0];return N&&N.value?N.value:""}get telemetryData(){return{filterTypes:this.state.criteria.map(N=>String(N.filterType)),sortBy:String(this.sortBy),sortOrder:String(this.sortOrder)}}}function O(M,N){const q=(M||[]).filter(V=>V.statisticName===N)[0];return q?q.value:0}function A(M){const N="Microsoft.VisualStudio.Code.Translation.";return M.files.filter(V=>V.assetType.indexOf(N)===0).reduce((V,J)=>{const ee=ce(M,J.assetType);return ee&&V.push([J.assetType.substring(N.length),ee]),V},[])}function G(M){if(M.properties){const N=M.properties.filter(J=>J.key===o.Repository),q=new RegExp("((git|ssh|http(s)?)|(git@[\\w.]+))(:(//)?)([\\w.@:/\\-~]+)(.git)(/)?"),V=N.filter(J=>q.test(J.value))[0];return V?{uri:V.value,fallbackUri:V.value}:null}return ce(M,o.Repository)}function te(M){return{uri:`${M.fallbackAssetUri}/${o.VSIX}?redirect=true${M.targetPlatform?`&targetPlatform=${M.targetPlatform}`:""}`,fallbackUri:`${M.fallbackAssetUri}/${o.VSIX}${M.targetPlatform?`?targetPlatform=${M.targetPlatform}`:""}`}}function ue(M){const N=ce(M,o.Icon);if(N)return N;const q=C.DefaultIconPath;return{uri:q,fallbackUri:q}}function ce(M,N){return M.files.filter(V=>V.assetType===N)[0]?{uri:`${M.assetUri}/${N}`,fallbackUri:`${M.fallbackAssetUri}/${N}`}:null}function ne(M,N){const q=M.properties?M.properties.filter(J=>J.key===N):[],V=q.length>0&&q[0].value;return V?V.split(",").map(J=>(0,f.adoptToGalleryExtensionId)(J)):[]}function B(M){const N=M.properties?M.properties.filter(q=>q.key===h.Engine):[];return N.length>0&&N[0].value||""}function K(M){const N=M.properties?M.properties.filter(V=>V.key===h.LocalizedLanguages):[],q=N.length>0&&N[0].value||"";return q?q.split(","):[]}function _(M){return M.indexOf("preview")!==-1}function oe(M){return M.targetPlatform?(0,C.toTargetPlatform)(M.targetPlatform):"undefined"}function x(M){const N=(0,L.distinct)(M.versions.map(oe)),q=!!M.tags?.includes(C.WEB_EXTENSION_TAG),V=N.indexOf("web");return q?V===-1&&N.push("web"):V!==-1&&N.splice(V,1),N}function F(M,N){const q=(0,C.getFallbackTargetPlarforms)(N);for(let V=0;V<M.length;V++){const J=M[V];if(J.version===M[V-1]?.version){let ee=V;const se=oe(J);if(se===N)for(;ee>0&&M[ee-1].version===J.version;)ee--;else if(q.includes(se))for(;ee>0&&M[ee-1].version===J.version&&oe(M[ee-1])!==N;)ee--;ee!==V&&(M.splice(V,1),M.splice(ee,0,J))}}return M}t.sortExtensionVersions=F;function W(M,N,q,V,J){const ee=x(M);let se=M.versions[0];return se=M.versions.find(re=>re.version===se.version&&(0,C.isTargetPlatformCompatible)(oe(re),ee,J))||se,H(M,se,ee,N,q,V)}function H(M,N,q,V,J,ee){const se={manifest:ce(N,o.Manifest),readme:ce(N,o.Details),changelog:ce(N,o.Changelog),license:ce(N,o.License),repository:G(N),download:te(N),icon:ue(N),coreTranslations:A(N)};return{identifier:{id:(0,f.getGalleryExtensionId)(M.publisher.publisherName,M.extensionName),uuid:M.extensionId},name:M.extensionName,version:N.version,displayName:M.displayName,publisherId:M.publisher.publisherId,publisher:M.publisher.publisherName,publisherDisplayName:M.publisher.displayName,publisherDomain:M.publisher.domain?{link:M.publisher.domain,verified:!!M.publisher.isDomainVerified}:void 0,description:M.shortDescription||"",installCount:O(M.statistics,"install"),rating:O(M.statistics,"averagerating"),ratingCount:O(M.statistics,"ratingcount"),categories:M.categories||[],tags:M.tags||[],releaseDate:Date.parse(M.releaseDate),lastUpdated:Date.parse(M.lastUpdated),allTargetPlatforms:q,assets:se,properties:{dependencies:ne(N,h.Dependency),extensionPack:ne(N,h.ExtensionPack),engine:B(N),localizedLanguages:K(N),targetPlatform:oe(N)},preview:_(M.flags),telemetryData:{index:(J.pageNumber-1)*J.pageSize+V,querySource:ee}}}let X=class{constructor(N,q,V,J,ee,se,re,me){this.requestService=q,this.logService=V,this.environmentService=J,this.telemetryService=ee,this.fileService=se,this.productService=re,this.configurationService=me;const ve=re.extensionsGallery;this.extensionsGalleryUrl=ve&&ve.serviceUrl,this.extensionsControlUrl=ve&&ve.controlUrl,this.commonHeadersPromise=Z(re.version,re,this.environmentService,this.configurationService,this.fileService,N)}api(N=""){return`${this.extensionsGalleryUrl}${N}`}isEnabled(){return!!this.extensionsGalleryUrl}async getExtensions(N,q){const V=[];let J=new v().withFlags(i.IncludeAssetUri,i.IncludeStatistics,i.IncludeCategoryAndTags,i.IncludeFiles,i.IncludeVersionProperties).withPage(1,N.length).withFilter(n.Target,"Microsoft.VisualStudio.Code").withFilter(n.ExtensionName,...N.map(({id:se})=>se.toLowerCase()));N.every(se=>!se.version)&&(J=J.withFlags(i.IncludeAssetUri,i.IncludeStatistics,i.IncludeCategoryAndTags,i.IncludeFiles,i.IncludeVersionProperties,i.IncludeLatestVersionOnly));const{galleryExtensions:ee}=await this.queryGallery(J,e,I.CancellationToken.None);for(let se=0;se<ee.length;se++){const re=ee[se];if(!re.versions.length)continue;const me=(0,f.getGalleryExtensionId)(re.publisher.publisherName,re.extensionName),ve=N.find(fe=>(0,f.areSameExtensions)(fe,{id:me}))?.version;if(ve){const fe=re.versions.find(be=>be.version===ve);fe&&V.push(H(re,fe,x(re),se,J))}else V.push(W(re,se,J,void 0,e))}return V}async getCompatibleExtension(N,q){const V=(0,C.isIExtensionIdentifier)(N)?null:N;if(V){if((0,C.isNotWebExtensionInWebTargetPlatform)(V.allTargetPlatforms,q))return null;if(await this.isExtensionCompatible(V,q))return V}const{id:J,uuid:ee}=V?V.identifier:N;let se=new v().withFlags(i.IncludeAssetUri,i.IncludeStatistics,i.IncludeCategoryAndTags,i.IncludeFiles,i.IncludeVersionProperties).withPage(1,1).withFilter(n.Target,"Microsoft.VisualStudio.Code");ee?se=se.withFilter(n.ExtensionId,ee):se=se.withFilter(n.ExtensionName,J);const{galleryExtensions:re}=await this.queryGallery(se,q,I.CancellationToken.None),[me]=re;if(!me||!me.versions.length)return null;const ve=x(me);if((0,C.isNotWebExtensionInWebTargetPlatform)(ve,q))return null;for(let fe of me.versions){if(!B(fe)){const be=await this.getEngine(fe);fe={...fe,properties:[...fe.properties||[],{key:h.Engine,value:be}]}}if(await this.isRawExtensionVersionCompatible(fe,ve,q))return H(me,fe,ve,0,se)}return null}async isExtensionCompatible(N,q){if(!(0,C.isTargetPlatformCompatible)(N.properties.targetPlatform,N.allTargetPlatforms,q))return!1;let V=N.properties.engine;if(!V){const J=await this.getManifest(N,I.CancellationToken.None);if(!J)throw new Error("Manifest was not found");V=J.engines.vscode}return(0,S.isEngineValid)(V,this.productService.version,this.productService.date)}async isRawExtensionVersionCompatible(N,q,V){if(!(0,C.isTargetPlatformCompatible)(oe(N),q,V))return!1;const J=await this.getEngine(N);return(0,S.isEngineValid)(J,this.productService.version,this.productService.date)}async query(N,q){const V=I.CancellationToken.isCancellationToken(N)?{}:N,J=I.CancellationToken.isCancellationToken(N)?N:q;if(!this.isEnabled())throw new Error("No extension gallery service configured.");let ee=V.text||"";const se=(0,P.getOrDefault)(V,ye=>ye.pageSize,50);let re=new v().withFlags(i.IncludeLatestVersionOnly,i.IncludeAssetUri,i.IncludeStatistics,i.IncludeCategoryAndTags,i.IncludeFiles,i.IncludeVersionProperties).withPage(1,se).withFilter(n.Target,"Microsoft.VisualStudio.Code");ee?(ee=ee.replace(/\bcategory:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(ye,we,Fe)=>(re=re.withFilter(n.Category,Fe||we),"")),ee=ee.replace(/\btag:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(ye,we,Fe)=>(re=re.withFilter(n.Tag,Fe||we),"")),ee=ee.replace(/\bfeatured(\s+|\b|$)/g,()=>(re=re.withFilter(n.Featured),"")),ee=ee.trim(),ee&&(ee=ee.length<200?ee:ee.substring(0,200),re=re.withFilter(n.SearchText,ee)),re=re.withSortBy(0)):V.ids?re=re.withFilter(n.ExtensionId,...V.ids):V.names?re=re.withFilter(n.ExtensionName,...V.names):re=re.withSortBy(4),typeof V.sortBy=="number"&&(re=re.withSortBy(V.sortBy)),typeof V.sortOrder=="number"&&(re=re.withSortOrder(V.sortOrder));const{galleryExtensions:me,total:ve}=await this.queryGallery(re,e,J),fe=me.map((ye,we)=>W(ye,we,re,V.source,e)),be=async(ye,we)=>{if(we.isCancellationRequested)throw(0,b.canceled)();const Fe=re.withPage(ye+1),{galleryExtensions:Me}=await this.queryGallery(Fe,e,we);return Me.map((ze,Ue)=>W(ze,Ue,Fe,V.source,e))};return{firstPage:fe,total:ve,pageSize:re.pageSize,getPage:be}}async queryGallery(N,q,V){if(!this.isEnabled())throw new Error("No extension gallery service configured.");N=N.withFlags(N.flags,i.ExcludeNonValidated).withFilter(n.ExcludeWithFlags,r(i.Unpublished));const J=await this.commonHeadersPromise,ee=JSON.stringify(N.raw),se={...J,"Content-Type":"application/json",Accept:"application/json;api-version=3.0-preview.1","Accept-Encoding":"gzip","Content-Length":String(ee.length)},re=new Date().getTime();let me,ve,fe=0;try{if(me=await this.requestService.request({type:"POST",url:this.api("/extensionquery"),data:ee,headers:se},V),me.res.statusCode&&me.res.statusCode>=400&&me.res.statusCode<500)return{galleryExtensions:[],total:fe};const be=await(0,g.asJson)(me);if(be){const ye=be.results[0],we=ye.extensions;we.forEach(Me=>F(Me.versions,q));const Fe=ye.resultMetadata&&ye.resultMetadata.filter(Me=>Me.metadataType==="ResultCount")[0];return fe=Fe&&Fe.metadataItems.filter(Me=>Me.name==="TotalCount")[0].count||0,{galleryExtensions:we,total:fe}}return{galleryExtensions:[],total:fe}}catch(be){throw ve=be,be}finally{this.telemetryService.publicLog2("galleryService:query",{...N.telemetryData,requestBodySize:String(ee.length),duration:new Date().getTime()-re,success:!!me&&(0,g.isSuccess)(me),responseBodySize:me?.res.headers["Content-Length"],statusCode:me?String(me.res.statusCode):void 0,errorCode:ve?(0,b.isPromiseCanceledError)(ve)?"canceled":(0,b.getErrorMessage)(ve).startsWith("XHR timeout")?"timeout":"failed":void 0,count:String(fe)})}}async reportStatistic(N,q,V,J){if(!this.isEnabled())return;const ee=D.isWeb?this.api(`/itemName/${N}.${q}/version/${V}/statType/${J==="install"?"1":"3"}/vscodewebextension`):this.api(`/publishers/${N}/extensions/${q}/${V}/stats?statType=${J}`),se=D.isWeb?"api-version=6.1-preview.1":"*/*;api-version=4.0-preview.1",me={...await this.commonHeadersPromise,Accept:se};try{await this.requestService.request({type:"POST",url:ee,headers:me},I.CancellationToken.None)}catch(ve){}}async download(N,q,V){this.logService.trace("ExtensionGalleryService#download",N.identifier.id);const J=(0,f.getGalleryExtensionTelemetryData)(N),ee=new Date().getTime(),se=fe=>this.telemetryService.publicLog("galleryService:downloadVSIX",{...J,duration:fe}),re=V===1?"install":V===2?"update":"",me=re?{uri:`${N.assets.download.uri}${c.URI.parse(N.assets.download.uri).query?"&":"?"}${re}=true`,fallbackUri:`${N.assets.download.fallbackUri}${c.URI.parse(N.assets.download.fallbackUri).query?"&":"?"}${re}=true`}:N.assets.download,ve=await this.getAsset(me);await this.fileService.writeFile(q,ve.stream),se(new Date().getTime()-ee)}async getReadme(N,q){if(N.assets.readme){const V=await this.getAsset(N.assets.readme,{},q);return await(0,g.asText)(V)||""}return""}async getManifest(N,q){if(N.assets.manifest){const V=await this.getAsset(N.assets.manifest,{},q),J=await(0,g.asText)(V);return J?JSON.parse(J):null}return null}async getManifestFromRawExtensionVersion(N,q){const V=ce(N,o.Manifest);if(!V)throw new Error("Manifest was not found");const J={"Accept-Encoding":"gzip"},ee=await this.getAsset(V,{headers:J});return await(0,g.asJson)(ee)}async getCoreTranslation(N,q){const V=N.assets.coreTranslations.filter(J=>J[0]===q.toUpperCase())[0];if(V){const J=await this.getAsset(V[1]),ee=await(0,g.asText)(J);return ee?JSON.parse(ee):null}return null}async getChangelog(N,q){if(N.assets.changelog){const V=await this.getAsset(N.assets.changelog,{},q);return await(0,g.asText)(V)||""}return""}async getAllCompatibleVersions(N,q){let V=new v().withFlags(i.IncludeVersions,i.IncludeCategoryAndTags,i.IncludeFiles,i.IncludeVersionProperties).withPage(1,1).withFilter(n.Target,"Microsoft.VisualStudio.Code");N.identifier.uuid?V=V.withFilter(n.ExtensionId,N.identifier.uuid):V=V.withFilter(n.ExtensionName,N.identifier.id);const{galleryExtensions:J}=await this.queryGallery(V,q,I.CancellationToken.None);if(!J.length)return[];const ee=x(J[0]);if((0,C.isNotWebExtensionInWebTargetPlatform)(ee,q))return[];const se=[];for(const re of J[0].versions)try{se[se.length-1]?.version!==re.version&&await this.isRawExtensionVersionCompatible(re,ee,q)&&se.push({version:re.version,date:re.lastUpdated})}catch(me){}return se}async getAsset(N,q={},V=I.CancellationToken.None){const J=await this.commonHeadersPromise,ee={type:"GET"},se={...J,...q.headers||{}};q={...q,...ee,headers:se};const re=N.uri,me=N.fallbackUri,ve={...q,url:re};try{const fe=await this.requestService.request(ve,V);if(fe.res.statusCode===200)return fe;const be=await(0,g.asText)(fe);throw new Error(`Expected 200, got back ${fe.res.statusCode} instead.

${be}`)}catch(fe){if((0,b.isPromiseCanceledError)(fe))throw fe;const be=(0,b.getErrorMessage)(fe);this.telemetryService.publicLog2("galleryService:cdnFallback",{url:re,message:be});const ye={...q,url:me};return this.requestService.request(ye,V)}}async getEngine(N){let q=B(N);if(!q){const V=await this.getManifestFromRawExtensionVersion(N,I.CancellationToken.None);if(!V)throw new Error("Manifest was not found");q=V.engines.vscode}return q}async getExtensionsReport(){if(!this.isEnabled())throw new Error("No extension gallery service configured.");if(!this.extensionsControlUrl)return[];const N=await this.requestService.request({type:"GET",url:this.extensionsControlUrl},I.CancellationToken.None);if(N.res.statusCode!==200)throw new Error("Could not get extensions report.");const q=await(0,g.asJson)(N),V=new Map;if(q)for(const J of q.malicious){const ee=V.get(J)||{id:{id:J},malicious:!0,slow:!1};ee.malicious=!0,V.set(J,ee)}return[...V.values()]}};X=de([ae(1,g.IRequestService),ae(2,d.ILogService),ae(3,w.IEnvironmentService),ae(4,s.ITelemetryService),ae(5,u.IFileService),ae(6,p.IProductService),ae(7,m.IConfigurationService)],X);let j=class extends X{constructor(N,q,V,J,ee,se,re,me){super(N,q,V,J,ee,se,re,me)}};j=de([ae(0,l.IStorageService),ae(1,g.IRequestService),ae(2,d.ILogService),ae(3,w.IEnvironmentService),ae(4,s.ITelemetryService),ae(5,u.IFileService),ae(6,p.IProductService),ae(7,m.IConfigurationService)],j),t.ExtensionGalleryService=j;let ie=class extends X{constructor(N,q,V,J,ee,se,re){super(void 0,N,q,V,J,ee,se,re)}};ie=de([ae(0,g.IRequestService),ae(1,d.ILogService),ae(2,w.IEnvironmentService),ae(3,s.ITelemetryService),ae(4,u.IFileService),ae(5,p.IProductService),ae(6,m.IConfigurationService)],ie),t.ExtensionGalleryServiceWithNoStorageService=ie;async function Z(M,N,q,V,J,ee){const se={"X-Market-Client-Id":`VSCode ${M}`,"User-Agent":`VSCode ${M}`},re=await(0,y.getServiceMachineId)(q,J,ee);return(0,a.supportsTelemetry)(N,q)&&(0,a.getTelemetryLevel)(V)===3&&(se["X-Market-User-Id"]=re),se}t.resolveMarketplaceHeaders=Z}),define(Y[121],Q([0,1,2,18,12,27,85,26,34,55,25,30,37]),function(z,t,L,I,b,P,D,T,c,m,w,C,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryService=void 0;let S=class{constructor(p,g){this._configurationService=g,this._experimentProperties={},this._disposables=new L.DisposableStore,this._cleanupPatterns=[],this._appenders=p.appenders,this._commonProperties=p.commonProperties||Promise.resolve({}),this._piiPaths=p.piiPaths||[],this._telemetryLevel=3,this.sendErrorTelemetry=!!p.sendErrorTelemetry,this._cleanupPatterns=[/file:\/\/\/.*?\/resources\/app\//gi];for(let y of this._piiPaths)this._cleanupPatterns.push(new RegExp((0,P.escapeRegExpCharacters)(y),"gi"));this._updateTelemetryLevel(),this._configurationService.onDidChangeConfiguration(this._updateTelemetryLevel,this,this._disposables),this.publicLog2("optInStatus",{optIn:this._telemetryLevel===3}),this._commonProperties.then(y=>{const l=/^[a-f0-9]+$/i.test(y["common.machineId"]);this.publicLog2("machineIdFallback",{usingFallbackGuid:!l})})}setExperimentProperty(p,g){this._experimentProperties[p]=g}_updateTelemetryLevel(){this._telemetryLevel=(0,f.getTelemetryLevel)(this._configurationService)}get telemetryLevel(){return this._telemetryLevel}async getTelemetryInfo(){const p=await this._commonProperties;let g=p.sessionID,y=p["common.instanceId"],l=p["common.machineId"],s=p["common.firstSessionDate"],a=p["common.msftInternal"];return{sessionId:g,instanceId:y,machineId:l,firstSessionDate:s,msftInternal:a}}dispose(){this._disposables.dispose()}_log(p,g,y,l){return this.telemetryLevel<g?Promise.resolve(void 0):this._commonProperties.then(s=>{y=(0,I.mixin)(y,s),y=(0,I.mixin)(y,this._experimentProperties),y=(0,I.cloneAndChange)(y,a=>{if(typeof a=="string")return this._cleanupInfo(a,l)}),this._appenders.forEach(a=>a.log(p,y))},s=>{console.error(s)})}publicLog(p,g,y){return this._log(p,3,g,y)}publicLog2(p,g,y){return this.publicLog(p,g,y)}publicLogError(p,g){return this.sendErrorTelemetry?this._log(p,2,g,!0):Promise.resolve(void 0)}publicLogError2(p,g){return this.publicLogError(p,g)}_anonymizeFilePaths(p){let g=p;const y=[];for(let e of this._cleanupPatterns)for(;;){const i=e.exec(p);if(!i)break;y.push([i.index,e.lastIndex])}const l=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let a=0;for(g="";;){const e=s.exec(p);if(!e)break;!l.test(e[0])&&y.every(([i,r])=>e.index<i||e.index>=r)&&(g+=p.substring(a,e.index)+"<REDACTED: user-file-path>",a=s.lastIndex)}return a<p.length&&(g+=p.substr(a)),g}_removePropertiesWithPossibleUserInfo(p){if(!p)return p;const g=p.toLowerCase(),y=/@[a-zA-Z0-9-.]+/;return/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(g)?"<REDACTED: secret>":y.test(g)?"<REDACTED: email>":p}_cleanupInfo(p,g){let y=p;g&&(y=this._anonymizeFilePaths(y));for(let l of this._cleanupPatterns)y=y.replace(l,"");return y=this._removePropertiesWithPossibleUserInfo(y),y}};S.IDLE_START_EVENT_NAME="UserIdleStart",S.IDLE_STOP_EVENT_NAME="UserIdleStop",S=de([ae(1,T.IConfigurationService)],S),t.TelemetryService=S;function u(){const d=(0,D.localize)(0,null,m.default.nameLong),p=m.default.privacyStatementUrl?(0,D.localize)(2,null,"https://aka.ms/vscode-telemetry",m.default.privacyStatementUrl):(0,D.localize)(1,null,"https://aka.ms/vscode-telemetry"),g=b.isWeb?"":(0,D.localize)(3,null),y=(0,D.localize)(4,null),l=(0,D.localize)(5,null),s=(0,D.localize)(6,null),a=(0,D.localize)(7,null),e=`
|       | ${y} | ${l} | ${s} |
|:------|:---------------------:|:---------------:|:--------------:|
| all   |            \u2713          |        \u2713        |        \u2713       |
| error |            \u2713          |        \u2713        |        -       |
| crash |            \u2713          |        -        |        -       |
| off   |            -          |        -        |        -       |
`,i=(0,D.localize)(8,null);return`
${d} ${p} ${g}

&nbsp;

${a}
${e}

&nbsp;

${i}
`}w.Registry.as(c.Extensions.Configuration).registerConfiguration({id:C.TELEMETRY_SECTION_ID,order:110,type:"object",title:(0,D.localize)(9,null),properties:{[C.TELEMETRY_SETTING_ID]:{type:"string",enum:["all","error","crash","off"],enumDescriptions:[(0,D.localize)(10,null),(0,D.localize)(11,null),(0,D.localize)(12,null),(0,D.localize)(13,null)],markdownDescription:u(),default:"all",restricted:!0,scope:1,tags:["usesOnlineServices","telemetry"]}}}),w.Registry.as(c.Extensions.Configuration).registerConfiguration({id:C.TELEMETRY_SECTION_ID,order:110,type:"object",title:(0,D.localize)(14,null),properties:{[C.TELEMETRY_OLD_SETTING_ID]:{type:"boolean",markdownDescription:m.default.privacyStatementUrl?(0,D.localize)(16,null,m.default.nameLong,m.default.privacyStatementUrl):(0,D.localize)(15,null,m.default.nameLong),default:!0,restricted:!0,markdownDeprecationMessage:(0,D.localize)(17,null,`\`#${C.TELEMETRY_SETTING_ID}#\``),scope:1,tags:["usesOnlineServices","telemetry"]}}})}),define(Y[122],Q([0,1,8,18,37]),function(z,t,L,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppInsightsAppender=void 0;async function P(T){const c=await new Promise((w,C)=>{z(["applicationinsights"],w,C)});let m;return c.defaultClient?(m=new c.TelemetryClient(T),m.channel.setUseDiskRetryCaching(!0)):(c.setup(T).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setInternalLogging(!1,!1).setUseDiskRetryCaching(!0).start(),m=c.defaultClient),T.indexOf("AIF-")===0&&(m.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1"),m}class D{constructor(c,m,w){this._eventPrefix=c,this._defaultData=m,this._defaultData||(this._defaultData=Object.create(null)),typeof w=="function"?this._aiClient=w():this._aiClient=w,this._asyncAIClient=null}_withAIClient(c){if(!!this._aiClient){if(typeof this._aiClient!="string"){c(this._aiClient);return}this._asyncAIClient||(this._asyncAIClient=P(this._aiClient)),this._asyncAIClient.then(m=>{c(m)},m=>{(0,L.onUnexpectedError)(m),console.error(m)})}}log(c,m){!this._aiClient||(m=(0,I.mixin)(m,this._defaultData),m=(0,b.validateTelemetryData)(m),this._withAIClient(w=>w.trackEvent({name:this._eventPrefix+"/"+c,properties:m.properties,measurements:m.measurements})))}flush(){return this._aiClient?new Promise(c=>{this._withAIClient(m=>{m.flush({callback:()=>{this._aiClient=void 0,c(void 0)}})})}):Promise.resolve(void 0)}}t.AppInsightsAppender=D}),define(Y[123],Q([0,1,7,13]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildTelemetryMessage=void 0;async function b(P,D){const T=Object.create(null),c=(w,C)=>{const f=JSON.parse(w);T[C]=f};if(D){const w=[],C=await I.Promises.readdir(D);for(const S of C)try{(await I.Promises.stat((0,L.join)(D,S))).isDirectory()&&w.push(S)}catch{}const f=[];for(const S of w)(await I.Promises.readdir((0,L.join)(D,S))).filter(d=>d==="telemetry.json").length===1&&f.push(S);for(const S of f){const u=(await I.Promises.readFile((0,L.join)(D,S,"telemetry.json"))).toString();c(u,S)}}let m=(await I.Promises.readFile((0,L.join)(P,"telemetry-core.json"))).toString();return c(m,"vscode-core"),m=(await I.Promises.readFile((0,L.join)(P,"telemetry-extensions.json"))).toString(),c(m,"vscode-extensions"),JSON.stringify(T,null,4)}t.buildTelemetryMessage=b}),define(Y[44],Q([0,1,47,3,7,11,13,71,135,136]),function(z,t,L,I,b,P,D,T,c,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buffer=t.extract=t.zip=t.ExtractError=void 0;class w extends Error{constructor(e,i){let r=i.message;switch(e){case"CorruptZip":r=`Corrupt ZIP: ${r}`;break}super(r);this.type=e,this.cause=i}}t.ExtractError=w;function C(a){const e=a.externalFileAttributes>>16||33188;return[448,56,7].map(i=>e&i).reduce((i,r)=>i+r,e&61440)}function f(a){if(a instanceof w)return a;let e;return/end of central directory record signature not found/.test(a.message)&&(e="CorruptZip"),new w(e,a)}function S(a,e,i,r,n,o){const h=b.dirname(e),E=b.join(r,h);if(!E.startsWith(r))return Promise.reject(new Error(T.localize(0,null,e)));const R=b.join(r,e);let v;return o.onCancellationRequested(()=>{v&&v.destroy()}),Promise.resolve(D.Promises.mkdir(E,{recursive:!0})).then(()=>new Promise((O,A)=>{if(!o.isCancellationRequested)try{v=(0,L.createWriteStream)(R,{mode:i}),v.once("close",()=>O()),v.once("error",A),a.once("error",A),a.pipe(v)}catch(G){A(G)}}))}function u(a,e,i,r){let n=(0,I.createCancelablePromise)(()=>Promise.resolve()),o=0;return r.onCancellationRequested(()=>{n.cancel(),a.close()}),new Promise((h,E)=>{const R=new I.Sequencer,v=O=>{O.isCancellationRequested||(o++,a.readEntry())};a.once("error",E),a.once("close",()=>n.then(()=>{r.isCancellationRequested||a.entryCount===o?h():E(new w("Incomplete",new Error(T.localize(1,null,o,a.entryCount))))},E)),a.readEntry(),a.on("entry",O=>{if(r.isCancellationRequested)return;if(!i.sourcePathRegex.test(O.fileName)){v(r);return}const A=O.fileName.replace(i.sourcePathRegex,"");if(/\/$/.test(A)){const ue=b.join(e,A);n=(0,I.createCancelablePromise)(ce=>D.Promises.mkdir(ue,{recursive:!0}).then(()=>v(ce)).then(void 0,E));return}const G=p(a,O),te=C(O);n=(0,I.createCancelablePromise)(ue=>R.queue(()=>G.then(ce=>S(ce,A,te,e,i,ue).then(()=>v(ue)))).then(null,E))})})}function d(a,e=!1){return new Promise((i,r)=>{(0,c.open)(a,e?{lazyEntries:!0}:void 0,(n,o)=>{n?r(f(n)):i((0,P.assertIsDefined)(o))})})}function p(a,e){return new Promise((i,r)=>{a.openReadStream(e,(n,o)=>{n?r(f(n)):i((0,P.assertIsDefined)(o))})})}function g(a,e){return new Promise((i,r)=>{const n=new m.ZipFile;e.forEach(h=>{h.contents?n.addBuffer(typeof h.contents=="string"?Buffer.from(h.contents,"utf8"):h.contents,h.path):h.localPath&&n.addFile(h.localPath,h.path)}),n.end();const o=(0,L.createWriteStream)(a);n.outputStream.pipe(o),n.outputStream.once("error",r),o.once("error",r),o.once("finish",()=>i(a))})}t.zip=g;function y(a,e,i={},r){const n=new RegExp(i.sourcePath?`^${i.sourcePath}`:"");let o=d(a,!0);return i.overwrite&&(o=o.then(h=>D.Promises.rm(e).then(()=>h))),o.then(h=>u(h,e,{sourcePathRegex:n},r))}t.extract=y;function l(a,e){return d(a).then(i=>new Promise((r,n)=>{i.on("entry",o=>{o.fileName===e&&p(i,o).then(h=>r(h),h=>n(h))}),i.once("close",()=>n(new Error(T.localize(2,null,e))))}))}function s(a,e){return l(a,e).then(i=>new Promise((r,n)=>{const o=[];i.once("error",n),i.on("data",h=>o.push(h)),i.on("end",()=>r(Buffer.concat(o)))}))}t.buffer=s}),define(Y[124],Q([0,1,44,78]),function(z,t,L,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getManifest=void 0;function b(P){return(0,L.buffer)(P,"extension/package.json").then(D=>{try{return JSON.parse(D.toString("utf8"))}catch(T){throw new Error((0,I.localize)(0,null))}})}t.getManifest=b}),define(Y[125],Q([0,1,20,3,8,2,6,7,12,19,42,9,31,13,44,79,21,22,23,89,16,14,33]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d,p,g,y,l,s,a,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsScanner=void 0;let i=class extends P.Disposable{constructor(n,o,h,E,R){super();this.beforeRemovingExtension=n,this.fileService=o,this.logService=h,this.environmentService=E,this.productService=R,this._devSystemExtensionsPath=null,this.systemExtensionsPath=E.builtinExtensionsPath,this.extensionsPath=E.extensionsPath,this.uninstalledPath=T.join(this.extensionsPath,".obsolete"),this.uninstalledFileLimiter=new I.Queue}async cleanUp(){await this.removeUninstalledExtensions(),await this.removeOutdatedExtensions()}async scanExtensions(n){const o=[];(n===null||n===0)&&o.push(this.scanSystemExtensions().then(null,h=>Promise.reject(new g.ExtensionManagementError(this.joinErrors(h).message,g.ExtensionManagementErrorCode.Internal)))),(n===null||n===1)&&o.push(this.scanUserExtensions(!0).then(null,h=>Promise.reject(new g.ExtensionManagementError(this.joinErrors(h).message,g.ExtensionManagementErrorCode.Internal))));try{const h=await Promise.all(o);return(0,L.flatten)(h)}catch(h){throw this.joinErrors(h)}}async scanUserExtensions(n){this.logService.trace("Started scanning user extensions");let[o,h]=await Promise.all([this.getUninstalledExtensions(),this.scanAllUserExtensions()]);return h=h.filter(E=>!o[new y.ExtensionIdentifierWithVersion(E.identifier,E.manifest.version).key()]),n&&(h=(0,y.groupByExtension)(h,R=>R.identifier).map(R=>R.sort((v,O)=>w.rcompare(v.manifest.version,O.manifest.version))[0])),this.logService.trace("Scanned user extensions:",h.length),h}async scanAllUserExtensions(){return this.scanExtensionsInDir(this.extensionsPath,1)}async extractUserExtension(n,o,h,E){const R=n.key(),v=T.join(this.extensionsPath,`.${(0,f.generateUuid)()}`),O=T.join(this.extensionsPath,R);try{await S.Promises.rm(O)}catch(G){try{await S.Promises.rm(O)}catch(te){}throw new g.ExtensionManagementError((0,d.localize)(0,null,O,n.id),g.ExtensionManagementErrorCode.Delete)}await this.extractAtLocation(n,o,v,E);let A=await this.scanExtension(C.URI.file(v),1);if(!A)throw new Error((0,d.localize)(1,null,v));await this.storeMetadata(A,{...h,installedTimestamp:Date.now()});try{await this.rename(n,v,O,Date.now()+2*60*1e3),this.logService.info("Renamed to",O)}catch(G){try{await S.Promises.rm(v)}catch(te){}if(G.code==="ENOTEMPTY")this.logService.info("Rename failed because extension was installed by another source. So ignoring renaming.",n.id);else throw this.logService.info(`Rename failed because of ${(0,b.getErrorMessage)(G)}. Deleted from extracted location`,v),G}try{A=await this.scanExtension(C.URI.file(O),1)}catch(G){}if(A)return A;throw new Error((0,d.localize)(2,null,this.extensionsPath))}async saveMetadataForLocalExtension(n,o){return this.setMetadata(n,o),await this.storeMetadata(n,{...o,installedTimestamp:n.installedTimestamp}),n}async storeMetadata(n,o){o.isMachineScoped=o.isMachineScoped||void 0,o.isBuiltin=o.isBuiltin||void 0,o.installedTimestamp=o.installedTimestamp||void 0;const h=T.join(n.location.fsPath,"package.json"),E=await S.Promises.readFile(h,"utf8"),{manifest:R}=await this.parseManifest(E);return R.__metadata=o,await S.Promises.writeFile(h,JSON.stringify(R,null,"	")),n}getUninstalledExtensions(){return this.withUninstalledExtensions()}async setUninstalled(...n){const o=n.map(h=>new y.ExtensionIdentifierWithVersion(h.identifier,h.manifest.version));await this.withUninstalledExtensions(h=>{o.forEach(E=>h[E.key()]=!0)})}async setInstalled(n){await this.withUninstalledExtensions(E=>delete E[n.key()]);const h=(await this.scanExtensions(1)).find(E=>new y.ExtensionIdentifierWithVersion(E.identifier,E.manifest.version).equals(n))||null;return h?(await this.storeMetadata(h,{installedTimestamp:Date.now()}),this.scanExtension(h.location,1)):null}async withUninstalledExtensions(n){return this.uninstalledFileLimiter.queue(async()=>{let o;try{o=await S.Promises.readFile(this.uninstalledPath,"utf8")}catch(E){if(E.code!=="ENOENT")throw E}let h={};if(o)try{h=JSON.parse(o)}catch(E){}return n&&(n(h),Object.keys(h).length?await S.Promises.writeFile(this.uninstalledPath,JSON.stringify(h)):await S.Promises.rm(this.uninstalledPath)),h})}async removeExtension(n,o){this.logService.trace(`Deleting ${o} extension from disk`,n.identifier.id,n.location.fsPath),await S.Promises.rm(n.location.fsPath),this.logService.info("Deleted from disk",n.identifier.id,n.location.fsPath)}async removeUninstalledExtension(n){await this.removeExtension(n,"uninstalled"),await this.withUninstalledExtensions(o=>delete o[new y.ExtensionIdentifierWithVersion(n.identifier,n.manifest.version).key()])}async extractAtLocation(n,o,h,E){this.logService.trace(`Started extracting the extension from ${o} to ${h}`);try{await S.Promises.rm(h)}catch(R){throw new g.ExtensionManagementError(this.joinErrors(R).message,g.ExtensionManagementErrorCode.Delete)}try{await(0,u.extract)(o,h,{sourcePath:"extension",overwrite:!0},E),this.logService.info(`Extracted extension to ${h}:`,n.id)}catch(R){try{await S.Promises.rm(h)}catch(O){}let v=g.ExtensionManagementErrorCode.Extract;throw R instanceof u.ExtractError&&(R.type==="CorruptZip"?v=g.ExtensionManagementErrorCode.CorruptZip:R.type==="Incomplete"&&(v=g.ExtensionManagementErrorCode.IncompleteZip)),new g.ExtensionManagementError(R.message,v)}}async rename(n,o,h,E){try{await S.Promises.rename(o,h)}catch(R){if(c.isWindows&&R&&R.code==="EPERM"&&Date.now()<E)return this.logService.info(`Failed renaming ${o} to ${h} with 'EPERM' error. Trying again...`,n.id),this.rename(n,o,h,E);throw new g.ExtensionManagementError(R.message||(0,d.localize)(3,null,o,h),R.code||g.ExtensionManagementErrorCode.Rename)}}async scanSystemExtensions(){this.logService.trace("Started scanning system extensions");const n=this.scanDefaultSystemExtensions();if(this.environmentService.isBuilt)return n;const o=this.scanDevSystemExtensions(),[h,E]=await Promise.all([n,o]);return[...h,...E]}async scanExtensionsInDir(n,o){const h=new I.Limiter(10),E=await this.fileService.resolve(C.URI.file(n));return E.children?(await Promise.all(E.children.filter(v=>v.isDirectory).map(v=>h.queue(async()=>o===1&&(0,m.basename)(v.resource).indexOf(".")===0?null:this.scanExtension(v.resource,o))))).filter(v=>v&&v.identifier):[]}async scanExtension(n,o){try{const h=await this.fileService.resolve(n);if(h.children){const{manifest:E,metadata:R}=await this.readManifest(n.fsPath),v=h.children.find(({name:te})=>/^readme(\.txt|\.md|)$/i.test(te))?.resource,O=h.children.find(({name:te})=>/^changelog(\.txt|\.md|)$/i.test(te))?.resource,A={id:(0,y.getGalleryExtensionId)(E.publisher,E.name)},G={type:o,identifier:A,manifest:E,location:n,readmeUrl:v,changelogUrl:O,publisherDisplayName:null,publisherId:null,isMachineScoped:!1,isBuiltin:o===0};return R&&(this.setMetadata(G,R),G.installedTimestamp=R.installedTimestamp),G}}catch(h){o!==0&&this.logService.trace(h)}return null}async scanDefaultSystemExtensions(){const n=await this.scanExtensionsInDir(this.systemExtensionsPath,0);return this.logService.trace("Scanned system extensions:",n.length),n}async scanDevSystemExtensions(){const n=this.getDevSystemExtensionsList();if(n.length){const o=await this.scanExtensionsInDir(this.devSystemExtensionsPath,0);return this.logService.trace("Scanned dev system extensions:",o.length),o.filter(h=>n.some(E=>(0,y.areSameExtensions)(h.identifier,{id:E})))}else return[]}setMetadata(n,o){n.publisherDisplayName=o.publisherDisplayName||null,n.publisherId=o.publisherId||null,n.identifier.uuid=o.id,n.isMachineScoped=!!o.isMachineScoped,n.isBuiltin=n.type===0||!!o.isBuiltin}async removeUninstalledExtensions(){const n=await this.getUninstalledExtensions(),o=await this.scanAllUserExtensions(),h=new Set;for(const v of o)n[new y.ExtensionIdentifierWithVersion(v.identifier,v.manifest.version).key()]||h.add(v.identifier.id.toLowerCase());const E=(0,y.groupByExtension)(o,v=>v.identifier);await I.Promises.settled(E.map(async v=>{const O=v.sort((A,G)=>w.rcompare(A.manifest.version,G.manifest.version))[0];h.has(O.identifier.id.toLowerCase())||await this.beforeRemovingExtension(O)}));const R=o.filter(v=>n[new y.ExtensionIdentifierWithVersion(v.identifier,v.manifest.version).key()]);await I.Promises.settled(R.map(v=>this.removeUninstalledExtension(v)))}async removeOutdatedExtensions(){const n=await this.scanAllUserExtensions(),o=[],h=(0,y.groupByExtension)(n,E=>E.identifier);o.push(...(0,L.flatten)(h.map(E=>E.sort((R,v)=>w.rcompare(R.manifest.version,v.manifest.version)).slice(1)))),await I.Promises.settled(o.map(E=>this.removeExtension(E,"outdated")))}getDevSystemExtensionsList(){return(this.productService.builtInExtensions||[]).map(n=>n.name)}joinErrors(n){const o=Array.isArray(n)?n:[n];return o.length===1?o[0]instanceof Error?o[0]:new Error(o[0]):o.reduce((h,E)=>new Error(`${h.message}${h.message?",":""}${E instanceof Error?E.message:E}`),new Error(""))}get devSystemExtensionsPath(){return this._devSystemExtensionsPath||(this._devSystemExtensionsPath=T.normalize(T.join(D.FileAccess.asFileUri("",z).fsPath,"..",".build","builtInExtensions"))),this._devSystemExtensionsPath}async readManifest(n){const o=[S.Promises.readFile(T.join(n,"package.json"),"utf8").then(v=>this.parseManifest(v)),S.Promises.readFile(T.join(n,"package.nls.json"),"utf8").then(void 0,v=>v.code!=="ENOENT"?Promise.reject(v):"{}").then(v=>JSON.parse(v))],[{manifest:h,metadata:E},R]=await Promise.all(o);return{manifest:(0,l.localizeManifest)(h,R),metadata:E}}parseManifest(n){return new Promise((o,h)=>{try{const E=JSON.parse(n),R=E.__metadata||null;o({manifest:E,metadata:R})}catch(E){h(new Error((0,d.localize)(4,null)))}})}};i=de([ae(1,s.IFileService),ae(2,a.ILogService),ae(3,p.INativeEnvironmentService),ae(4,e.IProductService)],i),t.ExtensionsScanner=i}),define(Y[126],Q([0,1,28,8,6,7,12,29,19,42,9,31,13,44,77,51,21,119,22,23,109,97,124,110,125,111,49,16,15,14,33,30]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d,p,g,y,l,s,a,e,i,r,n,o,h,E,R,v,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManagementService=void 0;let A=class extends g.AbstractExtensionManagementService{constructor(B,K,_,oe,x,F,W,H){super(B,K,_,H);this.environmentService=oe,this.downloadService=x,this.fileService=W;const X=this._register(F.createInstance(a.ExtensionsLifecycle));this.extensionsScanner=this._register(F.createInstance(r.ExtensionsScanner,ie=>X.postUninstall(ie))),this.manifestCache=this._register(new i.ExtensionsManifestCache(oe,this)),this.extensionsDownloader=this._register(F.createInstance(s.ExtensionsDownloader));const j=this._register(new n.ExtensionsWatcher(this,W,oe,_));this._register(j.onDidChangeExtensionsByAnotherSource(({added:ie,removed:Z})=>{ie.length&&this._onDidInstallExtensions.fire(ie.map(M=>({identifier:M.identifier,operation:0,local:M}))),Z.forEach(M=>this._onDidUninstallExtension.fire({identifier:M}))}))}getTargetPlatform(){return this._targetPlatformPromise||(this._targetPlatformPromise=(async()=>{const B=await this.isAlpineLinux(),K=(0,y.getTargetPlatform)(B?"alpine":D.platform,T.arch);return this.logService.debug("ExtensionManagementService#TargetPlatform:",K),K})()),this._targetPlatformPromise}async isAlpineLinux(){if(!D.isLinux)return!1;let B;try{B=(await this.fileService.readFile(w.URI.file("/etc/os-release"))).value.toString()}catch(K){try{B=(await this.fileService.readFile(w.URI.file("/usr/lib/os-release"))).value.toString()}catch(_){this.logService.debug("Error while getting the os-release file.",(0,I.getErrorMessage)(_))}}return!!B&&(B.match(/^ID=([^\u001b\r\n]*)/m)||[])[1]==="alpine"}async zip(B){this.logService.trace("ExtensionManagementService#zip",B.identifier.id);const K=await this.collectFiles(B),_=await(0,S.zip)((0,c.joinPath)(this.environmentService.tmpDir,(0,C.generateUuid)()).fsPath,K);return w.URI.file(_)}async unzip(B){return this.logService.trace("ExtensionManagementService#unzip",B.toString()),(await this.install(B)).identifier}async getManifest(B){const K=await this.downloadVsix(B),_=P.resolve(K.fsPath);return(0,e.getManifest)(_)}getInstalled(B=null){return this.extensionsScanner.scanExtensions(B)}async install(B,K={}){this.logService.trace("ExtensionManagementService#install",B.toString());const _=await this.downloadVsix(B),oe=await(0,e.getManifest)(P.resolve(_.fsPath));if(oe.engines&&oe.engines.vscode&&!(0,o.isEngineValid)(oe.engines.vscode,this.productService.version,this.productService.date))throw new Error(u.localize(0,null,(0,l.getGalleryExtensionId)(oe.publisher,oe.name),this.productService.version));return this.installExtension(oe,_,K)}async updateMetadata(B,K){return this.logService.trace("ExtensionManagementService#updateMetadata",B.identifier.id),B=await this.extensionsScanner.saveMetadataForLocalExtension(B,{...B.manifest.__metadata||{},...K}),this.manifestCache.invalidate(),B}async updateExtensionScope(B,K){return this.logService.trace("ExtensionManagementService#updateExtensionScope",B.identifier.id),B=await this.extensionsScanner.saveMetadataForLocalExtension(B,{...B.manifest.__metadata||{},isMachineScoped:K}),this.manifestCache.invalidate(),B}removeDeprecatedExtensions(){return this.extensionsScanner.cleanUp()}async downloadVsix(B){if(B.scheme===b.Schemas.file)return B;const K=(0,c.joinPath)(this.environmentService.tmpDir,(0,C.generateUuid)());return await this.downloadService.download(B,K),K}createInstallExtensionTask(B,K,_){return w.URI.isUri(K)?new ue(B,K,_,this.galleryService,this.extensionsScanner,this.logService):new te(K,_,this.extensionsDownloader,this.extensionsScanner,this.logService)}createUninstallExtensionTask(B,K){return new ce(B,K,this.extensionsScanner)}async collectFiles(B){const K=async oe=>{let x=await f.Promises.readdir(oe);x=x.map(H=>P.join(oe,H));const F=await Promise.all(x.map(H=>f.Promises.stat(H)));let W=Promise.resolve([]);return F.forEach((H,X)=>{const j=x[X];H.isFile()&&(W=W.then(ie=>[...ie,j])),H.isDirectory()&&(W=W.then(ie=>K(j).then(Z=>[...ie,...Z])))}),W};return(await K(B.location.fsPath)).map(oe=>({path:`extension/${P.relative(B.location.fsPath,oe)}`,localPath:oe}))}};A=de([ae(0,y.IExtensionGalleryService),ae(1,O.ITelemetryService),ae(2,R.ILogService),ae(3,p.INativeEnvironmentService),ae(4,d.IDownloadService),ae(5,E.IInstantiationService),ae(6,h.IFileService),ae(7,v.IProductService)],A),t.ExtensionManagementService=A;class G extends g.AbstractExtensionTask{constructor(B,K,_,oe){super();this.identifier=B,this.source=K,this.extensionsScanner=_,this.logService=oe,this._operation=1}get operation(){return this._operation}async installExtension(B,K){try{const _=await this.unsetUninstalledAndGetLocal(B.identifierWithVersion);if(_)return B.metadata?this.extensionsScanner.saveMetadataForLocalExtension(_,B.metadata):_}catch(_){throw D.isMacintosh?new y.ExtensionManagementError(u.localize(1,null),y.ExtensionManagementErrorCode.Internal):new y.ExtensionManagementError(u.localize(2,null),y.ExtensionManagementErrorCode.Internal)}return this.extract(B,K)}async unsetUninstalledAndGetLocal(B){if(!await this.isUninstalled(B))return null;this.logService.trace("Removing the extension from uninstalled list:",B.id);const _=await this.extensionsScanner.setInstalled(B);return this.logService.info("Removed the extension from uninstalled list:",B.id),_}async isUninstalled(B){return!!(await this.extensionsScanner.getUninstalledExtensions())[B.key()]}async extract({zipPath:B,identifierWithVersion:K,metadata:_},oe){let x=await this.extensionsScanner.extractUserExtension(K,B,_,oe);return this.logService.info("Extracting completed.",K.id),x}}class te extends G{constructor(B,K,_,oe,x){super(B.identifier,B,oe,x);this.gallery=B,this.options=K,this.extensionsDownloader=_}async doRun(B){const _=(await this.extensionsScanner.scanExtensions(null)).find(x=>(0,l.areSameExtensions)(x.identifier,this.gallery.identifier));_&&(this._operation=2);const oe=await this.downloadInstallableExtension(this.gallery,this._operation);oe.metadata.isMachineScoped=this.options.isMachineScoped||_?.isMachineScoped,oe.metadata.isBuiltin=this.options.isBuiltin||_?.isBuiltin;try{const x=await this.installExtension(oe,B);return _&&m.neq(_.manifest.version,this.gallery.version)&&await this.extensionsScanner.setUninstalled(_),x}catch(x){throw await this.deleteDownloadedVSIX(oe.zipPath),x}}async deleteDownloadedVSIX(B){try{await this.extensionsDownloader.delete(w.URI.file(B))}catch(K){this.logService.warn("Error while deleting the downloaded vsix",B.toString(),(0,I.getErrorMessage)(K))}}async downloadInstallableExtension(B,K){const _={id:B.identifier.uuid,publisherId:B.publisherId,publisherDisplayName:B.publisherDisplayName};let oe;try{this.logService.trace("Started downloading extension:",B.identifier.id),oe=(await this.extensionsDownloader.downloadExtension(B,K)).fsPath,this.logService.info("Downloaded extension:",B.identifier.id,oe)}catch(x){throw new y.ExtensionManagementError((0,g.joinErrors)(x).message,y.ExtensionManagementErrorCode.Download)}try{const x=await(0,e.getManifest)(oe);return{zipPath:oe,identifierWithVersion:new l.ExtensionIdentifierWithVersion(B.identifier,x.version),metadata:_}}catch(x){throw await this.deleteDownloadedVSIX(oe),new y.ExtensionManagementError((0,g.joinErrors)(x).message,y.ExtensionManagementErrorCode.Invalid)}}}class ue extends G{constructor(B,K,_,oe,x,F){super({id:(0,l.getGalleryExtensionId)(B.publisher,B.name)},K,x,F);this.manifest=B,this.location=K,this.options=_,this.galleryService=oe}async doRun(B){const K=new l.ExtensionIdentifierWithVersion(this.identifier,this.manifest.version),oe=(await this.extensionsScanner.scanExtensions(1)).find(F=>(0,l.areSameExtensions)(this.identifier,F.identifier)),x=await this.getMetadata(this.identifier.id,B);if(x.isMachineScoped=this.options.isMachineScoped||oe?.isMachineScoped,x.isBuiltin=this.options.isBuiltin||oe?.isBuiltin,oe)if(this._operation=2,K.equals(new l.ExtensionIdentifierWithVersion(oe.identifier,oe.manifest.version)))try{await this.extensionsScanner.removeExtension(oe,"existing")}catch(F){throw new Error(u.localize(3,null,this.manifest.displayName||this.manifest.name))}else m.gt(oe.manifest.version,this.manifest.version)&&await this.extensionsScanner.setUninstalled(oe);else{const F=await this.unsetUninstalledAndGetLocal(K);if(F)try{await this.extensionsScanner.removeExtension(F,"existing")}catch(W){throw new Error(u.localize(4,null,this.manifest.displayName||this.manifest.name))}}return this.installExtension({zipPath:P.resolve(this.location.fsPath),identifierWithVersion:K,metadata:x},B)}async getMetadata(B,K){try{const _=(await this.galleryService.query({names:[B],pageSize:1},K)).firstPage[0];if(_)return{id:_.identifier.uuid,publisherDisplayName:_.publisherDisplayName,publisherId:_.publisherId}}catch(_){}return{}}}class ce extends g.AbstractExtensionTask{constructor(B,K,_){super();this.extension=B,this.options=K,this.extensionsScanner=_}async doRun(B){const K=[],_=await this.extensionsScanner.scanUserExtensions(!1);if(this.options.versionOnly){const oe=new l.ExtensionIdentifierWithVersion(this.extension.identifier,this.extension.manifest.version);K.push(..._.filter(x=>oe.equals(new l.ExtensionIdentifierWithVersion(x.identifier,x.manifest.version))))}else K.push(..._.filter(oe=>(0,l.areSameExtensions)(oe.identifier,this.extension.identifier)));if(!K.length)throw new Error(u.localize(5,null,this.extension.manifest.displayName||this.extension.manifest.name));if(await this.extensionsScanner.setUninstalled(...K),this.options.remove)for(const oe of K)try{B.isCancellationRequested||await this.extensionsScanner.removeUninstalledExtension(oe)}catch(x){throw new Error(u.localize(6,null,(0,L.toErrorMessage)(x)))}}}}),define(Y[127],Q([0,1,115,3,17,8,2,11,26,21,91,14,114,137]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestService=void 0;let u=class extends D.Disposable{constructor(p,g,y){super();this.environmentService=g,this.logService=y,this.configure(p.getValue()),this._register(p.onDidChangeConfiguration(()=>this.configure(p.getValue()),this))}configure(p){this.proxyUrl=p.http&&p.http.proxy,this.strictSSL=!!(p.http&&p.http.proxyStrictSSL),this.authorization=p.http&&p.http.proxyAuthorization}async request(p,g){this.logService.trace("RequestService#request",p.url);const{proxyUrl:y,strictSSL:l}=this;let s;try{s=await(0,w.resolveShellEnv)(this.logService,this.environmentService.args,process.env)}catch(i){this.logService.error("RequestService#request resolving shell environment failed",i)}const a={...process.env,...s},e=p.agent?p.agent:await(0,f.getProxyAgent)(p.url||"",a,{proxyUrl:y,strictSSL:l});return p.agent=e,p.strictSSL=l,this.authorization&&(p.headers={...p.headers||{},"Proxy-Authorization":this.authorization}),this._request(p,g)}async getNodeRequest(p){return((0,L.parse)(p.url).protocol==="https:"?await new Promise((l,s)=>{z(["https"],l,s)}):await new Promise((l,s)=>{z(["http"],l,s)})).request}_request(p,g){return I.Promises.withAsyncBody(async(y,l)=>{let s;const a=(0,L.parse)(p.url),e=p.getRawRequest?p.getRawRequest(p):await this.getNodeRequest(p),i={hostname:a.hostname,port:a.port?parseInt(a.port):a.protocol==="https:"?443:80,protocol:a.protocol,path:a.path,method:p.type||"GET",headers:p.headers,agent:p.agent,rejectUnauthorized:(0,T.isBoolean)(p.strictSSL)?p.strictSSL:!0};p.user&&p.password&&(i.auth=p.user+":"+p.password),s=e(i,r=>{const n=(0,T.isNumber)(p.followRedirects)?p.followRedirects:3;if(r.statusCode&&r.statusCode>=300&&r.statusCode<400&&n>0&&r.headers.location)this._request({...p,url:r.headers.location,followRedirects:n-1},g).then(y,l);else{let o=r;r.headers["content-encoding"]==="gzip"&&(o=r.pipe((0,S.createGunzip)())),y({res:r,stream:(0,b.streamToBufferReadableStream)(o)})}}),s.on("error",l),p.timeout&&s.setTimeout(p.timeout),p.data&&typeof p.data=="string"&&s.write(p.data),s.end(),g.onCancellationRequested(()=>{s.abort(),l((0,P.canceled)())})})}async resolveProxy(p){}};u=de([ae(0,c.IConfigurationService),ae(1,m.INativeEnvironmentService),ae(2,C.ILogService)],u),t.RequestService=u}),define(Y[138],Q([0,1,35,3,17,28,8,2,6,7,29,9,13,26,106,51,113,21,88,120,22,108,126,16,99,103,50,96,53,54,112,14,102,55,33,43,127,118,30,121,37,122,123]),function(z,t,L,I,b,P,D,T,c,m,w,C,f,S,u,d,p,g,y,l,s,a,e,i,r,n,o,h,E,R,v,O,A,G,te,ue,ce,ne,B,K,_,oe,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.main=void 0;class F extends T.Disposable{constructor(X){super();this.argv=X,this.registerListeners()}registerListeners(){process.once("exit",()=>this.dispose())}async run(){const[X,j]=await this.initServices();return X.invokeFunction(async ie=>{const Z=ie.get(O.ILogService),M=ie.get(i.IFileService),N=ie.get(g.INativeEnvironmentService),q=ie.get(s.IExtensionManagementCLIService);Z.info("CLI main",this.argv),this.registerErrorHandler(Z),await this.doRun(N,q,M),await Promise.all(j.map(V=>{(0,I.raceTimeout)(V.flush(),1e3)}))})}async initServices(){const X=new E.ServiceCollection,j={_serviceBrand:void 0,...G.default};X.set(te.IProductService,j);const ie=new y.NativeEnvironmentService(this.argv,j);X.set(g.INativeEnvironmentService,ie),await Promise.all([ie.appSettingsHome.fsPath,ie.extensionsPath].map(se=>se?f.Promises.mkdir(se,{recursive:!0}):void 0));const Z=(0,O.getLogLevel)(ie),M=[];M.push(new A.SpdLogLogger("cli",(0,m.join)(ie.logsPath,"cli.log"),!0,Z)),Z===O.LogLevel.Trace&&M.push(new O.ConsoleLogger(Z));const N=this._register(new O.MultiplexLogService(M));X.set(O.ILogService,N);const q=this._register(new r.FileService(N));X.set(i.IFileService,q);const V=this._register(new n.DiskFileSystemProvider(N));q.registerProvider(c.Schemas.file,V);const J=this._register(new u.ConfigurationService(ie.settingsResource,q));X.set(S.IConfigurationService,J),await J.initialize(),X.set(ue.IRequestService,new o.SyncDescriptor(ce.RequestService)),X.set(d.IDownloadService,new o.SyncDescriptor(p.DownloadService)),X.set(s.IExtensionManagementService,new o.SyncDescriptor(e.ExtensionManagementService)),X.set(s.IExtensionGalleryService,new o.SyncDescriptor(l.ExtensionGalleryServiceWithNoStorageService)),X.set(s.IExtensionManagementCLIService,new o.SyncDescriptor(a.ExtensionManagementCLIService)),X.set(R.ILocalizationsService,new o.SyncDescriptor(v.LocalizationsService));const ee=[];if((0,_.supportsTelemetry)(j,ie)){j.aiConfig&&j.aiConfig.asimovKey&&ee.push(new oe.AppInsightsAppender("monacoworkbench",null,j.aiConfig.asimovKey));const{appRoot:se,extensionsPath:re,installSourcePath:me}=ie,ve={appenders:ee,sendErrorTelemetry:!1,commonProperties:(async()=>{let fe;try{const be=await f.Promises.readFile((0,m.join)(ie.userDataPath,"storage.json"));fe=JSON.parse(be.toString())[B.machineIdKey]}catch(be){be.code!=="ENOENT"&&N.error(be)}return(0,ne.resolveCommonProperties)(q,(0,L.release)(),(0,L.hostname)(),process.arch,j.commit,j.version,fe,j.msftInternalDomains,me)})(),piiPaths:[se,re]};X.set(B.ITelemetryService,new o.SyncDescriptor(K.TelemetryService,[ve]))}else X.set(B.ITelemetryService,_.NullTelemetryService);return[new h.InstantiationService(X),ee]}registerErrorHandler(X){(0,D.setUnexpectedErrorHandler)(j=>{const ie=(0,P.toErrorMessage)(j,!0);!ie||X.error(`[uncaught exception in CLI]: ${ie}`)}),process.on("uncaughtException",j=>(0,D.onUnexpectedError)(j)),process.on("unhandledRejection",j=>(0,D.onUnexpectedError)(j))}async doRun(X,j,ie){if(this.argv["install-source"])return this.setInstallSource(X,ie,this.argv["install-source"]);if(this.argv["list-extensions"])return j.listExtensions(!!this.argv["show-versions"],this.argv.category);if(this.argv["install-extension"]||this.argv["install-builtin-extension"])return j.installExtensions(this.asExtensionIdOrVSIX(this.argv["install-extension"]||[]),this.argv["install-builtin-extension"]||[],!!this.argv["do-not-sync"],!!this.argv.force);if(this.argv["uninstall-extension"])return j.uninstallExtensions(this.asExtensionIdOrVSIX(this.argv["uninstall-extension"]),!!this.argv.force);if(this.argv["locate-extension"])return j.locateExtension(this.argv["locate-extension"]);this.argv.telemetry&&console.log(await(0,x.buildTelemetryMessage)(X.appRoot,X.extensionsPath))}asExtensionIdOrVSIX(X){return X.map(j=>/\.vsix$/i.test(j)?C.URI.file((0,m.isAbsolute)(j)?j:(0,m.join)((0,w.cwd)(),j)):j)}async setInstallSource(X,j,ie){await j.writeFile(C.URI.file(X.installSourcePath),b.VSBuffer.fromString(ie.slice(0,30)))}}async function W(H){const X=new F(H);try{await X.run()}finally{X.dispose()}}t.main=W})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/3a6960b964327f0e3882ce18fcebd07ed191b316/core/vs/code/node/cliProcessMain.js.map
